<html>
<head>
<title>Using Torchmoji with Python and Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å°†Torchmojiä¸Pythonå’Œæ·±åº¦å­¦ä¹ ç»“åˆä½¿ç”¨</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://pub.towardsai.net/using-torchmoji-with-python-and-deep-learning-3fefee62c9a1?source=collection_archive---------1-----------------------#2020-06-20">https://pub.towardsai.net/using-torchmoji-with-python-and-deep-learning-3fefee62c9a1?source=collection_archive---------1-----------------------#2020-06-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="6813" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning/deep-learning" rel="noopener ugc nofollow" target="_blank">æ·±åº¦å­¦ä¹ </a></h2><div class=""/><div class=""><h2 id="f76b" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">åˆ©ç”¨æ·±åº¦å­¦ä¹ å°†æ–‡æœ¬è½¬æ¢ä¸ºè¡¨æƒ…ç¬¦å·ã€‚åœ¨æˆ‘çš„Githubåº“æœ‰å®Œæ•´çš„ä»£ç <a class="ae kr" href="https://github.com/arditoibryan/Projects/blob/master/20200618_torchMoji/torchMoji.ipynb" rel="noopener ugc nofollow" target="_blank">ã€‚</a></h2></div><p id="d2dc" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">ä¸€ç›´å¾ˆéš¾æ‰¾åˆ°å…³äºå¦‚ä½•ä½¿ç”¨Pythonæ¥ä½¿ç”¨è‡­åæ˜­è‘—çš„DeepMojiçš„æ•™ç¨‹ã€‚åœ¨æˆ‘çš„ç¬”è®°æœ¬ä¸Šå°è¯•äº†å‡ æ¬¡ï¼Œå‡ºç°äº†å‡ æ¬¡é”™è¯¯ä¹‹åï¼Œæˆ‘æ”¾å¼ƒäº†ï¼Œå†³å®šä½¿ç”¨Keras: torchMojiè®­ç»ƒçš„æ›¿ä»£ç‰ˆæœ¬ã€‚</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lo"><img src="../Images/84488bc487dfcbefe2b69400b00961f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l4CjFHOAHKAP4nEPAtKUuA.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">è„¸ä¹¦è¡¨æƒ…ç¬¦å·</figcaption></figure><p id="1e42" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">äº‹å®ä¸Šï¼Œæˆ‘è¿˜æ²¡æœ‰æ‰¾åˆ°ä¸€ä¸ªå…³äºå¦‚ä½•å°†æ–‡å­—è½¬æ¢æˆè¡¨æƒ…ç¬¦å·çš„æ•™ç¨‹ã€‚ä½ å¾ˆå¹¸è¿ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªã€‚</p><h1 id="40a8" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">è£…ç½®</h1><p id="7211" class="pw-post-body-paragraph ks kt it ku b kv mw kd kx ky mx kg la lb my ld le lf mz lh li lj na ll lm ln im bi translated">* * *ä»£ç ï¼Œä¸å¹¸çš„æ˜¯ï¼Œä¸å®Œå…¨æ˜¯æˆ‘çš„ï¼Œ<a class="ae kr" href="https://github.com/mohammedterry/NLP_for_ML/blob/master/Sentiment_Analysis.ipynb" rel="noopener ugc nofollow" target="_blank">æºä»£ç å¯åœ¨æ­¤é“¾æ¥</a>ã€‚</p><pre class="lp lq lr ls gt nb nc nd ne aw nf bi"><span id="f88c" class="ng mf it nc b gy nh ni l nj nk">!pip3 install torch==1.0.1 -f <a class="ae kr" href="https://download.pytorch.org/whl/cpu/stable" rel="noopener ugc nofollow" target="_blank">https://download.pytorch.org/whl/cpu/stable</a> <br/>!git clone <a class="ae kr" href="https://github.com/huggingface/torchMoji" rel="noopener ugc nofollow" target="_blank">https://github.com/huggingface/torchMoji</a><br/>import os<br/>os.chdir('torchMoji')<br/>!pip3 install -e .<br/>#if you restart the package, the notebook risks to crash on a loop<br/>#I did not restart and worked fine</span></pre><p id="9622" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">ä»£ç å°†ä¸‹è½½å¤§çº¦600 MBçš„æ•°æ®æ¥è®­ç»ƒAIã€‚æˆ‘ä¸€ç›´åœ¨ç”¨è°·æ­ŒColabã€‚ç„¶è€Œï¼Œæˆ‘æ³¨æ„åˆ°<strong class="ku jd">å½“ç¨‹åºè¦æ±‚ä½ é‡å¯ç¬”è®°æœ¬</strong>ä»¥è¿›è¡Œæ‰€éœ€çš„æ›´æ”¹æ—¶ï¼Œå®ƒå¼€å§‹åœ¨ä¸€ä¸ªæ²¡æœ‰è¡¥æ•‘æªæ–½çš„å¾ªç¯ä¸­å´©æºƒã€‚å¦‚æœä½ èƒ½ä»æˆ‘çš„é”™è¯¯ä¸­å¸å–æ•™è®­ï¼Œä¸è¦é‡å¯ç¬”è®°æœ¬ï¼Œè®©å®ƒå»å§ï¼Œå®ƒä¼šå·¥ä½œçš„ã€‚</p><pre class="lp lq lr ls gt nb nc nd ne aw nf bi"><span id="3534" class="ng mf it nc b gy nh ni l nj nk">!python3 scripts/download_weights.py</span></pre><p id="03d1" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">è¿™ä¸ªè„šæœ¬åº”è¯¥ä¸‹è½½ç¥ç»ç½‘ç»œçš„è°ƒæ•´ã€‚è¯¢é—®æ—¶ï¼ŒæŒ‰<strong class="ku jd"> yes </strong>ç¡®è®¤ã€‚</p><h1 id="1fb1" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">è®¾ç½®è½¬æ¢åŠŸèƒ½</h1><p id="c466" class="pw-post-body-paragraph ks kt it ku b kv mw kd kx ky mx kg la lb my ld le lf mz lh li lj na ll lm ln im bi translated">ä½¿ç”¨ä¸‹é¢çš„å‡½æ•°ï¼Œæ‚¨å°†èƒ½å¤Ÿè¾“å…¥æ–‡æœ¬ï¼Œä½œä¸ºå›æŠ¥ï¼Œè¯¥å‡½æ•°å°†è¾“å‡ºæœ€æœ‰å¯èƒ½çš„nä¸ªè¡¨æƒ…ç¬¦å·(nå¾…å®š)ã€‚</p><pre class="lp lq lr ls gt nb nc nd ne aw nf bi"><span id="954f" class="ng mf it nc b gy nh ni l nj nk">import numpy as np<br/>import emoji, json<br/>from torchmoji.global_variables import PRETRAINED_PATH, VOCAB_PATH<br/>from torchmoji.sentence_tokenizer import SentenceTokenizer<br/>from torchmoji.model_def import torchmoji_emojis<br/>  <br/>EMOJIS = ":joy: :unamused: :weary: :sob: :heart_eyes: :pensive: :ok_hand: :blush: :heart: :smirk: :grin: :notes: :flushed: :100: :sleeping: :relieved: :relaxed: :raised_hands: :two_hearts: :expressionless: :sweat_smile: :pray: :confused: :kissing_heart: :heartbeat: :neutral_face: :information_desk_person: :disappointed: :see_no_evil: :tired_face: :v: :sunglasses: :rage: :thumbsup: :cry: :sleepy: :yum: :triumph: :hand: :mask: :clap: :eyes: :gun: :persevere: :smiling_imp: :sweat: :broken_heart: :yellow_heart: :musical_note: :speak_no_evil: :wink: :skull: :confounded: :smile: :stuck_out_tongue_winking_eye: :angry: :no_good: :muscle: :facepunch: :purple_heart: :sparkling_heart: :blue_heart: :grimacing: :sparkles:".split(' ')<br/>model = torchmoji_emojis(PRETRAINED_PATH)<br/>with open(VOCAB_PATH, 'r') as f:<br/>  vocabulary = json.load(f)<br/>st = SentenceTokenizer(vocabulary, 30)</span><span id="418e" class="ng mf it nc b gy nl ni l nj nk">def deepmojify(sentence,top_n =5):<br/>  def top_elements(array, k):<br/>    ind = np.argpartition(array, -k)[-k:]<br/>    return ind[np.argsort(array[ind])][::-1]</span><span id="a039" class="ng mf it nc b gy nl ni l nj nk">tokenized, _, _ = st.tokenize_sentences([sentence])<br/>  prob = model(tokenized)[0]<br/>  emoji_ids = top_elements(prob, top_n)<br/>  emojis = map(lambda x: EMOJIS[x], emoji_ids)<br/>  return emoji.emojize(f"{sentence} {' '.join(emojis)}", use_aliases=True)</span></pre><h1 id="c5b2" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">æ–‡æœ¬å®éªŒ</h1><pre class="lp lq lr ls gt nb nc nd ne aw nf bi"><span id="03b6" class="ng mf it nc b gy nh ni l nj nk">text = ['I hate coding AI']</span><span id="f92f" class="ng mf it nc b gy nl ni l nj nk">for _ in text:<br/>  print(deepmojify(_, top_n = 3))</span></pre><h2 id="d6a0" class="ng mf it bd mg nm nn dn mk no np dp mo lb nq nr mq lf ns nt ms lj nu nv mu iz bi translated">è¾“å‡º:</h2><h1 id="b5b1" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi">ğŸ˜¡ ğŸ˜  ğŸ˜¤</h1><p id="9d27" class="pw-post-body-paragraph ks kt it ku b kv mw kd kx ky mx kg la lb my ld le lf mz lh li lj na ll lm ln im bi translated">å¦‚ä½ æ‰€è§ï¼Œæˆ‘å·²ç»å‘Šè¯‰ç¨‹åºè¿è¡Œè¿™è¡Œæ–‡æœ¬ã€‚å› ä¸ºå®ƒæ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œæ‰€ä»¥ä½ å¯ä»¥æ·»åŠ å¤šå°‘ä¸ªå­—ç¬¦ä¸²ã€‚</p><h1 id="c063" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">åŸå§‹ç¥ç»ç½‘ç»œ</h1><p id="e095" class="pw-post-body-paragraph ks kt it ku b kv mw kd kx ky mx kg la lb my ld le lf mz lh li lj na ll lm ln im bi translated">å¦‚æœä½ ä¸çŸ¥é“å¦‚ä½•ç¼–ç ï¼Œä½ åªæ˜¯æƒ³ç©ï¼Œä½ å¯ä»¥ä½¿ç”¨DeepMojiçš„ç½‘ç«™ã€‚</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/c443ebe51da2c8ba74f4aab21319f1c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*77Nsq1k5v0NOeCreMWvKuQ.png"/></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">wwwçš„æˆªå›¾ã€‚DeepMoji.com</figcaption></figure><p id="fdb3" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">æºä»£ç åº”è¯¥æ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œäº‹å®ä¸Šï¼Œå¦‚æœæˆ‘è¾“å…¥5ä¸ªè¡¨æƒ…ç¬¦å·è€Œä¸æ˜¯3ä¸ªï¼Œè¿™æ˜¯æˆ‘çš„ä»£ç ä¸­çš„ç»“æœ:</p><h1 id="0b25" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi">ğŸ˜¡ ğŸ˜  ğŸ˜¤ ğŸ”« ğŸ˜’</h1><h1 id="d0d5" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">è¾“å…¥åˆ—è¡¨è€Œä¸æ˜¯ä¸€ä¸ªå¥å­</h1><p id="8653" class="pw-post-body-paragraph ks kt it ku b kv mw kd kx ky mx kg la lb my ld le lf mz lh li lj na ll lm ln im bi translated">* * *ç°åœ¨ï¼Œè¿™æ˜¯æˆ‘çš„ä»£ç </p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/aeb52e4a5c1a82d8fa829f46ee6f0a61.png" data-original-src="https://miro.medium.com/v2/resize:fit:144/format:webp/0*t6nn1w8HdzvOKHSG.png"/></div></figure><p id="3ba3" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">å½“æ‰§è¡Œæƒ…æ„Ÿåˆ†ææ—¶ï¼Œæˆ‘é€šå¸¸ä¼šåœ¨pandasä¸Šå­˜å‚¨ä¸€ä¸ªtweetsæˆ–reviewsæ•°æ®åº“ï¼Œæˆ‘å°†ä½¿ç”¨ä»¥ä¸‹ç®—æ³•å°†å­—ç¬¦ä¸²åˆ—è¡¨è½¬æ¢ä¸ºå…·æœ‰æŒ‡å®šæ•°é‡è¡¨æƒ…ç¬¦å·çš„Pandasæ•°æ®å¸§ã€‚</p><pre class="lp lq lr ls gt nb nc nd ne aw nf bi"><span id="f674" class="ng mf it nc b gy nh ni l nj nk">import pandas as pd</span><span id="6413" class="ng mf it nc b gy nl ni l nj nk">def emoji_dataset(list1, n_emoji=3):<br/>  emoji_list = [[x] for x in list1]</span><span id="a5ee" class="ng mf it nc b gy nl ni l nj nk">for _ in range(len(list1)):<br/>    for n_emo in range(1, n_emoji+1):<br/>      emoji_list[_].append(deepmojify(list1[_], top_n = n_emoji)[2*-n_emo+1])</span><span id="9d0b" class="ng mf it nc b gy nl ni l nj nk">emoji_list = pd.DataFrame(emoji_list)<br/>  return emoji_list</span><span id="3012" class="ng mf it nc b gy nl ni l nj nk">list1 = ['Stay safe from the virus', 'Push until you break!', 'If it does not challenge you, it will not change you']</span></pre><p id="7928" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">æˆ‘æƒ³ä¼°è®¡ä¸€ä¸‹è¿™ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨ä¸­æœ€æœ‰å¯èƒ½çš„5ä¸ªè¡¨æƒ…ç¬¦å·:</p><pre class="lp lq lr ls gt nb nc nd ne aw nf bi"><span id="1fa4" class="ng mf it nc b gy nh ni l nj nk">emoji_dataset(list1, 5)</span></pre><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi ny"><img src="../Images/5c9ee50f920acec1fdd14daa4aa7eac4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eBUXlGSTHJ5Ummur6_NrAg.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">ä¸é”™çš„ç»“æœï¼</figcaption></figure></div></div>    
</body>
</html>