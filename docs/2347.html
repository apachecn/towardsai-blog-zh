<html>
<head>
<title>You Should Check Out This Effective Framework for Model Selection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½ åº”è¯¥çœ‹çœ‹è¿™ä¸ªæœ‰æ•ˆçš„æ¨¡å‹é€‰æ‹©æ¡†æ¶</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://pub.towardsai.net/a-framework-for-model-selection-ea4dcda2cb3a?source=collection_archive---------0-----------------------#2021-11-19">https://pub.towardsai.net/a-framework-for-model-selection-ea4dcda2cb3a?source=collection_archive---------0-----------------------#2021-11-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/2cb4e7b2cbb22b027cb6a0a020982fe2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*20UGfabTmPWJzV4OZlz13Q.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">åœ¨<a class="ae kc" href="https://unsplash.com/s/photos/selection?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šç”±<a class="ae kc" href="https://unsplash.com/@poleznova?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> vitamina poleznova </a>æ‹æ‘„çš„ç…§ç‰‡</figcaption></figure><p id="95f6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">åœ¨æ¯ä¸ªæœºå™¨å­¦ä¹ é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬éƒ½éœ€è¦é€‰æ‹©ä¸€ä¸ªæ¨¡å‹æ¥æ”¹å–„æˆ‘ä»¬çš„èµ·å§‹åŸºçº¿ã€‚</p><p id="ae86" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">äº‹å®ä¸Šï¼Œå¦‚æœåŸºçº¿ç»™äº†æˆ‘ä»¬ä¸€ä¸ªæœ‰ç”¨çš„èµ·å§‹æ¨¡å‹æ¥ç†è§£æˆ‘ä»¬å¯ä»¥ä»ä¸€ä¸ªéå¸¸ç®€å•çš„è§£å†³æ–¹æ¡ˆä¸­æœŸå¾…ä»€ä¹ˆï¼Œé‚£ä¹ˆé€šè¿‡<strong class="kf ir">ä¸€ä¸ªç‰¹å®šçš„æ–¹æ³•è®º</strong>é€‰æ‹©çš„æ¨¡å‹å¸®åŠ©æˆ‘ä»¬å¹³ç¨³åœ°è¿›å…¥é¡¹ç›®çš„ä¼˜åŒ–é˜¶æ®µã€‚</p><p id="717d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†ä¸ä½ åˆ†äº«æˆ‘çš„ä¸ªäººæ¡†æ¶(å’Œä»£ç åº“),ä»¥æœ‰ç»„ç»‡å’Œç»“æ„åŒ–çš„æ–¹å¼è¿›è¡Œæ¨¡å‹é€‰æ‹©ã€‚</p><h1 id="98ef" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">è¯¥æ–¹æ³•</h1><p id="a9d1" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå›å½’é—®é¢˜è¦è§£å†³ã€‚è®©æˆ‘ä»¬ä»å¯¼å…¥æ‰€éœ€çš„åº“å’Œé…ç½®æ—¥å¿—æœºåˆ¶å¼€å§‹</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="8c4e" class="mn lc iq mj b gy mo mp l mq mr"><strong class="mj ir">from</strong> <strong class="mj ir">sklearn</strong> <strong class="mj ir">import</strong> linear_model<br/><strong class="mj ir">from</strong> <strong class="mj ir">sklearn</strong> <strong class="mj ir">import</strong> ensemble<br/><strong class="mj ir">from</strong> <strong class="mj ir">sklearn</strong> <strong class="mj ir">import</strong> tree<br/><strong class="mj ir">from</strong> <strong class="mj ir">sklearn</strong> <strong class="mj ir">import</strong> svm<br/><strong class="mj ir">from</strong> <strong class="mj ir">sklearn</strong> <strong class="mj ir">import</strong> neighbors<br/><strong class="mj ir">from</strong> <strong class="mj ir">lightgbm</strong> <strong class="mj ir">import</strong> LGBMRegressor<br/><strong class="mj ir">from</strong> <strong class="mj ir">xgboost</strong> <strong class="mj ir">import</strong> XGBRegressor<br/><strong class="mj ir">import</strong> <strong class="mj ir">logging</strong></span><span id="cf5e" class="mn lc iq mj b gy ms mp l mq mr">logging.basicConfig(level=logging.INFO)</span></pre><p id="9b54" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘éµå¾ªçš„æ€ç»´æ¨¡å¼å¦‚ä¸‹:</p><ol class=""><li id="7339" class="mt mu iq kf b kg kh kk kl ko mv ks mw kw mx la my mz na nb bi translated">æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªç©ºåˆ—è¡¨å¹¶ç”¨å¯¹(<em class="nc"> model_name </em>ï¼Œ<em class="nc"> model </em>)å¡«å……å®ƒ</li><li id="bf80" class="mt mu iq kf b kg nd kk ne ko nf ks ng kw nh la my mz na nb bi translated">æˆ‘ä»¬å°†é€šè¿‡Scikit-Learn KFoldäº¤å‰éªŒè¯æ¥å®šä¹‰åˆ†å‰²æ•°æ®çš„å‚æ•°</li><li id="5b83" class="mt mu iq kf b kg nd kk ne ko nf ks ng kw nh la my mz na nb bi translated">æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªforå¾ªç¯ï¼Œäº¤å‰éªŒè¯æ¯ä¸ªæ¨¡å‹å¹¶ä¿å­˜å…¶æ€§èƒ½</li><li id="c16a" class="mt mu iq kf b kg nd kk ne ko nf ks ng kw nh la my mz na nb bi translated">æˆ‘ä»¬å°†æŸ¥çœ‹æ¯ä¸ªå‹å·çš„æ€§èƒ½ï¼Œä»¥ä¾¿é€‰æ‹©æ€§èƒ½æœ€ä½³çš„å‹å·</li><li id="09e7" class="mt mu iq kf b kg nd kk ne ko nf ks ng kw nh la my mz na nb bi translated">æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªåˆ—è¡¨å¹¶æ’å…¥æˆ‘ä»¬æƒ³è¦æµ‹è¯•çš„æ¨¡å‹ã€‚</li></ol><p id="1310" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">è®©æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªåˆ—è¡¨ï¼Œå¹¶æ’å…¥æˆ‘ä»¬æƒ³è¦æµ‹è¯•çš„æ¨¡å‹ã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="2983" class="mn lc iq mj b gy mo mp l mq mr">models = []<br/>models.append(('Lasso', linear_model.Lasso()))<br/>models.append(('Ridge', linear_model.Ridge()))<br/>models.append(('EN', linear_model.ElasticNet()))<br/>models.append(('RandomForest', ensemble.RandomForestRegressor()))<br/>models.append(('KNR', neighbors.KNeighborsRegressor()))<br/>models.append(('DT', tree.DecisionTreeRegressor()))<br/>models.append(('ET', tree.ExtraTreeRegressor()))<br/>models.append(('LGBM', LGBMRegressor()))<br/>models.append(('XGB', XGBRegressor()))<br/>models.append(('GBM', ensemble.GradientBoostingRegressor()))<br/>models.append(("SVR", svm.LinearSVR()))</span></pre><p id="a9f3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">å¯¹äºå±äº<em class="nc">æ¨¡å‹çš„</em>åˆ—è¡¨ä¸­çš„æ¯ä¸ªæ¨¡å‹ï¼Œæˆ‘ä»¬å°†é€šè¿‡<a class="ae kc" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.KFold.html" rel="noopener ugc nofollow" target="_blank"> model_selectionæ¥è¯„ä¼°å…¶æ€§èƒ½ã€‚KFold </a>ã€‚å®ƒçš„å·¥ä½œæ–¹å¼ç›¸å½“ç®€å•:æˆ‘ä»¬çš„è®­ç»ƒæ•°æ®é›†(<em class="nc"> X_trainï¼Œy_train </em>)å°†è¢«åˆ†æˆç›¸ç­‰çš„éƒ¨åˆ†(ç§°ä¸º<em class="nc"> folds </em>)ï¼Œåˆ†åˆ«è¿›è¡Œæµ‹è¯•ã€‚å› æ­¤ï¼ŒKFoldäº¤å‰éªŒè¯å°†<strong class="kf ir">æä¾›æ¯ä¸ªåˆ†å‰²çš„å¹³å‡æ€§èƒ½æŒ‡æ ‡ï¼Œè€Œä¸æ˜¯åŸºäºæ•´ä¸ªè®­ç»ƒæ•°æ®é›†çš„å•ä¸€æŒ‡æ ‡</strong>ã€‚è¿™é¡¹æŠ€æœ¯éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå…è®¸æ‚¨æ›´ç²¾ç¡®åœ°æµ‹é‡æ¨¡å‹çš„æ€§èƒ½ã€‚</p><p id="7068" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ç”±äºè¿™æ˜¯ä¸€ä¸ªå›å½’é—®é¢˜ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å‡æ–¹å·®(MSE)åº¦é‡ã€‚</p><p id="a6a0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">è®©æˆ‘ä»¬å®šä¹‰äº¤å‰éªŒè¯çš„å‚æ•°ï¼Œå¹¶åˆå§‹åŒ–å¾ªç¯çš„ã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="9c6f" class="mn lc iq mj b gy mo mp l mq mr">n_folds = <strong class="mj ir">5</strong> # number of splits <br/>results = [] # save the performances in this list<br/>names = [] # this list helps us save the model names for visualization<br/><br/># we begin the loop where we'll test each model in the models list<br/><strong class="mj ir">for</strong> name, model <strong class="mj ir">in</strong> models:<br/>    kfold = model_selection.KFold(n_splits=n_folds)<br/>    logging.INFO("Testing model:", name)</span><span id="a1b2" class="mn lc iq mj b gy ms mp l mq mr">    cv_results = model_selection.cross_val_score(<br/>        model, # the model picked from the list<br/>        X_train, # feature train set<br/>        y_train, # target train set<br/>        cv=kfold, # current split<br/>        scoring="neg_mean_squared_error", <br/>        verbose=<strong class="mj ir">0</strong>, <br/>        n_jobs=-<strong class="mj ir">1</strong>)</span><span id="7274" class="mn lc iq mj b gy ms mp l mq mr">    results.append(cv_results)<br/>    names.append(name)</span><span id="e14e" class="mn lc iq mj b gy ms mp l mq mr">    msg = "%s: %f (%f)" % (name, cv_results.mean(), cv_results.std())</span><span id="3b13" class="mn lc iq mj b gy ms mp l mq mr">    logging.INFO(msg+"<strong class="mj ir">\n</strong>")</span></pre><p id="5627" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æ¯ä¸ªæ¨¡å‹éƒ½å°†è¿›è¡Œäº¤å‰éªŒè¯å’Œæµ‹è¯•ï¼Œå…¶æ€§èƒ½å°†ä¿å­˜åœ¨<em class="nc">ç»“æœ</em>ä¸­ã€‚</p><p id="f09c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">å¯è§†åŒ–éå¸¸ç®€å•ï¼Œå°†é€šè¿‡ç®±çº¿å›¾æ¥å®Œæˆã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="437c" class="mn lc iq mj b gy mo mp l mq mr"># Compare our models in a box plot<br/>fig = plt.figure(figsize=(<strong class="mj ir">12</strong>,<strong class="mj ir">7</strong>))<br/>fig.suptitle('Algorithm Comparison')<br/>ax = fig.add_subplot(<strong class="mj ir">111</strong>)<br/>plt.boxplot(results)<br/>ax.set_xticklabels(names)<br/>plt.show()</span></pre><h1 id="5505" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">æœ€åçš„ç»“æœ</h1><p id="c532" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">æœ€ç»ˆç»“æœå°†æ˜¯è¿™æ ·çš„:</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/303621704a543ad26c19f761b7569576.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BAvGRmcvECe9C4Ac2tTp3Q.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">æˆ‘ä»¬çš„æ¨¡å‹é€‰æ‹©è„šæœ¬çš„æœ€ç»ˆè¾“å‡º</figcaption></figure><p id="3d1e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ä»è¿™é‡Œå¯ä»¥çœ‹å‡ºRandomForestå’ŒGradientBoostingMachineæ˜¯å¦‚ä½•è¡¨ç°æœ€å¥½çš„æœºå‹ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹åˆ›å»ºæ–°çš„å®éªŒï¼Œå¹¶è¿›ä¸€æ­¥æµ‹è¯•è¿™ä¸¤ä¸ªæ¨¡å‹ã€‚</p><h1 id="a63d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">æŠŠæ‰€æœ‰çš„æ”¾åœ¨ä¸€èµ·</h1><p id="1811" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">è¿™æ˜¯ç”¨äºæ¨¡å‹é€‰æ‹©çš„å¤åˆ¶ç²˜è´´æ¨¡æ¿ï¼Œæˆ‘ä¼šåœ¨model_selection.pyè„šæœ¬ä¸­æ–¹ä¾¿åœ°ä½¿ç”¨å®ƒ(æˆ‘åœ¨è¿™é‡Œè®¨è®ºå¦‚ä½•æ„å»ºä¸€ä¸ªæœºå™¨å­¦ä¹ é¡¹ç›®<a class="ae kc" href="https://medium.com/mlearning-ai/how-to-structure-your-machine-learning-project-62f8a1eef582" rel="noopener"/></p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="nj nk l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">ç”¨äºæ¨¡å‹é€‰æ‹©çš„å¤åˆ¶-ç²˜è´´å°±ç»ªæ¨¡æ¿</figcaption></figure><h1 id="217c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">ç»“è®º</h1><p id="3398" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">å¾ˆé«˜å…´ä½ æ¥äº†ã€‚å¸Œæœ›æ‚¨ä¼šå‘ç°è¿™ç¯‡æ–‡ç« å¾ˆæœ‰ç”¨ï¼Œå¹¶åœ¨æ‚¨çš„ä»£ç åº“ä¸­å®ç°å…¶ä¸­çš„ä¸€äº›ç‰‡æ®µã€‚</p><p id="1f63" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">å¦‚æœä½ æƒ³æ”¯æŒæˆ‘çš„å†…å®¹åˆ›ä½œæ´»åŠ¨ï¼Œè¯·éšæ—¶å…³æ³¨æˆ‘ä¸‹é¢çš„æ¨èé“¾æ¥ï¼Œå¹¶åŠ å…¥Mediumçš„ä¼šå‘˜è®¡åˆ’ã€‚æˆ‘å°†è·å¾—ä½ æŠ•èµ„çš„ä¸€éƒ¨åˆ†ï¼Œä½ å°†èƒ½å¤Ÿä»¥æ— ç¼çš„æ–¹å¼è®¿é—®Mediumçš„å¤§é‡æ•°æ®ç§‘å­¦æ–‡ç« ã€‚</p><div class="nl nm gp gr nn no"><a href="https://medium.com/@theDrewDag/membership" rel="noopener follow" target="_blank"><div class="np ab fo"><div class="nq ab nr cl cj ns"><h2 class="bd ir gy z fp nt fr fs nu fu fw ip bi translated">é€šè¿‡æˆ‘çš„æ¨èé“¾æ¥åŠ å…¥Medium-Andrew D # data science</h2><div class="nv l"><h3 class="bd b gy z fp nt fr fs nu fu fw dk translated">é˜…è¯»Andrew D #datascience(ä»¥åŠåª’ä½“ä¸Šæˆåƒä¸Šä¸‡çš„å…¶ä»–ä½œè€…)çš„æ¯ä¸€ä¸ªæ•…äº‹ã€‚æ‚¨çš„ä¼šå‘˜è´¹ç›´æ¥â€¦</h3></div><div class="nw l"><p class="bd b dl z fp nt fr fs nu fu fw dk translated">medium.com</p></div></div><div class="nx l"><div class="ny l nz oa ob nx oc jw no"/></div></div></a></div><p id="dc46" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ç¥ä½ æ„‰å¿«ã€‚ç•™å¾—å®‰å¥½ğŸ‘‹</p></div></div>    
</body>
</html>