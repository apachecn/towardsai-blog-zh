# æ—¶é—´åºåˆ—é¢„æµ‹çš„è‡ªé€‚åº”å­¦ä¹ 

> åŸæ–‡ï¼š<https://pub.towardsai.net/adaptive-learning-for-time-series-forecasting-b34e640b865b?source=collection_archive---------0----------------------->

æ—¶é—´åºåˆ—é¢„æµ‹åº”ç”¨åœ¨ä»èƒ½æºåˆ°åŒ»ç–—ä¿å¥ç­‰å„ç§è¡Œä¸šä¸­çš„é‡è¦æ€§ä¸è¨€è€Œå–»ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ç›´æ¥è¿›å…¥æ­£é¢˜ã€‚æˆ‘ä»¬åœ¨å¤„ç†æ—¶é—´åºåˆ—æ•°æ®é›†æ—¶å¯èƒ½é¢ä¸´çš„å¤æ‚è€Œå›°éš¾çš„æŒ‘æˆ˜ä¹‹ä¸€æ˜¯å®ƒä»¬åœ¨ç»Ÿè®¡ç‰¹å¾ä¸Šçš„å¤šæ ·æ€§ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´å®ƒä»¬çš„åˆ†å¸ƒå‘ç”Ÿå˜åŒ–ï¼Œä»è€Œå¯¼è‡´å„ç§è¡Œä¸ºï¼Œä½¿å®ƒä»¬éš¾ä»¥é€šè¿‡æ¨¡å‹æ¥ç†è§£ã€‚æœ¬æ–‡æä¾›äº†ä¸€ä¸ªä¸¤é˜¶æ®µæ¨¡å‹æ¥å¤„ç†æ—¶é—´åå˜é‡ç§»ä½(TCS)ï¼›ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º ADaRNN(è‡ªé€‚åº”å­¦ä¹ å’Œ RNN çš„ç»“åˆ)ã€‚ä½ å¯ä»¥æ‰¾åˆ°æ‰€æœ‰ç« èŠ‚çš„è¯¦å°½è§£é‡Šï¼›åŒæ—¶ï¼Œä½ å¯ä»¥çœ‹åˆ°æ•°å­¦å…¬å¼ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£ã€‚å¦ç‡åœ°è¯´ï¼Œè¿™æ˜¯æˆ‘ä»¬ç¬¬ä¸€æ¬¡å¯ä»¥ä»åˆ†å¸ƒçš„è§’åº¦ç ”ç©¶æ—¶é—´åºåˆ—æ•°æ®é›†ã€‚

![](img/69d0dcbeb93b7116a3357ca5faadb71f.png)

[æ¥æº](https://giphy.com/gifs/MentoringMinds-lcj8Wjb92d4cBj45hg)

## é—®é¢˜)

æ—¶é—´åºåˆ—çš„ç‰¹å¾åº”è¯¥æ˜¯éšæ—¶é—´è€Œå˜åŒ–çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç§°è¿™ç±»æ•°æ®(ä½œä¸ºæ—¶é—´çš„å‡½æ•°)**éå¹³ç¨³**ã€‚æˆ‘ä»¬ä¸èƒ½å¤„ç†é™æ€æ•°æ®ï¼›æˆ‘çš„æ„æ€æ˜¯ï¼Œå¦‚æœæ•°æ®ä¸éšç€æ—¶é—´çš„æ¨ç§»è€Œæ”¹å˜ï¼Œé‚£è¿˜æœ‰ä»€ä¹ˆæ„ä¹‰å‘¢(*çœŸçš„å¾ˆç®€å•*ï¼) ?ï¼Ÿï¼ï¼æ‰€ä»¥ï¼Œè¿™ç§ä¸ç¨³å®šçš„äº‹å®ç›¸å½“äºåœ¨ä¸€æ®µæ—¶é—´å†…æœ‰ä¸åŒçš„åˆ†å¸ƒã€‚è¿™æ˜¯æ—¶é—´åºåˆ—æ•æ‰çš„ä¸€ä¸ªè¦ç‚¹ã€‚ä¸ºäº†æ›´å¥½çš„ç†è§£ï¼Œä½ å¯ä»¥çœ‹çœ‹ä¸‹å›¾:

![](img/ba4a5c11730e72bf35b1ce6bbdd52ff5.png)

å›¾ä¸€ã€‚[ [æ¥æº](https://arxiv.org/pdf/2108.04443.pdf)

å›¾ 1 ä¸­çš„æ•°æ®é›†æ˜¯ä¸€ä¸ªå¤šå˜é‡æ—¶é—´åºåˆ—æ•°æ®é›†ï¼Œåˆ†ä¸ºä¸‰ä¸ªæ—¶æ®µ Aã€Bã€C å’Œ Testã€‚æˆ‘ä»¬å¾ˆå®¹æ˜“çœ‹åˆ°è¿™äº›åˆ†å¸ƒæ˜¯ä¸å¹³ç­‰çš„ã€‚

## è§£å†³æ–¹æ¡ˆ)

é˜¿è¾¾æ©

## è§£è¯»)

æˆ‘ä»¬å¯ä»¥å°† RNNs è§†ä¸ºæœ€æµè¡Œçš„ç®—æ³•æ¶æ„ä¹‹ä¸€ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä»ä½¿ç”¨å…¶ç±»å‹ä¸­æœ€æµè¡Œçš„å¼€å§‹ã€‚ä¸ºäº†é˜²æ­¢è¿™ç¯‡æ–‡ç« æ›´é•¿ï¼Œæˆ‘ä¸æ‰“ç®—è¯¦ç»†æè¿° RNNs ä¸è¿‡å¯ä»¥ç»™[æ–¯å¦ç¦æ·±åº¦å­¦ä¹ å•](https://stanford.edu/~shervine/teaching/cs-230/cheatsheet-recurrent-neural-networks)å…³äº RNNsã€‚

> åˆ«æ‹…å¿ƒï¼Œæˆ‘çŸ¥é“åº”ç”¨å˜å½¢é‡‘åˆšæœ‰å¾ˆå¤šè¿›æ­¥ï¼Œä½†è¿™åªæ˜¯ä¸€ä¸ªå¼€å§‹ï¼›æˆ‘ä»¬ç¨åå†è®¨è®ºã€‚

å—¯ï¼Œå—¯ï¼Œå—¯ï¼›æˆ‘å‘Šè¯‰è¿‡ä½  AdaRNN æœ‰ä¸¤ä¸ªæ­¥éª¤:

1.  **æ—¶é—´åˆ†å¸ƒç‰¹å¾åŒ–(TDC)ç®—æ³•**
2.  **æ—¶é—´åˆ†å¸ƒåŒ¹é…(TDM)ç®—æ³•**

æ€»è€Œè¨€ä¹‹:

**TDC** å°†è®­ç»ƒæ•°æ®é›†åˆ†æˆ K ä¸ªæœ€å¤šæ ·åŒ–çš„åŒºé—´ã€‚(å…·æœ‰æœ€å¤§åˆ†å¸ƒé—´éš™)ç„¶å: **TDM** åˆ©ç”¨ RNN å‡å°‘å‘æ•£åˆ†å¸ƒã€‚

> æ­£å¦‚æˆ‘æ‰€è¯´ï¼Œè¿™æ˜¯æˆ‘ä»¬ç¬¬ä¸€æ¬¡ä»åˆ†å¸ƒè§’åº¦è€ƒè™‘æ—¶é—´åºåˆ—ï¼ï¼é‚£ä¹ˆè¿™æ„å‘³ç€ä»€ä¹ˆå‘¢ï¼Ÿ

## åˆ†é…

é€šå¸¸ï¼Œæœ‰ä¸¤ç§ä¸»è¦çš„åˆ†å‘æ–¹æ³•:

1.  **é¢†åŸŸç»¼åˆ(DG)ç®—æ³•**
2.  **åŸŸè‡ªé€‚åº”(DA)ç®—æ³•**

æ€»è€Œè¨€ä¹‹:

**DG** è¡¨ç¤ºæ¨¡å‹åœ¨å¤„ç†æœªçŸ¥æ•°æ®å’Œå¤„ç†å‡ ä¸ªç›¸äº’å…³è”çš„ä¸åŒé¢†åŸŸæ—¶çš„è¡¨ç°ï¼Œè€Œ **DA** åˆ™è¯•å›¾åœ¨åŒ…å«å¤§é‡å¼‚å¸¸æˆ–æ„å¤–æ•°æ®è¡Œä¸ºçš„è¾“å‡ºæ•°æ®ä¸Šæ”¹è¿›æ¨¡å‹ã€‚è¿™ä¸¤ä¸ªä¸åŒä¹‹å¤„åœ¨äºï¼Œä¸€ä¸ªè®¿é—®**æµ‹è¯•æ•°æ®é›†**è€Œå¦ä¸€ä¸ªä¸è®¿é—®ã€‚ç„¶è€Œï¼Œæœ¬æ–‡ä¸­çš„æƒ…å†µå¹¶éå¦‚æ­¤ï¼Œå› ä¸ºæˆ‘ä»¬ç”¨æˆ‘ä»¬çš„æ–¹æ³•è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚:)

# æ°å½“çš„ä¾‹å­

## ä¸€èˆ¬æ¥è¯´

![](img/cc25fd9d48ec056bbdfc8adcb3b51c01.png)

å›¾äºŒã€‚AdaRNN æ¶æ„[ [æ¥æº](https://arxiv.org/pdf/2108.04443.pdf)

ä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°çœ‹åˆ°ä¸¤ä¸ª**é¢œè‰²æ¡†**è¡¨è¾¾äº†è¿™ä¸ªæ¨¡å‹çš„ä¸¤ä¸ªä¸»è¦æ­¥éª¤ï¼Œ **TDC** å’Œ **TDM** ï¼Œç¬¬ä¸€ä¸ª**é€šè¿‡å°†å®ƒåˆ†è§£ä¸ºè¿‡ç¨‹æ¥æŒ‡å®šåˆ†å¸ƒ**ï¼Œéšå**è°ƒæ•´åˆ†å¸ƒ**ä»¥é¦ˆç»™ä¸»æ¨¡å‹ **M** ç”¨äº**é¢„æµ‹**ã€‚æœ€åï¼Œç”¨è‡ªé€‚åº” RNN æ¨¡å‹è¿›è¡Œé¢„æµ‹ã€‚

ä¸€åˆ†ï¼ï¼åˆç†çš„æ˜¯å­¦ä¹ /ç»ƒä¹ /é”»ç‚¼ï¼Œè®©è‡ªå·±åšå¥½æœ€åæƒ…å†µçš„å‡†å¤‡ï¼›æ‰€ä»¥ï¼Œå¯¹äº AdaRNN æ¥è¯´æ˜¯çœŸçš„ï¼Œç ”ç©¶äººå‘˜ç”¨å›°éš¾çš„ä»»åŠ¡(æˆ‘æŒ‡çš„æ˜¯åˆ†é…)è®­ç»ƒæ¨¡å‹ã€‚

## TDC(æ—¶é—´åˆ†å¸ƒç‰¹å¾åŒ–)

TDC çš„åŸºæœ¬åŸç†æ˜¯æœ€å¤§ç†µåŸç†ï¼›å®ƒè¯•å›¾æœ€å¤§é™åº¦åœ°åˆ©ç”¨æ—¶é—´åºåˆ—ä¸­çš„å…±äº«çŸ¥è¯†ï¼Œæ˜¯å¦‚ä½•åšåˆ°çš„ï¼Ÿï¼Ÿé€šè¿‡åœ¨å¹¿æ³›çš„åˆ†å¸ƒèŒƒå›´ä¸Šè®­ç»ƒæ¨¡å‹ï¼›æ¢å¥è¯è¯´ï¼Œå…·æœ‰æœ€å¤§æ•°é‡çš„éç›¸ä¼¼åˆ†å¸ƒã€‚é€»è¾‘å¾ˆç®€å•ï¼Œå¦‚æœæ¨¡å‹å¯ä»¥å¤„ç†è¿™ä¸€ç‚¹ï¼Œå®ƒå°†èƒ½å¤Ÿç®¡ç†æœªæ¥/çœ‹ä¸è§çš„æ•°æ®ã€‚è¯·çœ‹å›¾ 3:

![](img/b6a39473b391665e2be6ad9f27c196f2.png)

å›¾ 3ã€‚æ—¶é—´åˆ†å¸ƒç‰¹å¾(TDC) [ [æ¥æº](https://arxiv.org/pdf/2108.04443.pdf)

ä»æ•°å­¦è§’åº¦æ¥çœ‹ï¼Œæˆ‘ä»¬æœ‰ç­‰å¼ 1:

![](img/f510cd8b0feeebcc6f249b99f8ae0cfe.png)

ç­‰å¼ 1ã€‚

æˆ‘ä»¬ä½¿ç”¨**è¶…å©´å„¿è½¦**æ¥é˜²æ­¢**è¿‡åº¦åˆ†å‰²**ï¼Œä½¿ç”¨**é¢„å®šä¹‰å©´å„¿è½¦**æ¥é˜²æ­¢**çç¢è§£å†³æ–¹æ¡ˆ**ã€‚

> è®©æˆ‘ä»¬ä¸è¦åœ¨æ•°å­¦ä¸Šè¿·æƒ‘è‡ªå·±ã€‚ğŸ¤¯ğŸ˜…

ç­‰å¼ 1 çš„ç›®æ ‡æ˜¯æœ€å¤§åŒ–è·ç¦» d(å®ƒå¯ä»¥æ˜¯ä»æ¬§å‡ é‡Œå¾—åˆ° etc çš„ä»»ä½•ç±»å‹çš„è·ç¦»å‡½æ•°ã€‚)å¦‚æœæˆ‘ä»¬é€‰æ‹©ä¸€ä¸ªå¥½çš„è·ç¦»åº¦é‡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨**åŠ¨æ€è§„åˆ’**æ¥å®Œæˆ TDC çš„ç›®çš„åœ°ã€‚

åœ¨è¿™é¡¹ç ”ç©¶ä¸­ï¼Œç ”ç©¶äººå‘˜å°†æ•°æ®é›†åˆ†æˆ N=10 ä¸ªæ¯”ä¾‹ï¼Œæˆ‘ä»¬ä¸èƒ½å†åˆ†æˆæ›´å°çš„æ¯”ä¾‹ã€‚

*   **K** çš„æ˜¾è‘—**å¤§**æˆ–**å°**å€¼ä¼šå¯¼è‡´**æ²¡æœ‰æœŸæœ›çš„**å‹å·**æ€§èƒ½**ã€‚

## TDM(æ—¶é—´åˆ†å¸ƒåŒ¹é…)

æˆ‘ä»¬ä½¿ç”¨ TDM é€šè¿‡ä½¿ç”¨å„ç§åˆ†å¸ƒå‘¨æœŸæ¥ç ”ç©¶å…±äº«çš„å…¬å…±çŸ¥è¯†ã€‚å…¶æŸå¤±å‡½æ•°å¯è¡¨ç¤ºå¦‚ä¸‹:

![](img/45e336db76ab2c5a757e48e872d674fe.png)

ç­‰å¼ 2ã€‚

åœ¨è¿™é¡¹ç ”ç©¶ä¸­ï¼Œåˆ†å¸ƒçš„æ­£åˆ™åŒ–æ˜¯åœ¨ RNN æ¨¡å‹çš„æœ€ç»ˆè¾“å‡ºä¸Šå®ç°çš„ã€‚ç­‰å¼ 3 æ˜¯ pare (Diï¼ŒDj)çš„æœ€ç»ˆéšè—çŠ¶æ€çš„å‘¨æœŸå¼åˆ†å¸ƒåŒ¹é…:

![](img/54c75deb0b2fc7035b77069c46d987bf.png)

ç­‰å¼ 3ã€‚

ç„¶è€Œï¼Œå¯¹äºéšè—çŠ¶æ€ï¼Œè¿™ä¸ªæ­£åˆ™åŒ–é¡¹åœ¨ä¾èµ–äºæ—¶é—´æ—¶ä¸¢å¤±ã€‚ä¸ºä»€ä¹ˆï¼Ÿï¼Ÿå› ä¸ºæ¯ä¸ªéšè—çŠ¶æ€å•ç‹¬åœ°åŒ…æ‹¬å…³äºåˆ†å¸ƒçš„å…¨éƒ¨ä¿¡æ¯çš„ä¸€éƒ¨åˆ†ã€‚

> å› æ­¤ï¼Œè¿™æ˜¯ä¸€ä¸ªé—®é¢˜ï¼ï¼ä¸æ˜¯å—ï¼Ÿï¼Ÿæˆ‘ä»¬èƒ½åšä»€ä¹ˆï¼Ÿï¼ŸğŸ¤”

å—¯ï¼Œåœ¨æ„å»ºåˆ†å¸ƒåŒ¹é…æ­£åˆ™åŒ–å­çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¿…é¡»è€ƒè™‘æ¯ä¸ª ***éšè—çš„*çŠ¶æ€**ã€‚é‚£ä¹ˆè¿™æ„å‘³ç€ä»€ä¹ˆå‘¢ï¼Ÿï¼Ÿé¦–å…ˆï¼Œçœ‹çœ‹ TDM æ¶æ„:

![](img/cb5b3579827419c87690b56c1fd800cc.png)

å›¾ 4ã€‚æ—¶é—´åˆ†å¸ƒåŒ¹é…(TDM) [ [æ¥æº](https://arxiv.org/pdf/2108.04443.pdf)

TDM çš„è¦ç‚¹æ˜¯åŒæ—¶é¢„æµ‹æ—¶é—´åºåˆ—æ•°æ®å’ŒåŒ¹é… RNN å•å…ƒä¹‹é—´çš„åˆ†å¸ƒã€‚æœ‰ä¸€ä¸ªåä¸º*é‡è¦æ€§å‘é‡*çš„å‚æ•°ï¼Œç”¨äºè£…å¤‡æ¨¡å‹ä»¥å‡å°‘åˆ†å¸ƒå·®å¼‚ã€‚ç­‰å¼ 4 ç»™å‡ºäº†æ—¶åºåˆ†å¸ƒåŒ¹é…çš„æŸå¤±:

![](img/cfdc36f8c4c400712847af2aa29dcd57.png)

Eq 4ã€‚

é€šè¿‡ä½¿ç”¨ç­‰å¼ 4 å’Œ 2ï¼Œæˆ‘ä»¬å¯ä»¥å¯¼å‡ºç­‰å¼ 5 ( **æˆ‘ä»¬çš„æ¨¡å‹**çš„ç»ˆç«¯ç›®æ ‡å‡½æ•°):

![](img/265e0bf9a0e5471fb6830386e82a114c.png)

Eq 5ã€‚

> æˆ‘ä¸ä¼šè¯¦ç»†æè¿°å®ƒæ•°å­¦åŸç†ï¼›ä½†æ˜¯ï¼Œä½ å¯ä»¥é€šè¯»ä¸»è¦è®ºæ–‡ã€‚

# èµ„æ–™ç»„

æ¨¡å‹è¯„ä¼°(åˆ†ç±»å’Œå›å½’)ä½¿ç”¨äº†ä¸åŒè¡Œä¸šçš„å››ä¸ªæ—¶é—´åºåˆ—æ•°æ®é›†(**äººç±»æ´»åŠ¨è¯†åˆ«ã€ç©ºæ°”è´¨é‡é¢„æµ‹ã€å®¶åº­ç”¨ç”µé‡ã€**å’Œ**è‚¡ä»·é¢„æµ‹**)ã€‚æ‚¨å¯ä»¥åœ¨è¡¨ 1 ä¸­çœ‹åˆ°æ•°æ®é›†å¤§å°çš„æ±‡æ€»ã€‚

![](img/24982a76afc0e1807b4b64bdf173b851.png)

è¡¨ 1ã€‚[ [æ¥æº](https://arxiv.org/pdf/2108.04443.pdf)

# ç»“æœ

AdaRNN ä¸å…¶ä»–æ·±åº¦/æœºå™¨å­¦ä¹ æ¨¡å‹è¿›è¡Œäº†æ¯”è¾ƒï¼ŒåŒ…æ‹¬:

1.  ä¼ ç»Ÿçš„(ARIMAã€å…ˆçŸ¥ã€GRU ç­‰ã€‚)
2.  æœ€æ–°æ¬¾(æ¡çº¹ç­‰ã€‚)
3.  å˜å½¢é‡‘åˆš(ç”µå½±å)

æ‚¨å¯ä»¥åœ¨è¡¨ 2 ä¸­çœ‹åˆ° ADaRNN ä¸å…¶ä»–æ¨¡å‹çš„ç»“æœ:

![](img/f6544422cd07be41cf7c9674c56314aa.png)

è¡¨äºŒã€‚[ [æ¥æº](https://arxiv.org/pdf/2108.04443.pdf)

**äº”ä¸ªæŒ‡æ ‡**è¢«ç”¨äº**è¯„ä¼°**ï¼ŒåŒ…æ‹¬ **ACC(å‡†ç¡®åº¦)ã€P(ç²¾åº¦)ã€recall (R)ã€F1 å’Œ AUC(æ›²çº¿ä¸‹é¢ç§¯**)ã€‚

å¦‚æ‚¨æ‰€è§ï¼ŒAdaRNN ä¸åŒç±»äº§å“ç›¸æ¯”æ˜¾ç¤ºå‡ºæ›´å¥½çš„ç»“æœã€‚

åœ¨æœ¬ç ”ç©¶ä¸­ï¼Œè¯¥æ–¹æ³•è¢«åº”ç”¨äºæ¯ä¸ªè‡ªæˆ‘æ³¨æ„å—ä¸­çš„å˜å‹å™¨(AdaTransformer)ã€‚å¦‚è¡¨ 3 æ‰€ç¤ºï¼Œä¸åŸå§‹ç‰ˆæœ¬(Vanilla Transformer)ç›¸æ¯”ï¼ŒAdaTransformer çš„ç»“æœæ›´å¥½:

![](img/64e09000a3afacd17a0b131c4149f682.png)

è¡¨ 3ã€‚[ [æ¥æº](https://arxiv.org/pdf/2108.04443.pdf)

## **ç»“å°¾**

> åœ¨ä»¥åçš„æ–‡ç« ä¸­ï¼Œæˆ‘å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•ä¸ºæˆ‘ä»¬çš„æ¨¡å‹ç¼–å†™ TDM å’Œ TDC ä»£ç ï¼Œä»¥åŠå¦‚ä½•å®ç° AdaRNNã€‚

> æ¥æºæ˜¯[è¿™ä¸ª](https://arxiv.org/pdf/2108.04443.pdf)ã€‚
> 
> ä½ å¯ä»¥**åœ¨ **Twitter** [è¿™é‡Œ](https://twitter.com/reza__yazdanfar)æˆ–è€… **LinkedIn** [è¿™é‡Œ](http://www.linkedin.com/in/rezayazdanfar)è”ç³»**æˆ‘ã€‚æœ€åï¼Œå¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰è¶£å¹¶ä¸”æœ‰ç”¨ï¼Œä½ å¯ä»¥åœ¨**åª’ä½“**ä¸Š**å…³æ³¨**æˆ‘ä»¥è·å–æ›´å¤šæ¥è‡ªæˆ‘çš„æ–‡ç« ã€‚