# ä½¿ç”¨ GANs ç”Ÿæˆåˆæˆåºåˆ—æ•°æ®

> åŸæ–‡ï¼š<https://pub.towardsai.net/generating-synthetic-sequential-data-using-gans-a1d67a7752ac?source=collection_archive---------0----------------------->

## [æ·±åº¦å­¦ä¹ ](https://towardsai.net/p/category/machine-learning/deep-learning)

æ—¶åºæ•°æ®(å…·æœ‰æ—¶é—´ä¾èµ–æ€§çš„æ•°æ®)åœ¨å•†ä¸šä¸­éå¸¸å¸¸è§ï¼Œä»ä¿¡ç”¨å¡äº¤æ˜“åˆ°åŒ»ç–—ä¿å¥è®°å½•å†åˆ°è‚¡ç¥¨å¸‚åœºä»·æ ¼ã€‚ä½†éšç§æ³•è§„é™åˆ¶å¹¶å¤§å¤§å‡ç¼“äº†å¯¹ç ”å‘è‡³å…³é‡è¦çš„æœ‰ç”¨æ•°æ®çš„è®¿é—®ã€‚è¿™å°±äº§ç”Ÿäº†å¯¹å…·æœ‰é«˜åº¦ä»£è¡¨æ€§ä½†åˆå®Œå…¨ç§å¯†çš„åˆæˆåºåˆ—æ•°æ®çš„éœ€æ±‚ï¼Œè‡³å°‘å¯ä»¥è¯´è¿™æ˜¯ä¸€ç§æŒ‘æˆ˜ã€‚

ç”Ÿæˆåˆæˆæ—¶é—´åºåˆ—å’Œé¡ºåºæ•°æ®æ¯”è¡¨æ ¼æ•°æ®æ›´å…·æŒ‘æˆ˜æ€§ï¼Œè¡¨æ ¼æ•°æ®é€šå¸¸å°†ä¸€ä¸ªäººçš„æ‰€æœ‰ä¿¡æ¯å­˜å‚¨åœ¨ä¸€è¡Œä¸­ã€‚åœ¨é¡ºåºæ•°æ®ä¸­ï¼Œä¿¡æ¯å¯ä»¥åˆ†å¸ƒåœ¨è®¸å¤šè¡Œä¸­ï¼Œå¦‚ä¿¡ç”¨å¡äº¤æ˜“ï¼Œä¿æŒè¡Œ(äº‹ä»¶)å’Œåˆ—(å˜é‡)ä¹‹é—´çš„ç›¸å…³æ€§æ˜¯å…³é”®ã€‚æ­¤å¤–ï¼Œåºåˆ—çš„é•¿åº¦æ˜¯å¯å˜çš„ï¼›ä¸€äº›æ¡ˆä¾‹å¯èƒ½åªåŒ…å«å‡ ç¬”äº¤æ˜“ï¼Œè€Œå…¶ä»–æ¡ˆä¾‹å¯èƒ½åŒ…å«æ•°åƒç¬”äº¤æ˜“ã€‚

æ—¶åºæ•°æ®å’Œæ—¶é—´åºåˆ—[çš„ç”Ÿæˆæ¨¡å‹å·²ç»å¾—åˆ°äº†å¹¿æ³›çš„ç ”ç©¶](https://pubmed.ncbi.nlm.nih.gov/30535151/)ï¼Œç„¶è€Œï¼Œè®¸å¤šè¿™äº›åŠªåŠ›å¯¼è‡´äº†ç›¸å¯¹è¾ƒå·®çš„åˆæˆæ•°æ®è´¨é‡å’Œè¾ƒä½çš„çµæ´»æ€§ã€‚åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œæ¨¡å‹è¢«è®¾è®¡æˆç‰¹å®šäºæ¯ä¸ªé—®é¢˜ï¼Œå› æ­¤éœ€è¦è¯¦ç»†çš„é¢†åŸŸçŸ¥è¯†ã€‚

åœ¨æœ¬å¸–ä¸­ï¼Œæˆ‘ä»¬æè¿°å¹¶åº”ç”¨äº†ä¸€ç§æœ€æ–°çš„å¼ºå¤§æ–¹æ³•çš„æ‰©å±•ç‰ˆæœ¬æ¥ç”Ÿæˆåˆæˆåºåˆ—æ•°æ®â€” [äºŒé‡èº«](https://github.com/fjxmlzn/DoppelGANger)ã€‚å®ƒæ˜¯ä¸€ä¸ªåŸºäºç”Ÿæˆå¯¹æŠ—ç½‘ç»œ(GANs)çš„æ¡†æ¶ï¼Œå…·æœ‰ä¸€äº›åˆ›æ–°ï¼Œä½¿å¾—å¤æ‚åºåˆ—æ•°æ®é›†çš„åˆæˆç‰ˆæœ¬çš„ç”Ÿæˆæˆä¸ºå¯èƒ½ã€‚

æˆ‘ä»¬åœ¨è¿™é¡¹å·¥ä½œçš„åŸºç¡€ä¸Šå¼•å…¥äº†ä¸¤é¡¹åˆ›æ–°:

1.  åŠ é€Ÿ GAN æ”¶æ•›å’Œé¿å…æ¨¡å¼å´©æºƒçš„å­¦ä¹ ç­–ç•¥ã€‚
2.  é‰´åˆ«å™¨ä¸­è®¾è®¡è‰¯å¥½çš„å™ªå£°ï¼Œä»¥åœ¨ä¸é™ä½æ•°æ®è´¨é‡çš„æƒ…å†µä¸‹ä½¿è¿‡ç¨‹æœ‰å·®åˆ«åœ°ç§æœ‰ï¼Œä½¿ç”¨ä¿®æ”¹ç‰ˆæœ¬çš„çŸ©ä¼šè®¡ç­–ç•¥æ¥æé«˜æ¨¡å‹çš„ç¨³å®šæ€§ã€‚

# é¡ºåºæ•°æ®ç”Ÿæˆçš„å¸¸ç”¨æ–¹æ³•

å¤§å¤šæ•°æ—¶åºæ•°æ®ç”Ÿæˆæ¨¡å‹ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ä¹‹ä¸€:

**åŠ¨æ€å¹³ç¨³è¿‡ç¨‹**é€šè¿‡å°†æ—¶é—´åºåˆ—ä¸­çš„æ¯ä¸ªç‚¹è¡¨ç¤ºä¸ºæ·»åŠ äº†ä¸€äº›å™ªå£°çš„ç¡®å®šæ€§è¿‡ç¨‹çš„æ€»å’Œæ¥å·¥ä½œã€‚è¿™æ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„æ–¹æ³•ï¼Œé€šè¿‡åƒ[å¼•å¯¼](https://eranraviv.com/bootstrapping-time-series-r-code/)è¿™æ ·çš„æŠ€æœ¯æ¥å»ºæ¨¡æ—¶é—´åºåˆ—ã€‚ç„¶è€Œï¼Œä¸€äº›é•¿æœŸä¾èµ–å…³ç³»çš„å…ˆéªŒçŸ¥è¯†ï¼Œå¦‚å¾ªç¯æ¨¡å¼ï¼Œå¿…é¡»çº³å…¥çº¦æŸç¡®å®šæ€§è¿‡ç¨‹ã€‚è¿™ä½¿å¾—ç”¨å¤æ‚çš„ã€æœªçŸ¥çš„ç›¸å…³æ€§æ¥å»ºæ¨¡æ•°æ®é›†å˜å¾—éå¸¸å›°éš¾ã€‚

**é©¬å°”å¯å¤«æ¨¡å‹**æ˜¯ä¸€ç§é€šè¿‡å°†ç³»ç»ŸåŠ¨æ€è¡¨ç¤ºä¸ºæ¡ä»¶æ¦‚ç‡åˆ†å¸ƒæ¥å¯¹åˆ†ç±»æ—¶é—´åºåˆ—å»ºæ¨¡çš„æµè¡Œæ–¹æ³•ã€‚å˜ä½“ï¼Œå¦‚[éšé©¬å°”å¯å¤«æ¨¡å‹](https://link.springer.com/article/10.1023/A:1007469218079)ï¼Œä¹Ÿè¢«ç”¨äºæ—¶é—´åºåˆ—çš„åˆ†å¸ƒå»ºæ¨¡ã€‚è¿™ç§æ–¹æ³•çš„é—®é¢˜æ˜¯å®ƒä¸èƒ½æ•æ‰é•¿æœŸå¤æ‚çš„ä¾èµ–å…³ç³»ã€‚

**è‡ªå›å½’(AR)æ¨¡å‹**æ˜¯åŠ¨æ€å¹³ç¨³è¿‡ç¨‹ï¼Œå…¶ä¸­åºåˆ—ä¸­çš„æ¯ä¸ªç‚¹éƒ½è¢«è¡¨ç¤ºä¸ºå‰ *n* ä¸ªç‚¹çš„[å‡½æ•°ã€‚éçº¿æ€§ ar æ¨¡å‹(å¦‚ ARIMA)éå¸¸å¼ºå¤§ã€‚åƒé©¬å°”å¯å¤«æ¨¡å‹è¿™æ ·çš„ AR æ¨¡å‹æœ‰ä¸€ä¸ªä¿çœŸåº¦é—®é¢˜â€”â€”å®ƒä»¬äº§ç”Ÿçš„æ¨¡å‹è¿‡äºç®€å•ï¼Œæ— æ³•æ•æ‰å¤æ‚çš„æ—¶é—´ç›¸å…³æ€§ã€‚](https://arxiv.org/abs/1801.07736)

**é€’å½’ç¥ç»ç½‘ç»œ(RNNs)** æœ€è¿‘è¢«ç”¨äºæ·±åº¦å­¦ä¹ ä¸­çš„æ—¶é—´åºåˆ—å»ºæ¨¡ã€‚åƒè‡ªå›å½’å’Œé©¬å°”å¯å¤«æ¨¡å‹ä¸€æ ·ï¼ŒRNNs ä½¿ç”¨ä»¥å‰æ—¶é—´æ­¥é•¿çš„æ»‘åŠ¨çª—å£æ¥ç¡®å®šä¸‹ä¸€ä¸ªæ—¶é—´ç‚¹ã€‚rnn è¿˜å­˜å‚¨ä¸€ä¸ªå†…éƒ¨çŠ¶æ€å˜é‡ï¼Œè¯¥å˜é‡æ•è·æ—¶é—´åºåˆ—çš„æ•´ä¸ªå†å²ã€‚åƒé•¿çŸ­æœŸè®°å¿†ç½‘ç»œ(LTSMs)ä¸€æ ·ï¼ŒRNNs åœ¨å­¦ä¹ æ—¶é—´åºåˆ—æ•°æ®çš„åˆ¤åˆ«æ¨¡å‹æ–¹é¢å–å¾—äº†å·¨å¤§çš„æˆåŠŸï¼Œè¿™äº›æ¨¡å‹é¢„æµ‹ä»¥æ ·æœ¬ä¸ºæ¡ä»¶çš„æ ‡ç­¾ã€‚ç„¶è€Œï¼Œrnn ä¸èƒ½å­¦ä¹ æŸäº›ç®€å•çš„æ—¶é—´åºåˆ—åˆ†å¸ƒã€‚

**åŸºäº GAN çš„æ–¹æ³•**æˆ–ç”Ÿæˆå¼å¯¹æŠ—ç½‘ç»œæ¨¡å‹å·²ç»æˆä¸ºä¸€ç§ç”¨äºç”Ÿæˆæˆ–æ‰©å……æ•°æ®é›†(å°¤å…¶æ˜¯å›¾åƒå’Œè§†é¢‘)çš„æµè¡ŒæŠ€æœ¯ã€‚ç„¶è€Œï¼Œgan åœ¨ç½‘ç»œæ•°æ®ä¸­çš„ä¿çœŸåº¦è¾ƒå·®ï¼Œç½‘ç»œæ•°æ®æ—¢æœ‰å¤æ‚çš„æ—¶é—´ç›¸å…³æ€§ï¼Œåˆæœ‰æ··åˆçš„ç¦»æ•£-è¿ç»­æ•°æ®ç±»å‹ã€‚è™½ç„¶å­˜åœ¨åŸºäº GAN çš„æ—¶é—´åºåˆ—ç”ŸæˆæŠ€æœ¯ï¼Œä¾‹å¦‚[åŒ»å­¦æ—¶é—´åºåˆ—](https://github.com/mp2893/medgan)ï¼Œä½†è¿™ç§æŠ€æœ¯åœ¨æ›´å¤æ‚çš„æ•°æ®ä¸Šå¤±è´¥ï¼Œè¿™äº›æ•°æ®åœ¨é•¿åºåˆ—ä¸Šè¡¨ç°å‡ºè¾ƒå·®çš„è‡ªç›¸å…³å¾—åˆ†ï¼ŒåŒæ—¶æ˜“äºå‡ºç°æ¨¡å¼å´©æºƒã€‚è¿™æ˜¯ç”±äºæ•°æ®åˆ†å¸ƒæ˜¯é‡å°¾çš„å¹¶ä¸”é•¿åº¦å¯å˜ã€‚è¿™ä¼¼ä¹å¯¹ GANs æœ‰å¾ˆå¤§å½±å“ã€‚

# å¼•å…¥äºŒé‡èº«ä»¥ç”Ÿæˆé«˜è´¨é‡çš„åˆæˆæ—¶é—´åºåˆ—æ•°æ®

åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘å°†æ¢ç´¢æœ€è¿‘çš„æ¨¡å‹æ¥ç”Ÿæˆåˆæˆåºåˆ—æ•°æ®[åˆ†èº«](https://arxiv.org/pdf/1909.13403.pdf)ã€‚æˆ‘å°†ä½¿ç”¨è¿™ä¸ªåŸºäº GANs çš„æ¨¡å‹å’Œä¸€ä¸ªç”±é€’å½’å•å…ƒç»„æˆçš„ç”Ÿæˆå™¨ï¼Œä½¿ç”¨ä¸¤ä¸ªæ•°æ®é›†ç”Ÿæˆäº¤æ˜“æ•°æ®çš„åˆæˆç‰ˆæœ¬:é“¶è¡Œäº¤æ˜“å’Œé“è·¯äº¤é€šã€‚æˆ‘ä»¬ä½¿ç”¨äº†äºŒé‡èº«æ¨¡å‹çš„ä¿®æ”¹æ¥è§£å†³é¡ºåºæ•°æ®çš„ç”Ÿæˆæ¨¡å‹çš„å±€é™æ€§ã€‚

ä¼ ç»Ÿçš„ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ(GANs)ç”±äºä»¥ä¸‹é—®é¢˜è€Œéš¾ä»¥å¯¹åºåˆ—æ•°æ®å»ºæ¨¡:

*   å®ƒä»¬æ²¡æœ‰æ•æ‰åˆ°æ—¶æ€ç‰¹å¾å’Œå®ƒä»¬ç›¸å…³çš„(ä¸å¯å˜çš„)å±æ€§ä¹‹é—´çš„å¤æ‚å…³ç³»:ä¾‹å¦‚ï¼Œæ ¹æ®æ‰€æœ‰è€…çš„ç‰¹å¾(å¹´é¾„ã€æ”¶å…¥ç­‰)ï¼Œäº¤æ˜“ä¸­çš„ä¿¡ç”¨å¡æ¨¡å¼æ˜¯éå¸¸ä¸åŒçš„ã€‚
*   æ—¶é—´åºåˆ—ä¸­çš„é•¿æœŸç›¸å…³æ€§ï¼Œå¦‚æ—¥å˜åŒ–æ¨¡å¼:è¿™äº›ç›¸å…³æ€§åœ¨æ€§è´¨ä¸Šä¸å›¾åƒä¸­å‘ç°çš„ç›¸å…³æ€§éå¸¸ä¸åŒï¼Œå›¾åƒå…·æœ‰å›ºå®šçš„ç»´åº¦ï¼Œä¸éœ€è¦é€åƒç´ ç”Ÿæˆã€‚

äºŒé‡èº«èåˆäº†ä¸€äº›åˆ›æ–°çš„æƒ³æ³•ï¼Œæ¯”å¦‚:

*   ä½¿ç”¨ä¸¤ä¸ªç½‘ç»œ(å¤šå±‚æ„ŸçŸ¥å™¨ MLP å’Œé€’å½’ç½‘ç»œ)æ¥æ•è·æ—¶é—´ä¾èµ–æ€§
*   åˆ†ç¦»å±æ€§ç”Ÿæˆï¼Œä»¥æ›´å¥½åœ°æ•æ‰æ—¶é—´åºåˆ—åŠå…¶å±æ€§(ä¾‹å¦‚ï¼Œç”¨æˆ·çš„å¹´é¾„ã€ä½ç½®å’Œæ€§åˆ«)ä¹‹é—´çš„ç›¸å…³æ€§
*   æ‰¹é‡ç”Ÿæˆâ€”ç”Ÿæˆé•¿åºåˆ—çš„å°å †æ ˆæ‰¹é‡
*   å»è€¦å½’ä¸€åŒ–-å°†å½’ä¸€åŒ–å› å­æ·»åŠ åˆ°çº¦æŸè¦ç´ èŒƒå›´çš„ç”Ÿæˆå™¨ä¸­

DoppelGANger å°†å±æ€§çš„ç”Ÿæˆä¸æ—¶é—´åºåˆ—è§£è€¦ï¼ŒåŒæ—¶åœ¨æ¯ä¸ªæ—¶é—´æ­¥å°†å±æ€§æä¾›ç»™æ—¶é—´åºåˆ—ç”Ÿæˆå™¨ã€‚è¿™ä¸ä¼ ç»Ÿæ–¹æ³•å½¢æˆå¯¹æ¯”ï¼Œåœ¨ä¼ ç»Ÿæ–¹æ³•ä¸­ï¼Œå±æ€§å’Œç‰¹å¾æ˜¯è”åˆç”Ÿæˆçš„ã€‚

DoppelGANger çš„æ¡ä»¶ç”Ÿæˆæ¶æ„è¿˜æä¾›äº†æ›´æ”¹å±æ€§åˆ†å¸ƒå’Œå±æ€§æ¡ä»¶çš„çµæ´»æ€§ã€‚è¿™ä¹Ÿæœ‰åŠ©äºéšè—å±æ€§åˆ†å¸ƒï¼Œä»è€Œå¢åŠ éšç§ã€‚

äºŒé‡èº«æ¨¡å‹è¿˜å…·æœ‰æ ¹æ®æ•°æ®å±æ€§ç”Ÿæˆæ•°æ®ç‰¹å¾çš„ä¼˜åŠ¿ã€‚

![](img/c1e7ff5f0e137b2ef242b7dd08fac032.png)

**å›¾ 1** :åŸäºŒé‡èº«æ¨¡å‹ä¸¤ä¸ªå‘ç”Ÿå™¨æ¨¡å—å’Œä¸¤ä¸ªé‰´åˆ«å™¨çš„ç¤ºæ„å›¾ã€‚ä¿¡ç”¨:ã€https://arxiv.org/abs/1909.13403ã€‘T2ã€‚

è¿™ä¸ªæ¨¡å‹çš„å¦ä¸€ä¸ªç‰¹ç‚¹æ˜¯å®ƒå¦‚ä½•å¤„ç†æç«¯äº‹ä»¶ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸å…·æœ‰æŒ‘æˆ˜æ€§çš„é—®é¢˜ã€‚è·¨æ ·æœ¬çš„åºåˆ—æ•°æ®å…·æœ‰å¹¿æ³›çš„ç‰¹å¾å€¼å¹¶ä¸ç½•è§ï¼Œä¸€äº›äº§å“å¯èƒ½æœ‰æ•°åƒä¸ªäº¤æ˜“ï¼Œè€Œå¦ä¸€äº›åªæœ‰å‡ ä¸ªã€‚å¯¹äº GANs æ¥è¯´ï¼Œè¿™æ˜¯æœ‰é—®é¢˜çš„ï¼Œå› ä¸ºå®ƒæ˜¯æ¨¡å¼å´©æºƒçš„å¯é æ–¹æ³•â€”â€”æ ·æœ¬å°†åªåŒ…å«æœ€å¸¸è§çš„é¡¹ç›®ï¼Œè€Œå¿½ç•¥ç½•è§çš„äº‹ä»¶ã€‚å¯¹äºå›¾åƒâ€”â€”å‡ ä¹æ‰€æœ‰ GANs å·¥ä½œçš„ç„¦ç‚¹â€”â€”è¿™ä¸æ˜¯é—®é¢˜ï¼Œå› ä¸ºåˆ†å¸ƒæ˜¯å¹³æ»‘çš„ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆã€ŠäºŒé‡èº«ã€‹çš„ä½œè€…æå‡ºäº†ä¸€ç§åˆ›æ–°çš„æ–¹æ³•æ¥å¤„ç†è¿™äº›æƒ…å†µ:**è‡ªåŠ¨è§„èŒƒåŒ–**ã€‚å®ƒåŒ…æ‹¬åœ¨è®­ç»ƒä¹‹å‰å¯¹æ•°æ®ç‰¹å¾è¿›è¡Œå½’ä¸€åŒ–ï¼Œå¹¶ä¸”å°†æœ€å°å’Œæœ€å¤§èŒƒå›´çš„ç‰¹å¾ä½œä¸ºä¸¤ä¸ªé™„åŠ å±æ€§æ·»åŠ åˆ°æ¯ä¸ªæ ·æœ¬ä¸­ã€‚

åœ¨ç”Ÿæˆçš„æ•°æ®ä¸­ï¼Œè¿™ä¸¤ä¸ªå±æ€§é€šå¸¸ä¼šå°†è¦ç´ ç¼©æ”¾å›å®é™…èŒƒå›´ã€‚è¿™åˆ†ä¸‰æ­¥å®Œæˆ:

1.  ä½¿ç”¨å¤šå±‚æ„ŸçŸ¥å™¨(MLP)ç”Ÿæˆå™¨ç”Ÿæˆå±æ€§ã€‚
2.  å°†ç”Ÿæˆçš„å±æ€§ä½œä¸ºè¾“å…¥ï¼Œä½¿ç”¨å¦ä¸€ä¸ª MLP ç”Ÿæˆä¸¤ä¸ªâ€œå‡â€(æœ€å¤§/æœ€å°)å±æ€§ã€‚
3.  å°†ç”Ÿæˆçš„çœŸå‡å±æ€§ä½œä¸ºè¾“å…¥ï¼Œç”Ÿæˆè¦ç´ ã€‚

# åœ¨é“¶è¡Œäº¤æ˜“æ•°æ®ä¸Šè®­ç»ƒäºŒé‡èº«æ¨¡å‹

é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨é“¶è¡Œäº¤æ˜“æ•°æ®é›†ä¸Šè¯„ä¼°äº†äºŒé‡èº«ã€‚ç”¨äºè®­ç»ƒçš„æ•°æ®æ˜¯åˆæˆçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬çŸ¥é“çœŸå®çš„åˆ†å¸ƒï¼Œå¹¶ä¸”å¯ä»¥åœ¨è¿™é‡Œ è®¿é—® [**ã€‚æˆ‘ä»¬çš„ç›®çš„æ˜¯è¯æ˜è¿™ä¸ªæ¨¡å‹èƒ½å¤Ÿå­¦ä¹ æ•°æ®ä¸­çš„æ—¶é—´ä¾èµ–æ€§ã€‚**](https://www.dropbox.com/s/yz6por3n3b1o6rn/data.csv?dl=0)

## å¦‚ä½•å‡†å¤‡èµ„æ–™ï¼Ÿ

![](img/0c0246fdb93550ed445842cf2d023e8a.png)

**å›¾ 2** :ä½œä¸ºä¸€ç»„ä¸åŒé•¿åº¦çš„å±æ€§å’Œç‰¹å¾å¤„ç†çš„æ•°æ®çš„ç¤ºæ„å›¾ã€‚

æˆ‘ä»¬å‡è®¾é¡ºåºæ•°æ®ç”±ä¸€ç»„æœ€å¤§é•¿åº¦ä¸º Lmax çš„åºåˆ—ç»„æˆâ€”åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è€ƒè™‘ Lmax *=* 100ã€‚æ¯ä¸ªåºåˆ—åŒ…å«ä¸€ç»„**å±æ€§** **A** (å›ºå®šæ•°é‡)å’Œ**ç‰¹æ€§** **F** (äº¤æ˜“)ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå”¯ä¸€çš„å±æ€§æ˜¯åˆå§‹é“¶è¡Œ*ä½™é¢*ï¼Œç‰¹å¾æ˜¯:äº¤æ˜“çš„*é‡‘é¢*(æ­£æˆ–è´Ÿ)å’Œå¦å¤–ä¸¤ä¸ªæè¿°äº¤æ˜“çš„ç±»åˆ«:*æ ‡å¿—*å’Œ*æè¿°*ã€‚

è¦è¿è¡Œè¯¥æ¨¡å‹ï¼Œæˆ‘ä»¬éœ€è¦ä¸‰ä¸ª [NumPy æ•°ç»„](https://cs231n.github.io/python-numpy-tutorial/#:~:text=A%20numpy%20array%20is%20a,the%20array%20along%20each%20dimension.):

1.  **æ•°æ® _ ç‰¹å¾**:è®­ç»ƒç‰¹å¾ï¼Œ [NumPy float32 æ•°ç»„æ ¼å¼](https://numpy.org/doc/stable/user/basics.types.html)ã€‚å¤§å°ä¸º[(è®­ç»ƒæ ·æœ¬æ•°)x(æœ€å¤§é•¿åº¦)x(ç‰¹å¾çš„æ€»å°ºå¯¸)]ã€‚åˆ†ç±»ç‰¹å¾é€šè¿‡ä¸€é”®ç¼–ç å­˜å‚¨ã€‚
2.  **data_attribute** :è®­ç»ƒå±æ€§ï¼ŒNumPy float32 æ•°ç»„æ ¼å¼ã€‚å¤§å°ä¸º[(è®­ç»ƒæ ·æœ¬æ•°)x(å±æ€§æ€»ç»´æ•°)]ã€‚
3.  **data_gen_flag** :è¡¨ç¤ºç‰¹æ€§æ¿€æ´»çš„æ ‡å¿—æ•°ç»„ã€‚å¤§å°ä¸º[(è®­ç»ƒæ ·æœ¬æ•°)x(æœ€å¤§é•¿åº¦)]ã€‚

æ­¤å¤–ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªåŒ…å«æ¯ä¸ªå˜é‡çš„æ•°æ®ç±»å‹ã€è§„èŒƒåŒ–å’ŒåŸºæ•°çš„ç±»è¾“å‡ºå¯¹è±¡åˆ—è¡¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒæ˜¯:

```
data_feature_outputs = [
output.Output(type_=OutputType.CONTINUOUS,dim=1,normalization=Normalization.ZERO_ONE,is_gen_flag=False), 
# time intervals between transactions (Dif)
    output.Output(type_=OutputType.DISCRETE,dim=20,is_gen_flag=False), 
# binarized Amount
    output.Output(type_=OutputType.DISCRETE,dim=5,is_gen_flag=False),
# Flagoutput.Output(type_=OutputType.DISCRETE,dim=44,is_gen_flag=False) 
# Description    
]
```

åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯äº‹ä»¶ä¹‹é—´çš„æ—¶é—´é—´éš” *Dif* ï¼Œæ¥ç€æ˜¯ 1-hot ç¼–ç çš„äº¤æ˜“å€¼(é‡‘é¢)ï¼Œæ¥ç€æ˜¯æ ‡å¿—ï¼Œç¬¬å››ä¸ªæ˜¯äº¤æ˜“æè¿°ã€‚æ‰€æœ‰çš„ gen_flags éƒ½è¢«è®¾ç½®ä¸º Falseï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªå†…éƒ¨æ ‡å¿—ï¼Œä»¥åä¼šè¢«æ¨¡å‹æœ¬èº«ä¿®æ”¹ã€‚

è¯¥å±æ€§è¢«ç¼–ç ä¸ºä¸€ä¸ªè¿ç»­å˜é‡ï¼Œå½’ä¸€åŒ–å€¼åœ¨-1 å’Œ 1 ä¹‹é—´ï¼Œä»¥è¯´æ˜è´Ÿä½™é¢:

```
data_attribute_outputs = [output.Output(type_=OutputType.CONTINUOUS,dim=1,normalization=Normalization.MINUSONE_ONE,is_gen_flag=False)]
```

æ­¤æ¨¡æ‹Ÿä¸­ä½¿ç”¨çš„å”¯ä¸€å±æ€§æ˜¯åˆå§‹å¹³è¡¡ã€‚æ¯ä¸€æ­¥çš„ä½™é¢åªéœ€æ·»åŠ ç›¸åº”çš„äº¤æ˜“é‡‘é¢å³å¯æ›´æ–°ã€‚

æˆ‘ä»¬ä½¿ç”¨[æ¨¡ç³Šå¤„ç†å™¨](http://hazy.com)æ¥é¢„å¤„ç†æ¯ä¸ªåºåˆ—ï¼Œå¹¶ä»¥æ­£ç¡®çš„æ ¼å¼é‡å¡‘å®ƒã€‚

```
n_bins = 20
processor_dict = {
            "by_type": {
                  "float": {
                    "processor": "FloatToOneHot", #FloatToBin"
                    "kwargs": {"n_bins": n_bins}
                  },
                  "int": {
                    "processor": "IntToFloat",
                    "kwargs": {"n_bins": n_bins}
                  },
                  "category": {
                    "processor": "CatToOneHot",

        },
                 "datetime": {
                    "processor": "DtToFloat",
                  }
                }
        }from hazy_trainer.processing import HazyProcessor
processor = HazyProcessor(processor_dict)
```

ç°åœ¨æˆ‘ä»¬å°†è¯»å–æ•°æ®ï¼Œå¹¶ä½¿ç”¨å‡½æ•° format_data å¯¹å…¶è¿›è¡Œå¤„ç†ã€‚è¾…åŠ©å˜é‡ categories_n å’Œ categories_cum åˆ†åˆ«å­˜å‚¨å˜é‡çš„åŸºæ•°å’ŒåŸºæ•°çš„ç´¯ç§¯å’Œã€‚

```
data=pd.read_csv('data.csv',nrows=100000)    # read the datacategorical = ['Amount','Flag','Description'] 
continuous =['Balance','Dif']
cols = categorical + continuous
processor = HazyProcessor(processor_dict) #call Hazy processor
processor.setup_df(data[cols]) # setup the processor
categories_n = [] # Number of categories in each categorical variable
for cat in categorical:
    categories_n.append(len(processor.column_to_columns[cat]['process']))

categories_cum = list(np.cumsum(categories_n)) # Cumulative sum of number of categorical variables
categories_cum = [x for x in categories_cum] # We take one out because they will be indexes
categories_cum = [0] + categories_cum

def format_data(data, cols, nsequences=1000, Lmax=100, cardinality=70):
''' cols is a list of columns to be processednsequences  number of sequences to use for training
   Lmax is the maximum sequence length
   Cardinality shape of sequences'''
   idd=list(accenture.Account_id.unique()) # unique account ids
   data.Date = pd.to_datetime(data.Date) # format date
  # dummy to normalize the processors
 data['Dif']=np.random.randint(0,30*24*3600,size=accenture.shape[0])    data_all = np.zeros((nsequences,Lmax,Cardinality))
   data_attribut=np.zeros((nsequences))
   data_gen_flag=np.zeros((nsequences,Lmax))
   real_df = pd.DataFrame()
   for i,ids in enumerate(idd[:nsequences]):
      user = data[data.Account_id==ids]
      user=user.sort_values(by='Date')
      user['Dif']=user.Date.diff(1).iloc[1:] 
      user['Dif']=user['Dif'].dt.seconds 
      user = user[cols]
      real_df=pd.concat([real_df,user])
      processed_df = processor.process_df(user)
      Data_attribut[i] = processed_df['Balance'].values[0]
      processed_array = np.asarray(processed_df.iloc[:,1:)
      data_gen_flag[i,:len(user)]=1
      data_all[i,:len(user),:]=processed_arrayreturn data_all, data_attribut, data_gen_flag
```

**æ•°æ®**

[æ•°æ®](https://www.dropbox.com/s/yz6por3n3b1o6rn/data.csv?dl=0)åŒ…å«å¤§çº¦ 1000 ä¸‡ç¬”é“¶è¡Œäº¤æ˜“ï¼Œæˆ‘ä»¬å°†ä»ä¸­æŠ½å– 100ï¼Œ000 ç¬”äº¤æ˜“ä½œä¸ºæ ·æœ¬ï¼Œå…¶ä¸­åŒ…å« 5ï¼Œ000 ä¸ªä¸åŒçš„è´¦æˆ·ï¼Œæ¯ä¸ªè´¦æˆ·å¹³å‡æœ‰ 20 ç¬”äº¤æ˜“ã€‚æˆ‘ä»¬è€ƒè™‘ä»¥ä¸‹é¢†åŸŸ:

*   äº¤æ˜“æ—¥æœŸ
*   äº¤æ˜“é‡‘é¢
*   ä¿æŒå¹³è¡¡
*   äº¤æ˜“æ ‡å¿—(5 çº§)
*   æè¿°(44 çº§)

ä¸‹é¢æ˜¯æ ‡é¢˜æ‰€ç”¨çš„æ•°æ®:

![](img/b7ee7151ea16d463c9f7ab494ea166af.png)

è¡¨ 1:é“¶è¡Œäº¤æ˜“æ•°æ®ç¤ºä¾‹

å¦‚å‰æ‰€è¿°ï¼Œæ—¶é—´ä¿¡æ¯å°†è¢«å»ºæ¨¡ä¸ºä¸¤ä¸ªè¿ç»­äº‹åŠ¡ä¹‹é—´çš„æ—¶é—´å·®(ä»¥ç§’ä¸ºå•ä½)ã€‚

![](img/8dfa63f8763aee02537707a33b6c04e4.png)

**å›¾ 3** :ä¸åŒ*æè¿°*çš„äº¤æ˜“æŸ±çŠ¶å›¾ï¼Œåˆ†ç¦»ä¸ºæ”¶å…¥å’Œæµå‡ºã€‚

![](img/4dd539b2d27cb4cff355a8355a9207e1.png)

**å›¾ 4:** ä¸åŒæ—¶é—´åˆ†å¸ƒçš„äº¤æ˜“çƒ­å›¾ã€‚

![](img/3cb042e63baf5d1ede01b1c3d37f7835.png)

**å›¾äº”**:äº¤æ˜“åˆ†å¸ƒ*é‡‘é¢*ã€‚

![](img/76435d291f34f2a44c822b9d92186abd.png)

**å›¾ 6** :åˆå§‹*ä½™é¢*åˆ†é…ã€‚è¯·æ³¨æ„ï¼Œç”±äºé€æ”¯ï¼Œä¸€äº›å¸æˆ·çš„åˆå§‹ä½™é¢ä¸ºè´Ÿã€‚

![](img/1ac1945833399a6abd7ac48f2737b9dc.png)

**å›¾ 7** :ä¸€ä¸ªæœˆçš„äº¤æ˜“ç¬”æ•°â€”â€”æ”¶å…¥å’Œæµå‡ºã€‚è¯·æ³¨æ„ï¼Œæ”¶å…¥æœ‰éå¸¸æ˜æ˜¾çš„å³°å€¼ã€‚åˆæˆæ•°æ®å¿…é¡»æ•æ‰è¿™äº›å³°å€¼

# è¿è¡Œä»£ç 

æˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹å‚æ•°ä»…è¿è¡Œäº† 100 ä¸ªæ—¶æœŸçš„ä»£ç :

```
import sys
import os
sys.path.append("..")
import matplotlib.pyplot as plt

from gan import output
sys.modules["output"] = output

import numpy as np
import pickle
import pandas as pd

from gan.doppelganger import DoppelGANger
from gan.load_data import load_data
from gan.network import DoppelGANgerGenerator, Discriminator, AttrDiscriminator
from gan.output import Output, OutputType, Normalization
import tensorflow as tf
from gan.network import DoppelGANgerGenerator, Discriminator, \
    RNNInitialStateType, AttrDiscriminator
from gan.util import add_gen_flag, normalize_per_sample, \
    renormalize_per_sample

sample_len = 10
epoch = 100
batch_size = 20
d_rounds = 2
g_rounds = 1
d_gp_coe = 10.0
attr_d_gp_coe = 10.0
g_attr_d_coe = 1.0
```

è¯·æ³¨æ„ï¼Œç”Ÿæˆå™¨ç”±ä¸€ç³»åˆ—å±‚ç»„æˆï¼Œå¯¹äºåˆ†ç±»è¾“å…¥ä½¿ç”¨ *softmax* æ¿€æ´»åŠŸèƒ½ï¼Œå¯¹äºè¿ç»­å˜é‡ä½¿ç”¨*çº¿æ€§*æ¿€æ´»åŠŸèƒ½ã€‚å‘ç”Ÿå™¨å’Œé‰´åˆ«å™¨éƒ½ä½¿ç”¨å…·æœ‰æŒ‡å®šå­¦ä¹ é€Ÿç‡å’ŒåŠ¨é‡çš„ [Adam ç®—æ³•](https://arxiv.org/abs/1412.6980)è¿›è¡Œä¼˜åŒ–ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬å‡†å¤‡å¥½æ•°æ®æ¥è¾“å…¥ç½‘ç»œã€‚real_attribute_mask æ˜¯ä¸€ä¸ª True/False åˆ—è¡¨ï¼Œå…¶é•¿åº¦ä¸å±æ€§çš„æ•°é‡ç›¸åŒã€‚å¦‚æœå±æ€§ä¸º(max-min)/2 æˆ–(max+min)/2ï¼Œåˆ™ä¸º False å¦åˆ™ä¸ºçœŸã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å®ä¾‹åŒ–ç”Ÿæˆå™¨å’Œé‰´åˆ«å™¨:

```
# create the necessary input arrays
data_all, data_attribut, data_gen_flag = format_data(data,cols)
# normalise data
(data_feature, data_attribute, data_attribute_outputs,
 real_attribute_mask) = normalize_per_sample(
        data_all, data_attribut, data_feature_outputs,
        data_attribute_outputs)
# add generation flag to features
data_feature, data_feature_outputs = add_gen_flag(
    data_feature, data_gen_flag, data_feature_outputs, sample_len)generator = DoppelGANgerGenerator(
    feed_back=False,
    noise=True,
    feature_outputs=data_feature_outputs,
    attribute_outputs=data_attribute_outputs,
    real_attribute_mask=real_attribute_mask,
    sample_len=sample_len,
    feature_num_units=100,
    feature_num_layers=2)

discriminator = Discriminator()
attr_discriminator = AttrDiscriminator()
```

æˆ‘ä»¬ä½¿ç”¨ç”±ä¸¤å±‚ 100 ä¸ªç¥ç»å…ƒç»„æˆçš„ç¥ç»ç½‘ç»œä½œä¸ºç”Ÿæˆå™¨å’Œé‰´åˆ«å™¨ã€‚æ‰€æœ‰æ•°æ®éƒ½è¿›è¡Œäº†æ ‡å‡†åŒ–æˆ– 1-hot ç¼–ç ã€‚ç„¶åï¼Œæˆ‘ä»¬ç”¨ä»¥ä¸‹å‚æ•°è®­ç»ƒæ¨¡å‹:

```
checkpoint_dir = "./results/checkpoint"
sample_path = "./results/time"
epoch = 100
batch_size = 50
g_lr = 0.0001
d_lr = 0.0001
vis_freq = 50
vis_num_sample = 5
d_rounds = 3
g_rounds = 1
d_gp_coe = 10.0
attr_d_gp_coe = 10.0
g_attr_d_coe = 1.0
extra_checkpoint_freq = 30
num_packing = 1
```

# å…³äºåŸ¹è®­çš„ä¸€äº›æ³¨æ„äº‹é¡¹

å¦‚æœæ•°æ®å¾ˆå¤§ï¼Œä½ åº”è¯¥ä½¿ç”¨æ›´å¤§æ•°é‡çš„å†å…ƒâ€”â€”ä½œè€…å»ºè®® 400 ä¸ªï¼Œä½†åœ¨æˆ‘ä»¬çš„å®éªŒä¸­ï¼Œæˆ‘ä»¬å‘ç°æˆ‘ä»¬å¯ä»¥é«˜è¾¾ 1000 ä¸ªè€Œç½‘ç»œä¸ä¼šé€€åŒ–åˆ°æ¨¡å¼å´©æºƒã€‚æ­¤å¤–ï¼Œè€ƒè™‘åˆ°å†å…ƒçš„æ•°é‡ä¸æ‰¹æ¬¡å¤§å°æœ‰å…³ï¼Œè¾ƒå°çš„æ‰¹æ¬¡éœ€è¦æ›´å¤šçš„å†å…ƒå’Œè¾ƒä½çš„å­¦ä¹ ç‡ã€‚

å¯¹äºåˆšæ¥è§¦ç¥ç»ç½‘ç»œçš„äººæ¥è¯´ï¼Œæ‰¹é‡ã€éšæœºå’Œå°æ‰¹é‡æ¢¯åº¦ä¸‹é™æ˜¯æœºå™¨å­¦ä¹ ç®—æ³•çš„ä¸‰ç§ä¸»è¦å½¢å¼ã€‚è®­ç»ƒç¥ç»ç½‘ç»œæ—¶ï¼Œæ‰¹é‡å¤§å°æ§åˆ¶è¯¯å·®æ¢¯åº¦ä¼°è®¡çš„å‡†ç¡®æ€§ã€‚åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­ï¼Œç”¨æˆ·åº”äº†è§£æ‰¹æ¬¡å¤§å°ã€é€Ÿåº¦å’Œç¨³å®šæ€§ä¹‹é—´çš„æƒè¡¡ã€‚æ›´å¤§çš„æ‰¹é‡éœ€è¦æ›´å¤§çš„å­¦ä¹ é€Ÿç‡ï¼Œç½‘ç»œå°†å­¦ä¹ å¾—æ›´å¿«ï¼Œä½†ä¹Ÿå¯èƒ½ä¸å¤ªç¨³å®šï¼Œç”±äº[æ¨¡å¼å´©æºƒé—®é¢˜](https://medium.com/@jonathan_hui/gan-why-it-is-so-hard-to-train-generative-advisory-networks-819a86b3750b#:~:text=Mode%20collapse%20is%20one%20of%20the%20hardest%20problems%20to%20solve%20in%20GAN.&text=The%20mode%20collapses%20to%20a,to%20detect%20this%20single%20mode.)ï¼Œè¿™å¯¹äº GANs æ¥è¯´å°¤å…¶æˆé—®é¢˜ã€‚

æ ¹æ®ç»éªŒï¼Œç”Ÿæˆå™¨å’Œé‰´åˆ«å™¨çš„å­¦ä¹ ç‡åº”è¯¥å¾ˆå°(åœ¨ 10â€“3 åˆ° 10â€“5 çš„èŒƒå›´å†…)å¹¶ä¸”å½¼æ­¤ç›¸ä¼¼ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ 10â€“4ï¼Œè€Œä¸æ˜¯é»˜è®¤çš„ 10â€“3ã€‚

å¦ä¸€ä¸ªé‡è¦å‚æ•°æ˜¯å‘ç”Ÿå™¨å’Œé‰´åˆ«å™¨ä¸Šçš„å›åˆæ•°ã€‚Wasserstein GAN (WGAN)éœ€è¦ä¸¤ä¸ªç»„ä»¶æ‰èƒ½æ­£å¸¸å·¥ä½œ:æ¢¯åº¦é™å¹…å’Œæ¯”å‘ç”Ÿå™¨æ›´é«˜çš„é‰´é¢‘å™¨è½®æ•°(d_round)ã€‚é€šå¸¸ï¼Œå¯¹äºå‘ç”Ÿå™¨çš„æ¯ä¸€è½®ï¼Œé‰´åˆ«å™¨çš„è½®æ•°åœ¨ 3 åˆ° 5 ä¹‹é—´ã€‚è¿™é‡Œæˆ‘ä»¬ç”¨ d_round=3ï¼Œg_round=1ã€‚

ä¸ºäº†åŠ é€Ÿè®­ç»ƒï¼Œæˆ‘ä»¬å¯¹ç”Ÿæˆå™¨ä½¿ç”¨äº†ä¸€ä¸ª[å¾ªç¯å­¦ä¹ ç‡](https://arxiv.org/pdf/1506.01186.pdf)ï¼Œå¯¹é‰´åˆ«å™¨ä½¿ç”¨äº†ä¸€ä¸ªå›ºå®šçš„å­¦ä¹ ç‡ã€‚

ç›®å½• sample_path å­˜å‚¨äº†åœ¨ä¸åŒæ£€æŸ¥ç‚¹æ”¶é›†çš„ä¸€ç»„æ ·æœ¬ï¼Œè¿™å¯¹éªŒè¯éå¸¸æœ‰ç”¨ã€‚æŸå¤±å‡½æ•°çš„å¯è§†åŒ–å¯ä»¥ä½¿ç”¨ TensorBoard åœ¨æ‚¨æä¾›çš„æ£€æŸ¥ç‚¹ç›®å½•ä¸Šå®Œæˆã€‚æ‚¨å¯ä»¥ä½¿ç”¨å‚æ•° extra_checkpoint_freq æ§åˆ¶æ£€æŸ¥ç‚¹çš„é¢‘ç‡ã€‚

è¯·æ³¨æ„ï¼Œè¿™å¯èƒ½ä¼šå ç”¨å¤§é‡ç£ç›˜ç©ºé—´ã€‚åœ¨ MacBook Pro ä¸Šæ¨¡æ‹Ÿä¸åˆ°ååˆ†é’Ÿã€‚

```
run_config = tf.ConfigProto()
tf.reset_default_graph() # if you are using spyder 
with tf.Session(config=run_config) as sess:
    gan = DoppelGANger(
        sess=sess, 
        checkpoint_dir=checkpoint_dir,
        sample_dir=sample_dir,
        time_path=sample_path,
        epoch=epoch,
        batch_size=batch_size,
        data_feature=data_feature,
        data_attribute=data_attribute,
        real_attribute_mask=real_attribute_mask,
        data_gen_flag=data_gen_flag,
        sample_len=sample_len,
        data_feature_outputs=data_feature_outputs,
        data_attribute_outputs=data_attribute_outputs,
        vis_freq=vis_freq,
        vis_num_sample=vis_num_sample,
        generator=generator,
        discriminator=discriminator,
        attr_discriminator=attr_discriminator,
        d_gp_coe=d_gp_coe,
        attr_d_gp_coe=attr_d_gp_coe,
        g_attr_d_coe=g_attr_d_coe,
        d_rounds=d_rounds,
        g_rounds=g_rounds,g_lr=g_lr,d_lr=d_lr,
        num_packing=num_packing,
        extra_checkpoint_freq=extra_checkpoint_freq)
    gan.build()
    gan.train()
```

# åˆæˆæ•°æ®ç”Ÿæˆ

æ¨¡å‹å®šå‹åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ç”Ÿæˆå™¨ä»å™ªå£°ä¸­åˆ›å»ºåˆæˆæ•°æ®ã€‚æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥åšåˆ°:

1.  çº¯å™ªå£°çš„æ— æ¡ä»¶ç”Ÿæˆ
2.  å±æ€§çš„æ¡ä»¶ç”Ÿæˆ

åœ¨ç¬¬ä¸€ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç”Ÿæˆå±æ€§å’Œç‰¹å¾ã€‚åœ¨ç¬¬äºŒä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬æ˜ç¡®æŒ‡å®šäº†æˆ‘ä»¬å¸Œæœ›ä»¥å“ªäº›å±æ€§ä½œä¸ºè¦ç´ ç”Ÿæˆçš„æ¡ä»¶ï¼Œä»¥ä¾¿åªç”Ÿæˆè¦ç´ ã€‚

ä¸‹é¢æ˜¯ä»ä¸­ç”Ÿæˆæ ·æœ¬çš„ä»£ç :

```
run_config = tf.ConfigProto()
total_generate_num_sample = 1000
with tf.Session(config=run_config) as sess:
    gan = DoppelGANger(
        sess=sess, 
        checkpoint_dir=checkpoint_dir,
        sample_dir=sample_dir,
        time_path=time_path,
        epoch=epoch,
        batch_size=batch_size,
        data_feature=data_feature,
        data_attribute=data_attribute,
        real_attribute_mask=real_attribute_mask,
        data_gen_flag=data_gen_flag,
        sample_len=sample_len,
        data_feature_outputs=data_feature_outputs,
        data_attribute_outputs=data_attribute_outputs,
        vis_freq=vis_freq,
        vis_num_sample=vis_num_sample,
        generator=generator,
        discriminator=discriminator,
        attr_discriminator=attr_discriminator,
        d_gp_coe=d_gp_coe,
        attr_d_gp_coe=attr_d_gp_coe,
        g_attr_d_coe=g_attr_d_coe,
        d_rounds=d_rounds,
        g_rounds=g_rounds,
        num_packing=num_packing,
        extra_checkpoint_freq=extra_checkpoint_freq)

# build the network 
    gan.build()

    length = int(data_feature.shape[1] / sample_len)
    real_attribute_input_noise = gan.gen_attribute_input_noise(
                total_generate_num_sample)
    addi_attribute_input_noise = gan.gen_attribute_input_noise(
                total_generate_num_sample)
    feature_input_noise = gan.gen_feature_input_noise(
                total_generate_num_sample, length)
    input_data = gan.gen_feature_input_data_free(
                total_generate_num_sample)# load the weights / change the path accordingly
    gan.load(checkpoint_dir+'/epoch_id-100')

# generate features, attributes and lengths
    features, attributes, gen_flags, lengths = gan.sample_from(
        real_attribute_input_noise, addi_attribute_input_noise,
        feature_input_noise, input_data, given_attribute=None,
        return_gen_flag_feature=False)
#denormalise accordingly
    features, attributes = renormalize_per_sample(
        features, attributes, data_feature_outputs,
        data_attribute_outputs, gen_flags,
        num_real_attribute=1)
```

æˆ‘ä»¬éœ€è¦ä¸€äº›é¢å¤–çš„æ­¥éª¤æ¥å°†ç”Ÿæˆçš„æ ·æœ¬å¤„ç†æˆåºåˆ—æ ¼å¼ï¼Œå¹¶è¿”å› 1-hot ç¼–ç æ ¼å¼çš„å‘é‡ã€‚

```
nfloat = len(continuous)
synth=np.zeros(features.shape[-1])
for i in range(features.shape[0]):
    v = np.concatenate([np.zeros_like(attributes[i]), np.zeros_like(features[i])],axis=-1)
    v[attributes[i].shape] = attributes[i]
    V[attributes[i].shape[0]:attributes[i].shape[0]+1] = feature[i,:,0]

    for j, c in enumerate(categories_cum[:-1]):
        ac = features[:,nfloat+categories_cum[j]-1:          nfloat+categories_cum[j+1]-1]
        a_hot = np.zeros((ac.shape[0], categories_n[j]))    
        a_hot[np.arange(ac.shape[0]),ac.argmax(axis=1)] = 1
        v[:,nfloat+categories_cum[j]:nfloat+categories_cum[j+1]]=a_hot
    v=np.concatenate([np.array([i]*len(ac))[np.newaxis].T,v],axis=1)

    synth = np.vstack([synth,v])

df = pd.DataFrame(synth[1:,1:],columns=processed_df.columns)
formated_df = processor.format_df(df)
formated_df['account_id']=synth[:,0] # add account_id
```

ä¸‹é¢æˆ‘ä»¬ç»™å‡ºäº†åˆæˆ(ç”Ÿæˆ)æ•°æ®å’ŒçœŸå®æ•°æ®ä¹‹é—´çš„ä¸€äº›æ¯”è¾ƒã€‚æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°ï¼Œæ€»çš„æ¥è¯´ï¼Œç”Ÿæˆçš„æ•°æ®åˆ†å¸ƒä¸çœŸå®åˆ†å¸ƒåŒ¹é…å¾—ç›¸å½“å¥½â€”â€”å›¾ 8 å’Œå›¾ 9ã€‚

![](img/0397dd494613a2530812c327608c7fe9.png)![](img/504372081ba0949bd8e7ceeb4b836868.png)![](img/9a466f60cee8f29a4b863490eea23aaa.png)

**å›¾ 8** :ç”Ÿæˆæ•°æ®ä¸å®é™…æ•°æ®çš„åºåˆ—é•¿åº¦ç›´æ–¹å›¾(ä¸Šå›¾)äº‹åŠ¡ä¹‹é—´çš„æ—¶é—´é—´éš”ç›´æ–¹å›¾(ä¸­å›¾)å’Œæ ‡å¿—ç›´æ–¹å›¾(ä¸‹å›¾)ã€‚

å”¯ä¸€çš„ä¾‹å¤–æ˜¯å˜é‡*çš„åˆ†å¸ƒé‡*ï¼Œå¦‚å›¾ 9 æ‰€ç¤ºã€‚è¿™æ˜¯ç”±äºè¯¥å˜é‡å…·æœ‰éå¹³æ»‘åˆ†å¸ƒçš„äº‹å®ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å°†å…¶ç¦»æ•£åŒ–ä¸º 20 ä¸ªçº§åˆ«ï¼Œä»è€Œå¾—åˆ°æ›´å¥½çš„åŒ¹é…ã€‚

![](img/d082664b58e9ffc5416f11ef9409878f.png)![](img/3af55fca1820fbcbb8dc0831eb8dae44.png)

**å›¾ 9** :ä½¿ç”¨è¿ç»­ç¼–ç (ä¸Š)å’ŒäºŒè¿›åˆ¶ç‹¬çƒ­ç¼–ç (ä¸‹)ç”Ÿæˆçš„å®é™…æ•°é‡ä¸ã€‚

ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨æ¨¡ç³Šåº¦é‡æ¥è®¡ç®—**ç›¸ä¼¼æ€§å¾—åˆ†ã€‚**è¯¥åˆ†æ•°æ˜¯ä¸‰ä¸ªåˆ†æ•°çš„å¹³å‡å€¼:ç›´æ–¹å›¾å’Œ histogram2D ç›¸ä¼¼æ€§(çœŸå®å’Œåˆæˆæ•°æ®ç›´æ–¹å›¾é‡å çš„ç¨‹åº¦)ä»¥åŠåˆ—ä¹‹é—´çš„äº’ä¿¡æ¯ã€‚è¯¥åˆ†æ•°ç¡®å®šäº†åˆæˆæ•°æ®ä¿æŒåˆ—é—´ç›¸å…³æ€§çš„ç¨‹åº¦ã€‚

å½“å°†*æ•°é‡*è§†ä¸ºè¿ç»­å˜é‡æ—¶ï¼Œæˆ‘ä»¬å¾—åˆ°çš„ç›¸ä¼¼æ€§å¾—åˆ†ä¸º **0.57** ï¼Œå½“æˆ‘ä»¬å°†å…¶äºŒè¿›åˆ¶åŒ–ä¸º 20 ä¸ªç®±æ—¶ï¼Œæˆ‘ä»¬å¾—åˆ°çš„ç›¸ä¼¼æ€§å¾—åˆ†ä¸º **0.63** ã€‚ç›¸ä¼¼æ€§å¾—åˆ†å¦‚ä¸‹è·å¾—:

```
from hazy_trainer.evaluation.similarity import Similarity
sim = Similarity(metrics=['hist','hist2d','mi'])
score = sim.score(real_df[cols], formated_df[cols])
print(score['similarity']['score'])
```

ç„¶è€Œï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ï¼Œè¿™ä¸ªæ•°å­—å¹¶æ²¡æœ‰çœŸæ­£è¯´æ˜å…¨éƒ¨æƒ…å†µï¼Œå› ä¸ºå®ƒæ²¡æœ‰æ˜ç¡®åœ°æµ‹é‡åˆæˆæ•°æ®åºåˆ—çš„æ—¶é—´ä¸€è‡´æ€§â€”â€”å®ƒç‹¬ç«‹åœ°å¤„ç†æ¯ä¸€è¡Œã€‚

![](img/15353070045c6b6403454d5b38c33c94.png)

**å›¾ 10** :ä¸€æ®µæ—¶é—´å†…æ¨¡å‹ç”Ÿæˆçš„äº¤æ˜“é‡(èµ„é‡‘è¿›å‡º)ã€‚

ä¸ºæ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªé¢å¤–çš„å…³é”®æŒ‡æ ‡:**è‡ªç›¸å…³**ï¼Œå®ƒè¡¡é‡åœ¨æ—¶é—´ *t* å‘ç”Ÿçš„äº‹ä»¶*ä¸åœ¨*æ—¶é—´*tâ€”âˆˆ*å‘ç”Ÿçš„äº‹ä»¶*ä¹‹é—´çš„å…³ç³»ï¼Œå…¶ä¸­âˆˆæ˜¯æ—¶é—´å»¶è¿Ÿã€‚ä¸ºäº†è¡¡é‡è¿™ç§å…³ç³»ï¼Œæˆ‘ä»¬ç”¨ä»¥ä¸‹æ–¹å¼è¿›è¡Œæ¯”è¾ƒ:*

AC = I = 1T(Areali-Asynthetici)2/I = 1T(Areali)2

ä¸‹é¢æ˜¯çœŸå®æ•°æ®å’Œåˆæˆæ•°æ®çš„æ€»æ”¯å‡º(æŒ‰å¤©ç´¯è®¡)çš„è‡ªç›¸å…³å›¾ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸¤è€…æœ‰éå¸¸ç›¸ä¼¼çš„æ¨¡å¼ã€‚

è¿™åªé€‚ç”¨äºæ•°å­—æ•°æ®ã€‚å¯¹äºåˆ†ç±»ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨äº’ä¿¡æ¯ã€‚å¯¹äºæˆ‘ä»¬çš„æ•°æ®ï¼Œæˆ‘ä»¬å¾—åˆ° AC = 0.71

![](img/194769b38e6217b4c2ebaf49f596b8b6.png)

**å›¾ 11** :é“¶è¡Œäº¤æ˜“æ•°æ®é›†çœŸå®æ•°æ®å’Œåˆæˆæ•°æ®çš„è‡ªç›¸å…³ã€‚

# äº¤é€šæ•°æ®é›†

ä¸ºäº†è¯æ˜é¡ºåºæ•°æ®ç”Ÿæˆå™¨çš„èƒ½åŠ›ï¼Œæˆ‘ä»¬åœ¨å¦ä¸€ä¸ªæ›´å…·æŒ‘æˆ˜æ€§çš„æ•°æ®é›†ä¸Šæµ‹è¯•äº†å®ƒ:åœ°é“å·é™…äº¤é€šé‡æ•°æ®é›†ã€‚è¿™æ˜¯ä¸€ä¸ªæ•°æ®é›†ï¼ŒåŒ…å« 2012 å¹´è‡³ 2018 å¹´çš„æ¯å°æ—¶äº¤é€šæ•°æ®ã€‚æ­£å¦‚æˆ‘ä»¬åœ¨æ¥ä¸‹æ¥çš„å›¾ä¸­çœ‹åˆ°çš„ï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œæ•°æ®ç›¸å¯¹ä¸€è‡´ï¼Œå…·æœ‰ä¸€äº›æ¯æ—¥å’Œæ¯å‘¨æ¨¡å¼ä»¥åŠè¾ƒå¤§çš„æ¯å°æ—¶å¯å˜æ€§ã€‚æºè‡ªå‘ç”Ÿå™¨çš„åˆæˆæ•°æ®å¿…é¡»å†ç°æ‰€æœ‰è¿™äº›è¶‹åŠ¿ã€‚

![](img/3e0388e1b41d7ed4104ee0b2c091584e.png)

**å›¾ 12** :è½¦æµé‡ç›´æ–¹å›¾(æ¯å°æ—¶è½¦æµé‡)ã€‚

![](img/f8dac80576f1747066381174e9d22357.png)![](img/99e982dbd5b74e760b47dcb043909629.png)![](img/8761fea7530b63ec72c9ecfd049b0e41.png)

æ—¥å¸¸æ¨¡å¼å¯èƒ½ç›¸å½“å¤æ‚ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒåŒ…å«ç¬¬ä¸€ä¸ªæœˆ(2012 å¹´ 10 æœˆ)çš„æµé‡:

![](img/fd056e93addea24d3f7fdab5d398ff31.png)

**å›¾ 14**:2012 å¹´ 10 æœˆçš„æ¯å°æ—¶äº¤é€šæ¨¡å¼ã€‚æ¯ä¸€æ»´ä»£è¡¨ä¸€å¤©ã€‚åœ¨ä½æµé‡æ¨¡å¼ä¸‹ï¼Œå‘¨æœ«æ˜¯å¯è§çš„ã€‚

ä¸ºäº†ç”Ÿæˆé«˜è´¨é‡çš„åˆæˆæ•°æ®ï¼Œç½‘ç»œå¿…é¡»é¢„æµ‹æ­£ç¡®çš„æ¯æ—¥ã€æ¯å‘¨ã€æ¯æœˆç”šè‡³æ¯å¹´çš„æ¨¡å¼ï¼Œå› æ­¤é•¿æœŸç›¸å…³æ€§éå¸¸é‡è¦ã€‚

![](img/e8f968341bf9dc76d0acbc302fa7a5ff.png)![](img/94e8eee4cba57b1058bdc6adcf29b385.png)![](img/7cfd38dc55979b66f47b7c934f6046df.png)![](img/6ad95146fda41a384cdc12981b2941a0.png)

**å›¾ 15** :æ•°æ®çš„æ›´å¤šåˆ†å¸ƒã€‚

åœ¨è‡ªç›¸å…³æ–¹é¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¹³æ»‘çš„æ¯æ—¥ç›¸å…³æ€§ï¼Œè¿™æ˜¯æœ‰æ„ä¹‰çš„ï¼Œå› ä¸ºå¤§å¤šæ•°æµé‡å…·æœ‰å¯¹ç§°è¡Œä¸ºã€‚æ—©ä¸Šçš„é«˜å¼ºåº¦ä¸æ™šä¸Šçš„é«˜å¼ºåº¦ç›¸å…³ã€‚

![](img/69e5647c2f23d276f4d85a49bcfbe97a.png)

**å›¾ 15** :çœŸå®äº¤é€šæ•°æ®ä¸ç”Ÿæˆäº¤é€šæ•°æ®çš„è‡ªç›¸å…³ã€‚å¯¹äºè¾ƒé•¿çš„è…¿ï¼Œåˆæˆæ•°æ®çš„è‡ªç›¸å…³å¼€å§‹åç¦»ä»çœŸå®æ•°æ®è·å¾—çš„è‡ªç›¸å…³

# è¿è¡Œæ¨¡å‹

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåºåˆ—é•¿åº¦æ˜¯å›ºå®šçš„ã€‚ä¸ºäº†å‡†å¤‡æ•°æ®ï¼Œæˆ‘ä»¬ä½¿ç”¨æ¯æœˆå’Œæ¯å‘¨æ•°æ®çš„æ»‘åŠ¨çª—å£ç”Ÿæˆäº† 50ï¼Œ000 ä¸ªåºåˆ—ã€‚è¿™ä¸ªæ•°æ®é›†æ¯”å‰ä¸€ä¸ªæ•°æ®é›†å¤§å¾—å¤šï¼Œæˆ‘ä»¬å¸Œæœ›æ¨¡å‹èƒ½å¤Ÿå¹³ç¨³è¿è¡Œï¼Œä¸ä¼šå‡ºç°æ¨¡å¼å´©æºƒã€‚

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¹Ÿæœ‰æ›´å¤šçš„å±æ€§ã€‚ä¸€äº›ï¼Œåƒ*æ˜ŸæœŸå‡ *å’Œ*æœˆä»½*ï¼Œæ˜¯ä»æ•°æ®ä¸­æ„å»ºçš„:

*   æ¸©åº¦
*   Rain_1h
*   Snow_1h
*   äº‘ _ å…¨éƒ¨
*   å¤©æ°” _ æè¿°
*   å¤©æ°” _ ä¸»è¦
*   å‡æœŸ
*   æ˜ŸæœŸå‡ 
*   æœˆ

ä½œä¸ºç‰¹è‰²ï¼Œæˆ‘ä»¬åªæœ‰æ¯å°æ—¶çš„*æµé‡*ã€‚å› ä¸ºæˆ‘ä»¬å¸Œæœ›ä»¥æœ€é«˜çš„ç²’åº¦æ•è·è¿™ä¸ªå˜é‡ï¼Œæ‰€ä»¥æ‰€æœ‰çš„æ•°å€¼éƒ½è¢«ç¦»æ•£åˆ° 20 ä¸ªç®±ä¸­ï¼Œé™¤äº†äº¤é€šé‡è¢«ç¦»æ•£åˆ° 50 ä¸ªç®±ä¸­ã€‚è¯¥æ¨¡å‹è¿è¡Œäº† 200 ä¸ªæ—¶æœŸï¼Œæ‰¹æ¬¡å¤§å°ä¸º 20ï¼Œå­¦ä¹ é€Ÿç‡ä¸ä¹‹å‰ç›¸åŒã€‚

# ç»“æœ

å›¾ 17 åŒ…å«ä¸€ä¸ªçœŸå®çš„ç”Ÿæˆæ ·æœ¬ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¾ªç¯æ¨¡å¼ä¿æŒå¾—å¾ˆå¥½ï¼Œæ•°æ®çœ‹èµ·æ¥å¾ˆçœŸå®ã€‚

![](img/002463812cf1831f5e07e3f102a9cac3.png)

**å›¾ 17**:500 å°æ—¶å†…çš„çœŸå®(ä¸Š)å’Œç”Ÿæˆ(ä¸‹)åºåˆ—ã€‚è¿™ä¸ªæ¨¡å‹æ˜¯æ— æ¡ä»¶è¿è¡Œçš„ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåˆæˆæ•°æ®å¾ˆå¥½åœ°æ•æ‰äº†æ¯æ—¥å’Œæ¯å‘¨çš„æ¨¡å¼ã€‚

ä¸ºäº†æµ‹è¯•ç”Ÿæˆæ•°æ®çš„è´¨é‡ï¼Œæˆ‘ä»¬æä¾›äº†ä¸€äº›æŒ‡æ ‡ï¼Œè§è¡¨ 2:

*   **ç›¸ä¼¼åº¦** â€”é€šè¿‡ç›´æ–¹å›¾çš„é‡å å’Œäº’ä¿¡æ¯æ¥åº¦é‡
*   **è‡ªç›¸å…³**â€”â€”è¶…è¿‡ 30 ä¸ªæ—¶é—´æ»åçš„çœŸå®å’Œåˆæˆä¹‹é—´çš„æ¯”ç‡
*   **æ•ˆç”¨** â€”ç”¨çœŸå®æ•°æ®å’Œåˆæˆæ•°æ®è®­ç»ƒæ—¶é¢„æµ‹è¯¯å·®çš„ç›¸å¯¹æ¯”ç‡æ¥è¡¡é‡

æˆ‘ä»¬ä½¿ç”¨ LSTM(é•¿çŸ­æœŸè®°å¿†)æ¨¡å‹å’Œè‡ªä¸¾ä½œä¸ºåŸºçº¿ã€‚è¿™ä¸ª [LSTM æ¨¡å‹](https://en.wikipedia.org/wiki/Long_short-term_memory)ç”±ä¸¤å±‚ç»„æˆï¼Œæ¯å±‚ 100 ä¸ªç¥ç»å…ƒï¼Œä½¿ç”¨ 30 å°æ—¶çš„æ»‘åŠ¨çª—å£ã€‚å±æ€§é€šè¿‡å¯†é›†å±‚æ·»åŠ ï¼Œå¹¶è¿æ¥åˆ°ç½‘ç»œçš„æœ€åä¸€ä¸ªéšè—å±‚ã€‚

ä»è¡¨ 2 ä¸­å¯ä»¥çœ‹å‡ºï¼Œç”¨æ¯å‘¨æ•°æ®è®­ç»ƒçš„ dopper è¡¨ç°ç›¸å¯¹è¾ƒå¥½ï¼Œè¿œè¿œè¶…è¿‡äº† bootstrapping æŠ€æœ¯ã€‚

![](img/43988895435ccc020f4ebeb43b912685.png)

è¡¨ 2:æµé‡æ•°æ®é›†çš„ç»“æœã€‚

æˆ‘ä»¬æ·»åŠ äº†ç¬¬ä¸‰ä¸ªåº¦é‡æ ‡å‡†ï¼Œå³**é¡ºåºäº’ä¿¡æ¯** (SMI)ã€‚å®ƒåœ¨åŒ…å« *T* åˆ—çš„çŸ©é˜µä¸Šè¯„ä¼°äº¤äº’ä¿¡æ¯ï¼Œå…¶ä¸­æ¯ä¸€åˆ—å¯¹åº”äºä¹‹å‰ Tã€t-1ã€t-2ã€â€¦ t-T æ—¶é—´æ­¥å‘ç”Ÿçš„äº‹ä»¶ï¼Œå¹¶åœ¨å±æ€§å­é›†ä¸Šæ±‚å¹³å‡ã€‚

æˆ‘ä»¬åº”è¯¥æ³¨æ„åˆ°ï¼Œæ¨¡å‹å¯ä»¥ä»¥å±æ€§ä¸ºæ¡ä»¶ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä¸ºç‰¹å®šçš„å¤©æ°”æ¡ä»¶æˆ–ä¸€å‘¨æˆ–ä¸€æœˆä¸­çš„æŸä¸€å¤©ç”Ÿæˆæ ·æœ¬ã€‚

# å·®åˆ†éšç§å®éªŒ

åœ¨æœ€åˆçš„å·¥ä½œä¸­ï¼Œä½œè€…é€šè¿‡å‘é‰´åˆ«å™¨æ·»åŠ å™ªå£°å¹¶å‰ªè£å…¶æ¢¯åº¦çš„ä¼—æ‰€å‘¨çŸ¥çš„æŠ€æœ¯â€”â€”DPGAN,åœ¨æ¨¡å‹ä¸­å¼•å…¥äº†å·®åˆ†éšç§ã€‚

ç„¶è€Œï¼Œä»–ä»¬å‘ç°ï¼Œä¸€æ—¦éšç§é¢„ç®—Îµå˜å¾—ç›¸å¯¹è¾ƒå°â€”â€”è¿™æ„å‘³ç€åˆæˆæ•°æ®å˜å¾—æ›´å®‰å…¨ï¼Œå®ƒä¹Ÿå¼€å§‹å¤±å»è´¨é‡â€”â€”é€šè¿‡ç›¸å¯¹äºçœŸå®æ•°æ®çš„æ—¶é—´ä¸€è‡´æ€§æ¥è¡¡é‡ã€‚å¦‚æœæ•°æ®çš„æœ€ç»ˆç”¨é€”æ˜¯æå–è¯¦ç»†çš„æ—¶é—´ä¿¡æ¯ï¼Œå¦‚äº‹ä»¶ä¹‹é—´çš„å› æœå…³ç³»ï¼Œè¿™å¯èƒ½æ˜¯ä¸€ä¸ªå¤§é—®é¢˜ã€‚

åŸºäº[æœ€è¿‘å›´ç»• PPGAN](https://arxiv.org/pdf/1910.02007.pdf) (éšç§ä¿æŠ¤ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ)çš„å·¥ä½œï¼Œæˆ‘ä»¬å¯¹æ³¨å…¥é‰´åˆ«å™¨æ¢¯åº¦çš„å™ªå£°è¿›è¡Œäº†ä¸€äº›ä¿®æ”¹ã€‚[çŸ©çš„ä¼šè®¡å¸ˆ](https://arxiv.org/pdf/1607.00133.pdf)å°†éšç§æŸå¤±é—®é¢˜æ¡†å®šä¸ºä¸€ä¸ªéšæœºå˜é‡ï¼Œä½¿ç”¨å…¶çŸ©ç”Ÿæˆå‡½æ•°æ¥æ§åˆ¶å˜é‡çš„å¯†åº¦åˆ†å¸ƒã€‚è¿™ä¸ªæ€§è´¨ä½¿å¾— PPGAN æ¨¡å‹è®­ç»ƒæ›´åŠ ç¨³å®šã€‚å½“äº§ç”Ÿéå¸¸é•¿çš„åºåˆ—æ—¶ï¼Œä¸ DPGAN çš„å·®å¼‚å°¤å…¶æ˜¾è‘—ã€‚

å™ªå£°ç”±ä¸‹å¼ç»™å‡º:

É¸=f+N(0,Ïƒ2ğœf2)

å…¶ä¸­ğ·æ˜¯å¯¹æ¥è‡ªä¸¤ä¸ªç›¸é‚»ç‚¹ *x* å’Œ *x* çš„æŸ¥è¯¢ *f* çš„æ•æ„Ÿåº¦:

â–³f = maxf(x)-f(xâ€™)2

è¯¥è¡¨è¾¾å¼æ„å‘³ç€ï¼Œæœ€å…·ä¿¡æ¯æ€§çš„ç‚¹(æœ€é«˜çµæ•åº¦)ä¼šå°†æ›´å¤šçš„å™ªå£°æ·»åŠ åˆ°æ¸å˜ä¸­ï¼Œå› æ­¤ä¸ä¼šå½±å“å…¶ä»–ç‚¹çš„è´¨é‡ã€‚é€šè¿‡ä½¿ç”¨è¿™ç§ç²¾å¿ƒè®¾è®¡çš„å™ªå£°ï¼Œæˆ‘ä»¬èƒ½å¤Ÿåœ¨æµé‡æ•°æ®ä¸Šä¿æŒ 88%çš„è‡ªç›¸å…³ï¼Œç›´åˆ°Îµ = 1ã€‚

# ç»“è®º

åˆæˆé¡ºåºæ•°æ®ç”Ÿæˆæ˜¯ä¸€ä¸ªå°šæœªå®Œå…¨è§£å†³çš„å…·æœ‰æŒ‘æˆ˜æ€§çš„é—®é¢˜ã€‚é€šè¿‡ä¸Šè¿°æµ‹è¯•ï¼Œæˆ‘ä»¬è¯æ˜äº† GANs æ˜¯è§£å†³è¿™ä¸€é—®é¢˜çš„æœ‰æ•ˆæ–¹æ³•ã€‚
è¯·è®¿é—® Hazy ç½‘ç«™ï¼Œäº†è§£[åˆæˆæ—¶åºæ•°æ®](https://hazy.com/blog/2020/07/09/how-to-generate-sequential-data)çš„ä¸šåŠ¡ç”¨ä¾‹