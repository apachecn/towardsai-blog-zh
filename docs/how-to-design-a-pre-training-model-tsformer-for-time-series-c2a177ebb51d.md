# å¦‚ä½•ä¸ºæ—¶é—´åºåˆ—è®¾è®¡ä¸€ä¸ªé¢„è®­ç»ƒæ¨¡å‹(TSFormer)ï¼Ÿ

> åŸæ–‡ï¼š<https://pub.towardsai.net/how-to-design-a-pre-training-model-tsformer-for-time-series-c2a177ebb51d?source=collection_archive---------1----------------------->

## æœ€è¿‘ï¼Œåœ¨ NLP(è‡ªç„¶è¯­è¨€å¤„ç†)ä»»åŠ¡ä¸­æœ‰è®¸å¤šå°è¯•ï¼Œå…¶ä¸­å¤§å¤šæ•°éƒ½åˆ©ç”¨äº†é¢„å…ˆè®­ç»ƒçš„æ¨¡å‹ã€‚NLP ä»»åŠ¡çš„æè¦å¤§éƒ¨åˆ†æ˜¯ç”±äººç±»åˆ›é€ çš„æ•°æ®ï¼Œå……æ»¡äº†ä¸°å¯Œå’Œä¼˜ç§€çš„ä¿¡æ¯ï¼Œå‡ ä¹å¯ä»¥è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªæ•°æ®å•å…ƒã€‚åœ¨æ—¶é—´åºåˆ—é¢„æµ‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ„Ÿè§‰åˆ°ç¼ºä¹è¿™æ ·çš„é¢„è®­ç»ƒæ¨¡å‹ã€‚ä¸ºä»€ä¹ˆä¸èƒ½åƒåœ¨ NLP ä¸­é‚£æ ·åœ¨æ—¶é—´åºåˆ—ä¸­åˆ©ç”¨è¿™ç§ä¼˜åŠ¿ï¼Ÿï¼æœ¬æ–‡æ˜¯æå‡ºè¿™ç§æ¨¡å‹çš„è¯¦ç»†è¯´æ˜ã€‚è¯¥æ¨¡å‹æ˜¯é€šè¿‡è€ƒè™‘ä¸¤ä¸ªè§‚ç‚¹å¼€å‘çš„ï¼Œä»è¾“å…¥åˆ°è¾“å‡ºæœ‰ 4 ä¸ªéƒ¨åˆ†ã€‚æ­¤å¤–ï¼Œä¸ºäº†æ›´å¥½åœ°ç†è§£ï¼Œè¿˜æ·»åŠ äº† Python ä»£ç ã€‚

# t å˜å‹å™¨

*   å®ƒæ˜¯ä¸€ä¸ªåŸºäº**rans****åŸ**ts åŸ*****çš„*æ— ç›‘ç£é¢„è®­ç»ƒ*æ¨¡å‹***
*   *è¿™ä¸ªæ¨¡å‹èƒ½å¤Ÿæ•æ‰æˆ‘ä»¬æ•°æ®ä¸­éå¸¸é•¿çš„ä¾èµ–å…³ç³»ã€‚*

# **NLP å’Œæ—¶é—´åºåˆ—:**

*åœ¨æŸç§ç¨‹åº¦ä¸Šï¼ŒNLP ä¿¡æ¯å’Œæ—¶é—´åºåˆ—æ•°æ®æ˜¯**åŒ**ã€‚å®ƒä»¬éƒ½æ˜¯**é¡ºåºæ•°æ®**å’Œ**å±€éƒ¨æ•æ„Ÿæ•°æ®ï¼Œ**è¡¨ç¤ºä¸å…¶ä¸‹ä¸€ä¸ª/å‰ä¸€ä¸ªæ•°æ®ç‚¹ç›¸å…³ã€‚é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œæœ‰ä¸€äº›**å·®å¼‚**æˆ‘å°†åœ¨ä¸‹é¢è¯´:*

*æ­£å¦‚æˆ‘ä»¬ä¸º NLP ä»»åŠ¡æ‰€åšçš„é‚£æ ·ï¼Œåœ¨æå‡ºæˆ‘ä»¬çš„**é¢„è®­ç»ƒæ¨¡å‹**æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥è€ƒè™‘ä¸¤ä¸ªäº‹å®(äº‹å®ä¸Šï¼Œè¿™äº›æ˜¯å·®å¼‚):*

1.  *æ—¶é—´åºåˆ—æ•°æ®ä¸­çš„å¯†åº¦æ¯”è‡ªç„¶è¯­è¨€ä¸­çš„å¯†åº¦ä½å¾—å¤š*
2.  *æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ¯” NLP æ•°æ®æ›´é•¿åºåˆ—é•¿åº¦çš„æ—¶é—´åºåˆ—æ•°æ®*

# ****t ä»é›¶å¼€å§‹è½¬æ¢****

*å®ƒçš„è¿‡ç¨‹å’Œå…¶ä»–æ‰€æœ‰æ¨¡å‹ä¸€æ ·ï¼Œå°±åƒä¸€æ¬¡æ—…è¡Œ(æ²¡ä»€ä¹ˆæ–°æ„ï¼Œä½†è§†è§’å¾ˆå¥½)ã€‚æ­£å¦‚æˆ‘ç»™ä½ è®²è¿‡çš„ ***MAE*** çš„ç­–ç•¥ï¼Œä¸»è¦æ¶æ„æ˜¯ç»è¿‡ä¸€ä¸ª**ç¼–ç å™¨**ç„¶åå¤„ç†æˆä¸€ä¸ª**è§£ç å™¨**ï¼Œæœ€ååªæ˜¯é‡æ„ç›®æ ‡ã€‚*

*æ‚¨å¯ä»¥åœ¨å›¾ 1 ä¸­çœ‹åˆ°å®ƒçš„æ¶æ„:*

*![](img/1631110ba2ff270d834f9b8f3edbe3b9.png)*

*å›¾ 1 |ã€[æ¥æº](https://ui.adsabs.harvard.edu/abs/2022arXiv220609113S/abstract)*

> *å°±è¿™æ ·ï¼Œä¼™è®¡ï¼ï¼æ²¡æœ‰æ¯”è¿™ä¸ªæ•°å­—æ›´å¤šçš„äº†ã€‚ğŸ˜†ç„¶è€Œï¼›å¦‚æœæ‚¨æƒ³çŸ¥é“å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæˆ‘å°†åœ¨ä¸‹ä¸€èŠ‚ä¸­ä¸¾ä¾‹è¯´æ˜:*

*æµç¨‹:1ã€‚**2*æ©è”½*2**ã€‚ ***ç¼–ç *** 3ã€‚ ***è§£ç *** 4ã€‚ ***é‡å»ºç›®æ ‡****

## *1.æ©é¥°*

*![](img/fa59294c744b5ae98fbcdc2b64619d89.png)*

*å›¾ 2 | [æ¥æº](https://ui.adsabs.harvard.edu/abs/2022arXiv220609113S/abstract)*

*è¿™æ˜¯ä¸ºä¸‹ä¸€æ­¥(ç¼–ç å™¨)æä¾›è¾“å…¥çš„ç¬¬ä¸€æ­¥ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ**è¾“å…¥åºåˆ—**(*)å·²ç»è¢«åˆ†é…æˆé•¿åº¦ä¸º***ã€lã€‘***çš„ ***P* é¢ç‰‡**ã€‚å› æ­¤ï¼Œç”¨äºé¢„æµ‹ä¸‹ä¸€æ—¶é—´æ­¥çš„**æ»‘åŠ¨çª—å£**çš„é•¿åº¦ä¸º***P***x***L***ã€‚**

****åˆ¶ä½œæ¯”** ( ***r*** )æ˜¯ **75** % ( *æ¯”è¾ƒé«˜å§ï¼Ÿ);*è¿™ä»…ä»…æ˜¯å…³äºåˆ¶ä½œä¸€ä¸ª**è‡ªç›‘ç£ä»»åŠ¡**å¹¶ä½¿**ç¼–ç å™¨**æ›´**é«˜æ•ˆ**ã€‚**

**è¿™æ ·åšçš„ä¸»è¦åŸå› (*æˆ‘æŒ‡çš„æ˜¯ä¿®è¡¥è¾“å…¥åºåˆ—*)æ˜¯:**

1.  ****æ®µ**(å³è¡¥ä¸)æ¯”**åˆ†ç¦»ç‚¹**æ›´å¥½**ã€‚****
2.  **åˆ©ç”¨**ä¸‹æ¸¸æ¨¡å‹**ä½¿å¾—**æ›´ç®€å•**(stg nn å°†ä¸€ä¸ªå•å…ƒæ®µä½œä¸ºè¾“å…¥)**
3.  **è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥**å‡å°ç¼–ç å™¨**è¾“å…¥**çš„**å°ºå¯¸**ã€‚****

## **2.ç¼–ç **

**![](img/07001bfb50fcc1c8ca9fd1c4cd12c2a4.png)**

**å›¾ 3 | [ [æ¥æº](https://ui.adsabs.harvard.edu/abs/2022arXiv220609113S/abstract) ]**

**å¦‚ä½ æ‰€è§ï¼Œè¿™æ˜¯ä¸€ä¸ª ***è¾“å…¥åµŒå…¥ã€ä½ç½®ç¼–ç å’Œå˜æ¢å—*** çš„é¡ºåºã€‚ç¼–ç å™¨å¯ä»¥åªåœ¨**æœªå±è”½çš„è¡¥ä¸**ä¸Šæ‰§è¡Œã€‚*ç­‰ç­‰ï¼ï¼é‚£æ˜¯ä»€ä¹ˆï¼Ÿï¼Ÿ***

*****è¾“å…¥åµŒå…¥*****

**![](img/579bdf2d025fdb3ed499d1738f6b566e.png)**

*****Q)*** ä¸Šä¸€æ­¥æ˜¯å…³äºé®ç½©ï¼Œç°åœ¨æˆ‘è¯´æˆ‘ä»¬éœ€è¦æ— é®ç½©çš„ï¼Ÿï¼Ÿï¼ï¼**

*****A)* è¾“å…¥åµŒå…¥**ã€‚**

*****é—®)*** å¦‚ä½•ï¼Ÿ**

**a)å®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ª**çº¿æ€§æŠ•å½±**ï¼Œå°†æœªé®æ©è½¬æ¢ä¸º**æ½œåœ¨ç©ºé—´**ã€‚å…¶å…¬å¼å¦‚ä¸‹æ‰€ç¤º:**

**![](img/bdb25b5cb3b341c96d5b231ffe635887.png)**

**Eq 1ã€‚**

*****W*** å’Œ ***b*** æ˜¯**å¯å­¦ä¹ å‚æ•°**å’Œ ***U*** æ˜¯ ***d* éšè—ç»´åº¦**ä¸­çš„**æ¨¡å‹è¾“å…¥å‘é‡**ã€‚**

****ä½ç½®ç¼–ç ****

**![](img/b877ced79892cc30a6585dbe52d9cae8.png)**

**ç®€å•çš„**ä½ç½®ç¼–ç å±‚**ç”¨äºé™„åŠ **æ–°çš„é¡ºåºä¿¡æ¯**ã€‚æ·»åŠ äº†æœ¯è¯­â€œ**å¯å­¦ä¹ çš„**â€ï¼Œè¿™æœ‰åŠ©äºæ˜¾ç¤º**æ¯” ***æ­£å¼¦*** æ€§èƒ½æ›´å¥½ã€‚åŒæ ·ï¼Œ**å¯å­¦ä¹ çš„ä½ç½®**åµŒå…¥æ˜¾ç¤ºäº†æ—¶é—´åºåˆ—çš„è‰¯å¥½**ç»“æœ**ã€‚****

****å˜å‹å™¨å—****

**![](img/282ab9f768fa4b3706868b6159f58a12.png)**

**ç ”ç©¶äººå‘˜ä½¿ç”¨äº† **4 å±‚å˜å½¢é‡‘åˆš**ï¼Œä»…ä½äºè®¡ç®—æœºè§†è§‰å’Œ NLP ä»»åŠ¡ä¸­çš„å¸¸è§é‡ã€‚æ­¤å¤„æ‰€ç¤ºçš„å˜å‹å™¨ç±»å‹æ˜¯æœ€å¸¸ç”¨çš„å˜å‹å™¨æ¶æ„ã€‚ä½ å¯ä»¥åœ¨ 2017 å¹´å‡ºç‰ˆçš„ã€Š[æ³¨æ„åŠ›æ˜¯ä½ æ‰€éœ€è¦çš„å…¨éƒ¨](https://arxiv.org/pdf/1706.03762)ã€‹ä¸­é€šè¯»ã€‚é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œæˆ‘è¦ç»™ä½ ä¸€ä¸ªæ€»ç»“(è¿™ä¸ªç®€çŸ­çš„è¯´æ˜æ¥è‡ªæˆ‘ä»¥å‰çš„ä¸€ç¯‡æ–‡ç« ï¼Œ[Informer:Beyond Efficient Transformer for Long Sequence Time-Series Forecastingâ€™](https://rezayazdanfar.medium.com/informer-beyond-efficient-transformer-for-long-sequence-time-series-forecasting-4eeabb669eb)):**

**å˜å½¢é‡‘åˆšæ˜¯æ–°çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œå‘ˆç°çš„é€Ÿåº¦è¶Šæ¥è¶Šå¿«ã€‚ä»–ä»¬é‡‡ç”¨äº†**è‡ªæˆ‘å…³æ³¨**çš„æœºåˆ¶ï¼Œå¹¶åœ¨ NLP å’Œè®¡ç®—æœºè§†è§‰çš„æŒ‘æˆ˜æ€§ä»»åŠ¡ä¸­æ˜¾ç¤ºå‡ºæ¨¡å‹æ€§èƒ½çš„æ˜¾è‘—æé«˜ã€‚å˜å‹å™¨æ¶æ„å¯ä»¥è®¾æƒ³æˆä¸¤éƒ¨åˆ†ï¼Œç§°ä¸º ***ç¼–ç å™¨*** å’Œ ***è§£ç å™¨****ï¼Œå¦‚å›¾ 4 æ‰€ç¤ºï¼Œå¦‚ä¸‹:***

***![](img/5bccb24e442e5286b0d52301c93bd5c7.png)***

***å›¾ 4ã€‚å˜å‹å™¨æ¶æ„| [ [æ¥æº](https://arxiv.org/abs/1706.03762) ]***

***å˜å½¢é‡‘åˆšçš„è¦ç‚¹æ˜¯ç‹¬ç«‹äºåœ°åŸŸã€‚ä¸ CNN ç­‰å…¶ä»–æµè¡Œæ¨¡å¼ç›¸æ¯”ï¼Œã€Šå˜å½¢é‡‘åˆšã€‹ä¸å—æœ¬åœ°åŒ–çš„é™åˆ¶ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ä¸å»ºè®®åœ¨ã€Šå˜å½¢é‡‘åˆšã€‹ä¸­ä½¿ç”¨ä»»ä½• CNN æ¶æ„ï¼›ç›¸åï¼Œæˆ‘ä»¬åœ¨ã€Šå˜å½¢é‡‘åˆšã€‹ä¸­ä½¿ç”¨åŸºäºæ³¨æ„åŠ›çš„ç»“æ„ï¼Œè¿™è®©æˆ‘ä»¬èƒ½å¤Ÿå®Œæˆæ›´å¥½çš„ç»“æœã€‚
æ³¨æ„åŠ›æ¶æ„å¯ä»¥æ¦‚æ‹¬åœ¨å›¾ 5 ä¸­:***

***![](img/143432ee1e504a5cd020cf07c7791004.png)***

***å›¾ 5(å·¦)ç¼©æ”¾çš„ç‚¹ç§¯æ³¨æ„åŠ›ã€‚(å³)å¤šå¤´æ³¨æ„åŠ›ç”±å‡ ä¸ªå¹¶è¡Œè¿è¡Œçš„æ³¨æ„åŠ›å±‚ç»„æˆã€‚|[æ¥æº](https://arxiv.org/abs/1706.03762)***

***æ¯”ä¾‹ç‚¹ç§¯æ³¨æ„åŠ›çš„å‡½æ•°æ˜¯ Eqã€‚2***

***![](img/051e89a935db7cf1b10ee9c6af972a43.png)***

***æƒ…å•†ã€‚2 [ [æ¥æº](https://arxiv.org/abs/1706.03762)***

***q(æŸ¥è¯¢)ï¼ŒK(é”®)ï¼ŒV(å‘é‡)æ˜¯æˆ‘ä»¬æ³¨æ„åŠ›çš„è¾“å…¥ã€‚***

***å¯¹äºå˜å½¢é‡‘åˆšå®Œæ•´çš„åŸºæœ¬å®ç°ï¼Œè¯·çœ‹"[](https://arxiv.org/pdf/1706.03762)*ã€‚"å®ƒè®©ä½ å¯¹æ³¨æ„åŠ›å’Œå˜å½¢é‡‘åˆšæœ‰äº†å¾ˆå¤§çš„äº†è§£ï¼›äº‹å®ä¸Šï¼Œæˆ‘ç¬¬ä¸€æ¬¡é€šè¿‡è¿™ç¯‡è®ºæ–‡å®Œæ•´åœ°ç†è§£äº†è¿™ä¸ªé‡è¦çš„æ¨¡å‹ã€‚****

> ***æˆ‘è§‰å¾—è¿™ä¸ªæ€»ç»“é‡è¶³å¤Ÿå˜å½¢é‡‘åˆšç”¨äº†***

## ***3.è§£ç ***

***![](img/0f3bcca7c1eef2b3ad3f38130a780e20.png)***

***å›¾ 6 | [ [æ¥æº](https://ui.adsabs.harvard.edu/abs/2022arXiv220609113S/abstract)***

***è§£ç å™¨åŒ…æ‹¬ä¸€ç³»åˆ—å˜æ¢å™¨å—ã€‚å®ƒé€‚ç”¨äºæ‰€æœ‰è¡¥ä¸é›†(å±è”½ä»¤ç‰Œç­‰)ã€‚).ç›¸æ¯”ä¹‹ä¸‹ï¼Œ **MAEs** ( *å±è”½è‡ªåŠ¨ç¼–ç å™¨*)ï¼Œç”±äºè¡¥ä¸å·²ç»æœ‰ä½ç½®ä¿¡æ¯ï¼Œæ‰€ä»¥æ²¡æœ‰ä½ç½®åµŒå…¥ã€‚**å±‚æ•°**æ­£å¥½æ˜¯**ä¸€å±‚**ã€‚ä¹‹åï¼Œç®€å•çš„ **MLPs** (å¤šå±‚æ„ŸçŸ¥)è¢«ä½¿ç”¨(*æˆ‘æƒ³ç¡®å®šæ²¡æœ‰å¿…è¦è¯´æ˜ MLPsğŸ˜‰*)ï¼Œä½¿å¾—**è¾“å‡ºé•¿åº¦*ç­‰äº*** åˆ°**æ¯ä¸ªé¢ç‰‡**ã€‚***

## **4.é‡å»ºç›®æ ‡**

**![](img/3713ea3574dafbae7e72628851664e9a.png)**

**å›¾ 7 | [ [æ¥æº](https://ui.adsabs.harvard.edu/abs/2022arXiv220609113S/abstract) ]**

**å¹¶è¡Œåœ°ï¼Œ**è®¡ç®—**è¶…è¿‡**è¢«é®è”½çš„é¢ç‰‡**æ˜¯é’ˆå¯¹**çš„æ¯ä¸ªæ•°æ®ç‚¹** ( ***i*** )ã€‚å¦å¤–ï¼Œé€‰æ‹© **mae** ( ***å¹³å‡ç»å¯¹è¯¯å·®*** )ä½œä¸º**ä¸»åºåˆ—**å’Œ**é‡å»ºåºåˆ—**çš„**æŸå¤±å‡½æ•°**ã€‚**

**![](img/eae6e8729df512dfef34e5327650502a.png)**

**Eq 3ã€‚**

> **å°±æ˜¯è¿™æ ·ï¼ï¼ä½ åšåˆ°äº†ï¼ä¸å¤ªéš¾ï¼Œæ˜¯å—ï¼Ÿï¼Ÿï¼ğŸ˜‰ğŸ˜‰**
> 
> **ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹æ¶æ„:**

**![](img/1631110ba2ff270d834f9b8f3edbe3b9.png)**

**å›¾ 8 |ã€[æ¥æº](https://ui.adsabs.harvard.edu/abs/2022arXiv220609113S/abstract)**

# **ç»“æŸäº†**

> ****ä»£ç **å’Œ**æ¶æ„**çš„æ¥æºåˆ†åˆ«æ˜¯[è¿™ä¸ª](https://github.com/zezhishao/STEP)å’Œ[è¿™ä¸ª](https://ui.adsabs.harvard.edu/abs/2022arXiv220609113S/abstract)ã€‚**
> 
> ***å¯ä»¥åœ¨****Twitter***[*è¿™é‡Œ*](https://twitter.com/reza__yazdanfar) *æˆ–è€…****LinkedIn***[*è¿™é‡Œ*](http://www.linkedin.com/in/rezayazdanfar) *è”ç³»æˆ‘ã€‚æœ€åï¼Œå¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰è¶£åˆæœ‰ç”¨ï¼Œå¯ä»¥åœ¨* ***ä¸­*** *ä¸Š* ***å…³æ³¨*** *æˆ‘ï¼Œè·å–æ›´å¤šæ¥è‡ªæˆ‘çš„æ–‡ç« ã€‚***