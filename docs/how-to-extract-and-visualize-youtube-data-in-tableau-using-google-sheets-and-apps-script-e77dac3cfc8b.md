# å¦‚ä½•ä½¿ç”¨ Google Sheets å’Œ Apps è„šæœ¬åœ¨ Tableau ä¸­æå–å’Œå¯è§†åŒ– YouTube æ•°æ®

> åŸæ–‡ï¼š<https://pub.towardsai.net/how-to-extract-and-visualize-youtube-data-in-tableau-using-google-sheets-and-apps-script-e77dac3cfc8b?source=collection_archive---------2----------------------->

## [æ•°æ®å¯è§†åŒ–](https://towardsai.net/p/category/data-visualization)

![](img/61edf4464eee778562b56e95d0d5f46d.png)

ä½œè€…å›¾ç‰‡ï¼Œçµæ„Ÿæ¥è‡ª[æ™®æ‹‰å†…Â·é˜¿åŠ ç“¦å°”@æ™®æ‹‰å†… _ è®¾è®¡](https://www.figma.com/@pranay_design)

æ•°å­—æ•°æ®æ”¶é›†å¾ˆæœ‰è¶£ï¼Œé‚£ä¹ˆæ”¶é›†ä½ çœ‹çš„å’Œå–œæ¬¢çš„ä¸œè¥¿å‘¢ï¼Ÿ

æƒ³è±¡ä¸€ä¸‹è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼Œæ‚¨æƒ³è¦è·Ÿè¸ªæ‚¨æœ€å–œæ¬¢çš„ YouTube é¢‘é“çš„è¯¦ç»†ä¿¡æ¯ã€‚è¿™äº›ç»†èŠ‚å¯ä»¥åŒ…æ‹¬è®¢æˆ·æ•°é‡ã€è§‚çœ‹æ¬¡æ•°å’Œæœ€è¿‘çš„è§†é¢‘æ—¥æœŸã€‚æ›´è¿›ä¸€æ­¥ï¼Œæ‚¨å¯èƒ½å¸Œæœ›å°†è¿™äº›ç»†èŠ‚ä¿å­˜åœ¨æ–¹ä¾¿çš„åœ°æ–¹ï¼Œå¤§æ¦‚æ˜¯ä¿å­˜åœ¨ä¸€ä¸ªç®€å•çš„æ–‡æœ¬æ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”å¸Œæœ›æ¯éš”ä¸€æ®µæ—¶é—´æ›´æ–°ä¸€æ¬¡ã€‚
é‚£ä¹ˆï¼Œä½ å¦‚ä½•ä»¥ä¸€ç§ç®€å•çš„æ–¹å¼åšåˆ°è¿™ä¸€ç‚¹å‘¢ï¼Ÿ

åœ¨æœ¬æ–‡ä¸­ï¼Œæ‚¨å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨ Google Apps è„šæœ¬å°† YouTube é¢‘é“ä¸­çš„æ•°æ®æå–åˆ° Google Sheets ä¸­ï¼Œç„¶åä½¿ç”¨ Tableau æ˜¾ç¤ºè¿™äº›æ•°æ®ã€‚

# èƒŒæ™¯

## Google åº”ç”¨ç¨‹åºè„šæœ¬

[Google App Scripts](https://developers.google.com/apps-script/overview) æ˜¯ä¸€ä¸ªä½ä»£ç çš„äº‘æœåŠ¡å¹³å°ï¼Œå…è®¸ç”¨æˆ·æ¯«ä¸è´¹åŠ›åœ°æ‰©å±• Google äº§å“çš„åŠŸèƒ½ï¼Œè¿˜å…è®¸è·¨è¿™äº›å¹³å°çš„äº¤äº’ï¼Œè€Œä¸éœ€è¦è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­çš„å¤§é‡çŸ¥è¯†ã€‚App Script ä½¿ç”¨ JavaScriptã€HTMLã€CSS ç­‰æµè¡Œçš„ç¼–ç¨‹è¯­è¨€æ¥æ„å»ºæœåŠ¡ã€‚

app script è¿˜æœ‰å…¶ä»–æ‰©å±•åŠŸèƒ½ï¼Œä½†æˆ‘ä»¬çš„é‡ç‚¹å°†æ˜¯ä½¿ç”¨ app script ä»¥ç¼–ç¨‹æ–¹å¼ä¸ Google Sheets è¿›è¡Œäº¤äº’ï¼Œä½œä¸ºä» YouTube è‡ªåŠ¨è¾“å…¥æ•°æ®çš„ä¸€ç§æ–¹å¼ã€‚

## ï¼ˆèˆå°ä¸Šç”±äººæ‰®çš„ï¼‰é™æ€ç”»é¢

å¤§å¤šæ•°æ•°æ®åˆ†æå¸ˆå¯èƒ½å¬è¯´è¿‡ Tableauï¼Œè¿™æ˜¯ä¸€ä¸ªå¯è§†åŒ–äº¤äº’å¹³å°ï¼Œæœ‰ä¸€ä¸ªä¼˜ç§€çš„ã€ä»¤äººå…´å¥‹çš„ç¤¾åŒºã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Tableau Publicï¼Œè¿™æ˜¯ä¸€ä¸ªå…è®¸æ‚¨åœ¨çº¿å‘å¸ƒæ•°æ®å¯è§†åŒ–çš„å…è´¹å¹³å°ã€‚Tableau å°†é€šè¿‡è¿æ¥åˆ°å…¶å¹³å°ä¸Šçš„ Google Sheets è¿æ¥å™¨æ¥å¯è§†åŒ–æˆ‘ä»¬çš„æœ€ç»ˆæ•°æ®ã€‚

è®©æˆ‘ä»¬å¼€å§‹å§ï¼Œä½†é¦–å…ˆæ˜¯ä½ éœ€è¦çŸ¥é“çš„ã€‚

# å…ˆå†³æ¡ä»¶

*   ä¸€ä¸ªè°·æ­Œ[è´¦æˆ·](https://accounts.google.com/SignUp?hl=en)ï¼Œç”¨äºè®¿é—®è°·æ­Œè¡¨å•å’Œåº”ç”¨ç¨‹åºè„šæœ¬ã€‚
*   ä¸€ä¸ª Tableau public a[account](https://public.tableau.com/s/)å’Œ [Software](https://public.tableau.com/en-gb/s/download) ï¼Œå¦‚æœä½ è¿˜æ²¡æœ‰çš„è¯ã€‚
*   åˆå­¦è€…çš„ JavaScript çŸ¥è¯†æ²¡é—®é¢˜ã€‚
*   è°·æ­Œäº‘å¹³å°è´¦å·ã€‚

ç°åœ¨ä½ å·²ç»çŸ¥é“éœ€è¦ä»€ä¹ˆï¼Œè®©æˆ‘ä»¬å¼€å§‹è¡ŒåŠ¨çš„æ­¥éª¤ã€‚

# ç¼–è¾‘ä¸€ä¸ª YouTube é¢‘é“ id åˆ—è¡¨

åœ¨å¼€å§‹æ„å»ºä¹‹å‰ï¼Œæ‚¨éœ€è¦æœ‰ä¸€ä¸ª Youtube é¢‘é“ id åˆ—è¡¨ã€‚è¿™ä¸ª ID å¯¹äºä¸€ä¸ªé€šé“æ˜¯å”¯ä¸€çš„ï¼Œå°†ç”¨äºä» API ä¸­æå–é€šé“çš„è¯¦ç»†ä¿¡æ¯ã€‚

ä¸ºæ­¤ï¼Œæ‚¨å¿…é¡»åœ¨æ–°çš„ Google è¡¨å•ä¸­æ‰‹åŠ¨å¡«å……æ‚¨å–œçˆ±çš„é¢‘é“åˆ—è¡¨ã€‚è¯¥ä¿¡æ¯ä¸å¿…åŒ…å«ä¿¡é“çš„å®é™…åç§°ã€‚å¡«å……è¿™äº›åç§°çš„æœ¬è´¨æ˜¯è·å¾—ç›®æ ‡ YouTube é¢‘é“çš„é«˜çº§è§†å›¾ï¼›ç„¶åï¼Œå¯¹äºæ¯ä¸ªåç§°ï¼Œæœç´¢å®ƒä»¬å„è‡ªçš„ url_idã€‚

åˆ›å»ºä¸€ä¸ªåä¸º*â€œæœ€å—æ¬¢è¿çš„ Youtube å–œå‰§æ¼”å‘˜â€*çš„æ–°è°·æ­Œè¡¨å•

![](img/9faa494ef661556a6a0f0d9888e387dc.png)

YouTube é¢‘é“åç§°åˆ—è¡¨(å›¾ç‰‡ç”±ä½œè€…æä¾›)

## è·å–é¢‘é“ ID

è¿™ä¸€éƒ¨åˆ†å¤„ç†è·å–ä¸å¸æˆ·ç›¸å…³è”çš„æƒŸä¸€ IDã€‚æ¯ä¸ªé¢‘é“åœ¨å…¶ URL ä¸­éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ IDã€‚

åœ¨ YouTube çš„[ä¸Šï¼Œæœç´¢å¡«å……çš„é¢‘é“åç§°ï¼Œåœ¨è¿”å›çš„è§†é¢‘åˆ—è¡¨ä¸­ç‚¹å‡»é¢‘é“åç§°ï¼Œå¹¶ä» URL(](http://youtube.com)[https://www.youtube.com/channel/UCfvmvOEGw6Nqd6E9qMryE3A](https://www.youtube.com/channel/UCfvmvOEGw6Nqd6E9qMryE3A))å¤åˆ¶ IDã€‚

![](img/d07935a286e37f5d7355da7f1a53b507.png)

*æœç´¢é¢‘é“åç§°å¹¶ä» YouTube URL å¤åˆ¶ ID*(å›¾ç‰‡ç”±ä½œè€…æä¾›)

ä¹‹åï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„åˆ—â€”**Channel ID**â€”â€”å¹¶å°† ID ç²˜è´´åˆ°ä¸é€šé“æ‰€åœ¨è¡Œç›¸å…³çš„å•å…ƒæ ¼ä¸­çš„åˆ—ä¸‹ã€‚ç¡®ä¿å¯¹æ¯ä¸ªé€šé“éƒ½è¿™æ ·åšã€‚

![](img/ff1192855b60ec46059bd0e771c482db.png)

é¢‘é“åç§°åŠå…¶ ID(å›¾ç‰‡ç”±ä½œè€…æä¾›)

ç›¸åï¼Œä½ ä¼šæ³¨æ„åˆ°ä¸€äº› URL ä¸åŒäºä¼ ç»Ÿçš„åŸºäº ID çš„ URLã€‚è¿™äº›é¢‘é“çš„ URL ä½¿ç”¨ youtube ä¼ ç»Ÿç”¨æˆ·åï¼Œå¹¶ä¸”ä¸åœ¨ URL ä¸­æš´éœ²å®ƒä»¬çš„ idï¼›å› æ­¤ï¼Œæå–é€šé“çš„ ID éœ€è¦ä¸åŒçš„æŠ€æœ¯ã€‚

![](img/9ba5e41a6b3c637ac55f01e0dcaf0523.png)

ä½¿ç”¨æ—§ç”¨æˆ·å URL çš„é¢‘é“(å›¾ç‰‡ç”±ä½œè€…æä¾›)

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ‚¨å°†åˆ©ç”¨ Youtube æ•°æ® API

*   ä» URL ä¸­å¤åˆ¶é¢‘é“çš„ç”¨æˆ·åã€‚æ¯”å¦‚åœ¨ URL-[*https://www.youtube.com/user/MarkAngelComedy*](https://www.youtube.com/user/MarkAngelComedy)ä¸­ï¼Œç”¨æˆ·åä¸º***markangelcomyce***ã€‚
*   åœ¨æµè§ˆå™¨ä¸­å¯¼èˆªè‡³ [Youtube API](https://developers.google.com/youtube/v3/docs/channels/list) ï¼Œä» YouTube API explorer ä¸­æ£€ç´¢é¢‘é“ IDã€‚ç¡®ä¿æ‚¨å·²ç»ä½¿ç”¨ Google å¸æˆ·ç™»å½•ã€‚
*   ç‚¹å‡» API ç½‘é¡µä¸Šçš„`list (by YouTube *username*)`ã€‚
*   å°†***Google developers***æ›¿æ¢ä¸ºå³ä¾§é¢æ¿æ ‡é¢˜ä¸º **Try this API** çš„`forUsername`æ–‡æœ¬æ¡†ä¸­çš„æ¸ é“ç”¨æˆ·åã€‚

![](img/546c61cd8e9d02c64a870ddc9a5f7e2a.png)

ä» Youtube API æå–é¢‘é“ ID(å›¾ç‰‡ç”±ä½œè€…æä¾›)

ä¹‹åï¼Œç‚¹å‡»é¢æ¿åº•éƒ¨çš„**æ‰§è¡Œ**æŒ‰é’®ã€‚æ­¤æ“ä½œå°†è¦æ±‚æ‚¨éªŒè¯æ‚¨çš„ Google å¸æˆ·ï¼Œå¹¶æˆäºˆè®¿é—® YouTube API çš„æƒé™ã€‚ä¸€æ—¦æˆæƒè®¿é—®ï¼Œå°±ä¼šæ˜¾ç¤º API çš„å“åº”ï¼Œå¦‚ä¸Šå›¾ï¼Œä»ä¸­å¯ä»¥å¾—åˆ° JSON å€¼`id` > `items`ä¸‹çš„é€šé“ IDã€‚

å¯¹äºè¿™ç§åœºæ™¯ä¸‹çš„åç»­é¢‘é“ï¼Œæ‚¨åªéœ€æ›¿æ¢`forUsername`æ–‡æœ¬æ¡†ä¸­çš„ç”¨æˆ·åï¼Œç„¶åè¿è¡Œ**æ‰§è¡Œ**å‘½ä»¤ï¼Œä¹‹åæ‚¨å°±å¯ä»¥å¤åˆ¶ ID å¹¶å°†å…¶ç²˜è´´åˆ°æ‚¨çš„ google sheet ä¸­ã€‚

å½“ç„¶ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹å®Œæˆæ—¶ï¼Œæ‚¨ç°åœ¨åœ¨ä¸€ä¸ªåˆ—ä¸­æœ‰äº†å®Œæ•´çš„é€šé“ id åˆ—è¡¨ã€‚

![](img/f693cc7e32756ba0f1509c3e9cb6086a.png)

å®Œæ•´çš„é¢‘é“ id(å›¾ç‰‡ç”±ä½œè€…æä¾›)

# Google AppScript è®¾ç½®

## æ­¥éª¤ 1:è®¿é—®è°·æ­Œåº”ç”¨ç¨‹åºè„šæœ¬

ç°åœ¨æ‚¨å·²ç»åœ¨ç”µå­è¡¨æ ¼ä¸­æ‹¥æœ‰äº†æ‰€æœ‰çš„æ¸ é“ idï¼Œæ‚¨å°†ä¸å¾—ä¸è®¿é—®ç»‘å®šåˆ° google sheet çš„ apps è„šæœ¬ã€‚è¿™ä¸ªç¼–è¾‘å™¨å°†ä¿ƒè¿› Youtube å’Œå·¥ä½œè¡¨ä¹‹é—´çš„æ•°æ®äº¤äº’ã€‚

*   ç‚¹å‡»è¡¨å•èœå•æ ä¸­çš„**æ‰©å±•>åº”ç”¨ç¨‹åºè„šæœ¬**ç¼–è¾‘å™¨ã€‚è¯¥æ“ä½œå°†åˆ›å»ºä¸€ä¸ªæ–°çš„è„šæœ¬é¡¹ç›®ï¼Œå¹¶åœ¨ app è„šæœ¬ç¼–è¾‘å™¨ç•Œé¢ä¸Šå®ä¾‹åŒ–ä¸€ä¸ªæ–‡ä»¶ **code.gs** ã€‚è¯¥ç•Œé¢çœ‹èµ·æ¥åƒå¸¸è§„çš„ä»£ç ç¼–è¾‘å™¨ï¼Œä½†è¿™ä¸€æ¬¡ï¼Œå®ƒè¿è¡Œåœ¨äº‘å¹³å°ä¸Šï¼Œå¹¶ä» google sheet å®ä¾‹åŒ–ã€‚ä¹Ÿå¯ä»¥åœ¨å‡½æ•°ä¸­ç¼–å†™ä»£ç ï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨å•ç‹¬çš„æ–‡ä»¶åä¸­ã€‚
*   é‡å‘½åæ‚¨çš„é¡¹ç›®åç§°ã€‚åœ¨è„šæœ¬ç¼–è¾‘å™¨çš„å·¦ä¸Šæ–¹ï¼Œå°†å…¶ä»â€œ**æ— æ ‡é¢˜é¡¹ç›®**â€æ›´æ”¹ä¸ºâ€œ**æœ€å–œçˆ±çš„ Youtube é¢‘é“**

![](img/97a6e1d769322f2e1375a8f4bc857ca6.png)

åº”ç”¨ç¨‹åºè„šæœ¬é¡¹ç›®é‡å‘½å(å›¾ç‰‡ç”±ä½œè€…æä¾›)

## æ­¥éª¤ 2:è®¾ç½® Youtube æœåŠ¡

Apps script æä¾›äº†å†…ç½®çš„ google æœåŠ¡ï¼Œå› æ­¤ç”±äºæ‚¨éœ€è¦ YouTube é¢‘é“çš„è¯¦ç»†ä¿¡æ¯ï¼Œæ‚¨å°†éœ€è¦ YouTube æ•°æ® API æœåŠ¡æ¥å°†æ•°æ®æ‹‰å…¥å·¥ä½œè¡¨ä¸­ã€‚
åœ¨ Apps è„šæœ¬ä¸­å¯ç”¨æ­¤ YouTube æœåŠ¡ï¼›

*   ç‚¹å‡»å·¦ä¾§é¢æ¿ä¸­çš„**æœåŠ¡< >** ã€‚
*   é€‰æ‹© **YouTube æ•°æ® API v3** å¹¶ç‚¹å‡»**æ·»åŠ **ã€‚

![](img/aac04fe852fffaba4441f730e2a167b8.png)

æ˜¾ç¤º YouTube æœåŠ¡å¯ç”¨æ€§çš„è‡ªåŠ¨å»ºè®®(å›¾ç‰‡ç”±ä½œè€…æä¾›)

å®Œæˆåï¼Œæ‚¨å°±å¯ä»¥è®¿é—® Youtube æ•°æ®æœåŠ¡äº†ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚åœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæ‚¨å°†ç»å†ä½¿ç”¨è¿™ä¸ªæ¥å£å°†æ•°æ®ä» Youtube API æå–åˆ°è¡¨å•ä¸­çš„è¿‡ç¨‹ã€‚

# æ•°æ®æå–

å®Œæˆä¸Šä¸€èŠ‚ä¸­çš„è®¾ç½®åï¼Œæ‚¨å°±å¯ä»¥ç”¨ javascript ç¼–å†™ä»£ç æ¥ä» YouTube é¢‘é“ä¸­æ£€ç´¢è¯¦ç»†ä¿¡æ¯äº†ã€‚
åœ¨æœ¬æ–‡ä¸­ï¼Œæ‚¨å°†æå–ä»¥ä¸‹æ¸ é“è¯¦æƒ…:

*   æ ‡é¢˜
*   å‡ºç‰ˆæ—¥æœŸ
*   è®¢æˆ·æ•°é‡
*   è§†å›¾è®¡æ•°:ç´¯ç§¯çš„è§†å›¾æ€»æ•°
*   è§†é¢‘è®¡æ•°:ä¸Šä¼ çš„è§†é¢‘æ€»æ•°ã€‚
*   è§†é¢‘ä¸Šä¼ æ’­æ”¾åˆ—è¡¨ Id
*   ä¸Šæ¬¡ä¸Šä¼ æ—¥æœŸ
*   æ”¶è§†ç‡æœ€é«˜çš„è§†é¢‘æ ‡é¢˜
*   è§‚çœ‹æ¬¡æ•°æœ€å¤šçš„è§†é¢‘

ä¸ºäº†å®ç°è¿™äº›ç›®æ ‡ï¼Œä½ å¿…é¡»é‡‡å–ä»¥ä¸‹è¡ŒåŠ¨ã€‚ä½†æ˜¯é¦–å…ˆï¼Œåˆ›å»º 9 ä¸ªæ ‡é¢˜ï¼ŒæŒ‡å®šæ‚¨å°†æå–åˆ°å·¥ä½œè¡¨ä¸­çš„è¯¦ç»†ä¿¡æ¯çš„åˆ—ã€‚

![](img/49dcef6451c7cecb6df196bd4e7187e0.png)

é¢‘é“è¯¦ç»†ä¿¡æ¯çš„æ ‡é¢˜(ä½œè€…å›¾ç‰‡)

ä»¥ä¸‹æ˜¯å¦‚ä½•æå–è¿™äº›ç»†èŠ‚çš„æ¦‚è¿°ï¼›

1.  ä»å·¥ä½œè¡¨ä¸­è¯»å–é¢‘é“ idã€‚
2.  ä½¿ç”¨ IDs ä» Youtube API æå–æ•°æ®ã€‚
3.  å°†æ•°æ®å†™å…¥å·¥ä½œè¡¨ã€‚

éšåå°†è¯¦ç»†è§£é‡Šè¿™äº›åŠŸèƒ½åŠå…¶æ‰§è¡Œã€‚

![](img/ef42008bcec6fd4b3c0c63604f61b160.png)

æ•°æ®æå–è¿‡ç¨‹(å›¾ç‰‡ç”±ä½œè€…æä¾›)

## *ä»è¡¨å•ä¸­è¯»å–é¢‘é“ id*

![](img/733cc97e7f725ab826b6eafcc239bccc.png)

(å›¾ç‰‡æ¥è‡ªä½œè€…)

åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæ‚¨éœ€è¦æ„å»ºä¸€ä¸ªå‡½æ•°`getChannelID()`ã€‚è¯¥å‡½æ•°å°†å·¥ä½œè¡¨ä¸­çš„ id æ£€ç´¢åˆ° Apps è„šæœ¬ä¸­ã€‚è¯·æ³¨æ„ï¼Œid å°†ç”¨äºæ£€ç´¢é¢‘é“çš„è¯¦ç»†ä¿¡æ¯ã€‚

åœ¨ç¼–è¾‘å™¨ä¸­ï¼Œç”¨ä¸‹é¢çš„ä»£ç æ›¿æ¢`function myFunction(){}`:

ç¨åï¼Œæˆ‘ä»¬å°†è§£é‡Šæ¯ä¸ªä»£ç çš„åŠŸèƒ½ã€‚æš‚æ—¶ï¼Œ
ä¿å­˜è„šæœ¬ï¼Œç‚¹å‡»èœå•æ ä¸Šçš„**è¿è¡Œ**æŒ‰é’®ã€‚è¿™å°†æŠŠæ‚¨é‡å®šå‘åˆ°ä¸€ä¸ªé¡µé¢ï¼Œä»¥éªŒè¯æ‚¨çš„ google å¸æˆ·ï¼Œå¹¶æˆäºˆå¯¹æ‚¨çš„ Google å¸æˆ·çš„è„šæœ¬ä¿¡æ¯è®¿é—®æƒé™ã€‚ä¸€æ—¦æ‚¨æ¥å—äº†è¯¥æµç¨‹ï¼Œæ‚¨çš„æ“ä½œç»“æœå°†æ˜¾ç¤ºåœ¨ä¸‹é¢ã€‚

![](img/4202ff25006bc2ac0a059f80dfc680ce.png)

åº”ç”¨ç¨‹åºè„šæœ¬ä¸­çš„è°·æ­Œè®¤è¯é¡µé¢(å›¾ç‰‡ç”±ä½œè€…æä¾›)

åœ¨å“åº”æç¤ºä¸­ï¼Œæ‚¨ä¸å¿…æ‹…å¿ƒå®‰å…¨æ€§ï¼Œå› ä¸ºè„šæœ¬æ˜¯ç”±æ‚¨åˆ›å»ºçš„ã€‚ä½†æ˜¯åœ¨è®¿é—®æ‚¨ä¸äº†è§£çš„è„šæœ¬æ—¶è¦å°å¿ƒã€‚
è¦ç»§ç»­ï¼Œç‚¹å‡» ***è½¬åˆ°å–œçˆ±çš„ Youtube é¢‘é“(ä¸å®‰å…¨)***

ä¸€æ—¦æ‚¨çš„å¸æˆ·éªŒè¯å®Œæˆï¼Œæ‚¨ç°åœ¨å¯ä»¥åœ¨ç¼–è¾‘å™¨ä¸­é‡æ–°è¿è¡Œè¯¥åŠŸèƒ½ã€‚

å›åˆ°è§£é‡Šä»£ç ç‰‡æ®µã€‚
åœ¨è¿™ä¸ªä»£ç ç‰‡æ®µä¸­ï¼Œæˆ‘ä»¬å®ä¾‹åŒ–äº†æ¥è‡ª S [preadsheet æœåŠ¡](https://developers.google.com/apps-script/reference/spreadsheet/)çš„ç±»`SpreadsheetApp.getActiveSpreadsheet()`â€”â€”ä¸€ä¸ªå†…ç½®çš„ Google åº“ï¼Œå…è®¸è®¿é—®å’Œæ“ä½œæˆ‘ä»¬å½“å‰çš„ç”µå­è¡¨æ ¼ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå·¥ä½œè¡¨æ˜¯ *Sheet1* ï¼Œç”µå­è¡¨æ ¼æ˜¯*æœ€å–œæ¬¢çš„ YouTube å–œå‰§æ¼”å‘˜ã€‚* â€”ä¸è¦æ··æ·†[ç”µå­è¡¨æ ¼å’Œ](https://www.computerhope.com/jargon/s/spreadsheet.htm)å·¥ä½œè¡¨ä¹‹é—´çš„åŒºåˆ«ã€‚

ä¹‹åï¼Œæˆ‘ä»¬ä½¿ç”¨æ–¹æ³•`getSheetValues()`è®¿é—®å·¥ä½œè¡¨ä¸­é€šé“ id æ‰€åœ¨çš„èŒƒå›´ï¼Œè¯¥æ–¹æ³•æ¥å— 4 ä¸ªå‚æ•°`(startRow,startCol,numRow,numCol)`ï¼Œæè¿°è¦æ£€ç´¢çš„å€¼çš„èŒƒå›´ã€‚
è¯¥å‡½æ•°çš„ç»“æœæ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„ä¸­çš„æ‰€æœ‰é¢‘é“ idã€‚
ä½ å¯ä»¥ç”¨`console.log(col_channel_ids)`ä»£æ›¿`return col_channel_ids`å‡½æ•°æ¥æ‰“å°å‡ºäºŒç»´æ•°ç»„ä¸­çš„æ•°æ®ç»“æœã€‚

è¦è¿è¡Œä»£ç ï¼Œè¯·åœ¨èœå•æ ä¸­é€‰æ‹©å‡½æ•°åï¼Œç„¶åå•å‡» run æŒ‰é’®ã€‚

![](img/145ec79536dd69d69c980c5245c927a1.png)

åº”ç”¨ç¨‹åºè„šæœ¬ä¸­çš„é¢‘é“ id(å›¾ç‰‡ç”±ä½œè€…æä¾›)

## *ä»é€šé“ ID* è·å–æ•°æ®

![](img/57dc229cfa12a865ce61fbaea08a1c05.png)

æ•°æ®æå–è¿‡ç¨‹(å›¾ç‰‡ç”±ä½œè€…æä¾›)

ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥è®¿é—®åº”ç”¨ç¨‹åºè„šæœ¬ä¸Šçš„é¢‘é“ IDï¼Œä¸‹ä¸€ä¸ªåŠ¨ä½œæ˜¯æŸ¥è¯¢ YouTube åº“ï¼Œä»¥è·å¾—ç¬¬ä¸€ç»„ç»†èŠ‚â€”â€”`*Title*`ã€`*Published date*`ã€`*View Count: Total number of views accumulated*`ã€`*Video Count: Total number of videos uploaded*`å’Œ`*Video Uploaded Playlist Id*`â€”â€”è¿™äº›ç»†èŠ‚å°†ä» Youtube æœåŠ¡
ä¸­çš„`channels.list()`æ–¹æ³•è·å¾—ã€‚é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªåä¸º`getDataFromChannelID()`çš„å‡½æ•°ï¼Œå¹¶åŒ…å«ä¸‹é¢çš„ä»£ç ç‰‡æ®µï¼›

ä»ä»£ç ç‰‡æ®µæ¥çœ‹ï¼Œè¿™ä¸ªå‡½æ•°æ¥å—ä¸¤ä¸ªè¾“å…¥å‚æ•°ï¼Œ`part`å’Œ`channelID`ï¼Œå¹¶è¿”å›å…³äºé€šé“çš„å…·ä½“ç»†èŠ‚ã€‚å®ƒä½¿ç”¨`Youtube.Channels.list()`æ–¹æ³•è·å–é€šé“çš„æ•°æ®ã€‚

åœ¨ç¬¬ 18-25 è¡Œï¼›å› ä¸ºæ¥è‡ª API çš„å“åº”æ˜¯ä»¥ JSON çš„å½¢å¼å‡ºç°çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯¹è¾“å…¥ä¸­æŒ‡å®šçš„éƒ¨åˆ†å‚æ•°è¿›è¡Œç´¢å¼•ï¼Œä»¥è·å¾—æˆ‘ä»¬æ„Ÿå…´è¶£çš„å“åº”ã€‚part å‚æ•°è¡¨ç¤ºéœ€è¦ä» API è¿”å›çš„ä¿¡æ¯çš„ç±»åˆ«ã€‚åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ API ä¸­åµŒå¥—åœ¨`snippets`ã€`statistics`å’Œ`contentDetails`ä¸‹çš„ä¿¡æ¯ã€‚è¾“å‡ºæ˜¯æ‰€æœ‰åˆæ­¥æ•°æ®ç»†èŠ‚çš„æ•°ç»„ã€‚

![](img/deb610bd07f53344dc6f989a2c4e5220.png)

getDataFromChannelID çš„ç¤ºä¾‹å“åº”(å›¾ç‰‡ç”±ä½œè€…æä¾›)

## æ£€ç´¢è§†é¢‘è¯¦ç»†ä¿¡æ¯

éœ€è¦ä»é¢‘é“è·å–çš„ä¸‹ä¸€ç»„ä¿¡æ¯ä¸è§†é¢‘ç»†èŠ‚æœ‰å…³:`Last Upload Date`ã€`Highest-Viewed Video Title`å’Œ`Number of views for the highest-viewed video.`ã€
è¦è·å–è¿™äº›ä¿¡æ¯ï¼Œæ‚¨éœ€è¦ä½¿ç”¨è§†é¢‘ id è®¿é—®é¢‘é“ä¸­çš„æ‰€æœ‰è§†é¢‘ï¼Œé€šè¿‡è§†é¢‘ id å¯ä»¥æ£€ç´¢è§†é¢‘ç»†èŠ‚ã€‚

åœ¨ app è„šæœ¬å’Œä»£ç éƒ¨åˆ†ï¼Œè¿™å°†æ¶‰åŠä»¥ä¸‹æ­¥éª¤:

1.  è·å–é¢‘é“ä¸­ä¸è§†é¢‘ä¸Šä¼ ç›¸å…³çš„æ’­æ”¾åˆ—è¡¨ IDã€‚
2.  ä½¿ç”¨æ’­æ”¾åˆ—è¡¨ ID æ£€ç´¢æ‰€æœ‰ä¸Šä¼ çš„è§†é¢‘ ID å’Œä¸Šæ¬¡ä¸Šä¼ æ—¥æœŸã€‚
3.  ä½¿ç”¨è§†é¢‘ id æ£€ç´¢è§‚çœ‹ç‡æœ€é«˜çš„è§†é¢‘ç»†èŠ‚ã€‚

**æ£€ç´¢æ‰€æœ‰ä¸Šä¼ çš„è§†é¢‘ ID å’Œæœ€åä¸Šä¼ æ—¥æœŸ**
ä¸Šä¼ çš„æ’­æ”¾åˆ—è¡¨ ID å·²ç»åœ¨å‰é¢çš„éƒ¨åˆ†ä¸­æ£€ç´¢è¿‡äº†ï¼Œå› æ­¤æ‚¨å°†ä½¿ç”¨è¯¥å€¼æ¥è·å–æ¯ä¸ªé¢‘é“ä¸­æ‰€æœ‰ä¸Šä¼ çš„è§†é¢‘çš„ ID å’Œæœ€åä¸Šä¼ æ—¥æœŸã€‚è¯¥å‡½æ•°åœ¨ä¸‹é¢çš„ä»£ç ç‰‡æ®µä¸­å®ç°ã€‚

ä»ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼Œè¯¥å‡½æ•°å°†ä¸Šä¼ çš„æ’­æ”¾åˆ—è¡¨ id ä½œä¸ºè¾“å…¥å‚æ•°ã€‚å…³äºä»£ç çš„æ›´å¤šå†…å®¹è§£é‡Šå¦‚ä¸‹:

åœ¨å‡½æ•°ä½“ä¸­ï¼Œè¯¥å‡½æ•°æŸ¥è¯¢æ–¹æ³•`Youtube.PlayListItems.list()`ï¼Œå¹¶ä½¿ç”¨ while è¯­å¥éå†é¢‘é“ä¸Šä¼ çš„æ’­æ”¾åˆ—è¡¨ä¸­çš„è§†é¢‘åˆ—è¡¨ï¼Œä»…åœ¨è¯¥æ–¹æ³•ä¸­æ²¡æœ‰æ›´å¤šé¡µé¢å¯æŸ¥è¯¢æ—¶åœæ­¢ï¼Œè¿™ç”±å˜é‡`nextPageToken`è·Ÿè¸ªã€‚

åœ¨è¿­ä»£ä¸­ï¼Œé¦–å…ˆè®°å½•ä½äºç¬¬ä¸€é¡µæŸ¥è¯¢ç»“æœé¡¶éƒ¨çš„`Last Upload Date`ã€‚

ä¹‹åï¼Œåœ¨ç¬¬ 27 è¡Œï¼Œç”±äºæ–¹æ³•`Youtube.PlayListItems.list()`é€é¡µè¿”å›è§†é¢‘å†…å®¹åˆ—è¡¨ï¼Œæˆ‘ä»¬ä½¿ç”¨ map å‡½æ•°ä»æ¯ä¸ªé¡µé¢æå–å†…å®¹ï¼Œç„¶åç´¢å¼•åˆ°ç¬¬ 28 è¡Œçš„å“åº”ä¸­ï¼Œä»¥è·å¾—`video IDs`ï¼Œè¿™äº›å†…å®¹éšåè¢«è¿½åŠ åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ã€‚

æœ€ç»ˆç»“æœæ˜¯ä¸€ä¸ªåŒ…å«æ‰€æœ‰`video IDs`å’Œ`Last Upload Date`çš„æ•°ç»„ã€‚

![](img/06ec7e12a8b1d9cc88bc97bfbe0fa76e.png)

è§†é¢‘ id æ•°ç»„å’Œæœ€åä¸Šä¼ æ—¥æœŸ(å›¾ç‰‡ç”±ä½œè€…æä¾›)

**ä½¿ç”¨è§†é¢‘ id**
æ£€ç´¢è§‚çœ‹ç‡æœ€é«˜çš„è§†é¢‘ç»†èŠ‚åœ¨è·å¾—ä¸Šä¸€èŠ‚ä¸­çš„è§†é¢‘ id åï¼Œæ‚¨å°†åœ¨æœ¬èŠ‚ä¸­è®¡ç®—å‰©ä½™çš„è§†é¢‘ç»†èŠ‚â€” `Highest-Viewed Video Title`å’Œ`Number of views for the highest-viewed video`ã€‚

åˆ›å»ºåŠŸèƒ½`getHighestViewedFromID().`

è¿™ä¸ªå‡½æ•°æ¥å—ä¸€ä¸ªè§†é¢‘ id åˆ—è¡¨ï¼Œä¸€æ¬¡éå† 50 ä¸ª idï¼Œå¹¶æ£€ç´¢å®ƒä»¬çš„è§†é¢‘ç»†èŠ‚ã€‚æ¯æ¬¡è°ƒç”¨ 50 æ¬¡æ£€ç´¢çš„æœ¬è´¨æ˜¯å‡å°‘å¯¹ API çš„æŸ¥è¯¢æ¬¡æ•°ã€‚

è¿™æ˜¯è¦ç‚¹ã€‚æˆ‘ä»¬æ­£åœ¨å°è¯•ä½¿ç”¨æœåŠ¡ API æ–¹æ³•`YouTube.Videos.list()`æ£€ç´¢æ¯ä¸ªè§†é¢‘çš„è§‚çœ‹æ¬¡æ•°ã€‚æ¯æ¬¡æŸ¥è¯¢åˆ° API æˆæœ¬ [1 å•ä½](https://developers.google.com/youtube/v3/docs/videos/list)ã€‚ç„¶è€Œï¼Œé’ˆå¯¹å•ä¸ªè§†é¢‘ç»†èŠ‚ç‚¹å‡»ä¸€æ¬¡ API çš„æˆæœ¬ä¸é’ˆå¯¹å¤šä¸ªè§†é¢‘ç»†èŠ‚çš„æˆæœ¬ç›¸åŒã€‚å› æ­¤ï¼Œæˆ‘ä»¬æ‰¹é‡æ£€ç´¢è§†é¢‘ç»†èŠ‚ï¼Œä»¥è·å¾—æœ€ä½³çš„å•ä½è´¹ç”¨ã€‚
å³ä½¿æœ‰è¿™ç§å¤šé‡æ£€ç´¢åŠŸèƒ½ï¼Œæ¯æ¬¡è°ƒç”¨æœ€å¤šå…è®¸æ£€ç´¢ 50 ä¸ªè§†é¢‘ã€‚è¿™å°±éœ€è¦æ‹†åˆ†è§†é¢‘ id åˆ—è¡¨ï¼Œå¹¶ä¸ºå•ä¸ªæŸ¥è¯¢å®ä¾‹ä»¥ 50 ä¸ªä¸ºä¸€æ‰¹æ¥æ£€ç´¢å®ƒä»¬çš„è¯¦ç»†ä¿¡æ¯ã€‚

ä¸è¿‡ï¼Œåœ¨è¿­ä»£ä¸­ï¼Œç¬¬ 23 è¡Œï¼Œæ‚¨å¯ä»¥çœ‹åˆ°æˆ‘ä»¬é€šè¿‡ç´¢å¼•å“åº”çš„`snippet`éƒ¨åˆ†ä¸­çš„`title`å’Œå“åº”çš„`statistics`éƒ¨åˆ†ä¸­çš„`viewCount`è·å¾—äº†æ„Ÿå…´è¶£çš„ä¿¡æ¯ï¼›è¡¨ç¤ºè§†é¢‘åç§°å’Œè§†é¢‘è¢«è§‚çœ‹çš„æ¬¡æ•°ã€‚
æœ‰äº†è¿™ä¸ª nowï¼Œæ‰èƒ½è·å¾—æœ€å—å…³æ³¨çš„è§†é¢‘ç»†èŠ‚ï¼›è¯¥æ•°ç»„æŒ‰ç…§è§†å›¾æ•°é‡é™åºæ’åºï¼Œå¦‚ç¬¬ 28 è¡Œæ‰€ç¤ºï¼Œç¬¬ä¸€ä¸ªå…ƒç´ è¢«å¼¹å‡ºã€‚è¿™ä¸ªåœºæ™¯ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­åŒ…å«äº†è§‚çœ‹æ¬¡æ•°æœ€å¤šçš„è§†é¢‘åŠå…¶è§‚çœ‹æ¬¡æ•°ã€‚

å®Œæˆæ­¤æ“ä½œåï¼Œæ‚¨ç°åœ¨å·²ç»æ£€ç´¢åˆ°äº†æ‰€æœ‰éœ€è¦çš„æ•°æ®ã€‚ä¸‹ä¸€ä¸ªè°ƒç”¨ç‚¹å°†éœ€è¦å°†è¿™äº›æ•°æ®å†™å…¥è¡¨ä¸­ã€‚

## å°†æ•°æ®å†™å…¥å·¥ä½œè¡¨

è¿™æ˜¯å°†æˆ‘ä»¬çš„æ•°æ®å­˜å‚¨åˆ° Google sheet ä¸­çš„æœ€åä¸€ä¸ªå¸®åŠ©å‡½æ•°ã€‚å°†æ•°æ®æ¨é€åˆ°å·¥ä½œè¡¨éœ€è¦åˆ©ç”¨ç”µå­è¡¨æ ¼åº“æ–¹æ³•`getActiveSpreadsheet()`ã€‚å¦‚ä»£ç ç‰‡æ®µæ‰€ç¤ºï¼Œ

è¯¥å‡½æ•°æ¥æ”¶æœ€ç»ˆç»“æœ:ä¸€ä¸ªäºŒç»´å€¼æ•°ç»„ã€‚å®ƒåˆ©ç”¨æ¥å— 4 ä¸ªå‚æ•°çš„`getRange()`å‡½æ•°å°†æ•°æ®å­˜å‚¨åœ¨å·¥ä½œè¡¨ä¸­ï¼Œå…¶ä¸­ç¬¬ 3 ä¸ªå‚æ•°è¡¨ç¤ºè¡Œæ•°ï¼Œå³é€šé“æ•°ï¼Œç¬¬ 4 ä¸ªå‚æ•°æŒ‡å®šäºŒç»´æ•°ç»„ä¸­æŸé¡¹çš„é•¿åº¦â€”â€”åˆ—æ•°/é€šé“ç»†èŠ‚ã€‚

## æŠŠæ‰€æœ‰ä¸œè¥¿æ”¾åœ¨ä¸€èµ·

ç°åœ¨æˆ‘ä»¬æ‰€æœ‰çš„ç®¡é“å’ŒåŠ©æ‰‹å‡½æ•°éƒ½å‡†å¤‡å¥½äº†ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ‰€æœ‰çš„ä¸œè¥¿æ”¾åœ¨ä¸€èµ·äº†ã€‚å‰é¢å‡ èŠ‚æ¶‰åŠåˆ°å¤„ç†å•ä¸ªé€šé“çš„åŠ©æ‰‹å‡½æ•°ã€‚æ‚¨å°†æŠŠäº‹æƒ…æ•´åˆåˆ°å¤„ç†å¤šä¸ªé¢‘é“ä¸­ï¼Œå°±åƒåœ¨æˆ‘ä»¬çš„å¤šä¸ªå–œå‰§é¢‘é“çš„ç”¨ä¾‹ä¸­ä¸€æ ·ã€‚

æˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªåä¸º`executeAll()`çš„å‡½æ•°ã€‚é¦–å…ˆï¼Œä½¿ç”¨åœ¨å‰é¢çš„[éƒ¨åˆ†](#cfca)ä¸­åˆ›å»ºçš„æ–¹æ³•`getChannelIDs()`ï¼Œä»¥äºŒç»´æ•°ç»„çš„å½¢å¼ä»ç”µå­è¡¨æ ¼ä¸­æ£€ç´¢æ‰€æœ‰é¢‘é“ idã€‚æˆ‘ä»¬ä½¿ç”¨ map å‡½æ•°éå† id åˆ—è¡¨ã€‚ä½¿ç”¨ map å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åªè°ƒç”¨ä¸€æ¬¡æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹ï¼Œå¹¶å¤„ç†å®ƒä»¥è¿”å›äºŒç»´æ•°ç»„ä¸­çš„æ–°å€¼ã€‚

é€’å½’å‡½æ•°ä¸­çš„ç¬¬ä¸€ä¸ªåŠ¨ä½œä»é€šé“ ID è¿”å›åˆæ­¥æ•°æ®ï¼Œè¿™äº›æ•°æ®æ˜¯(`Title`ã€`Published date`ã€`Number of subscribers`ã€`number of views`ã€`number of videos`å’Œ`uploaded playlistID`)ã€‚

ç„¶è€Œï¼Œåœ¨å¾ªç¯å†…éƒ¨ï¼Œç¬¬ 7 è¡Œä¸­çš„ä¸‹ä¸€ä¸ªåŠ¨ä½œä»åˆå§‹æ•°æ®ä¸­æå–å‡º`uploaded playlist ID`ï¼Œå¹¶å°†å…¶ä¼ é€’ç»™å˜é‡`uploaded_playlist_id`ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨`uploaded_playlist_id`ä½œä¸ºæ–¹æ³•`getUploadedVideoIDs_LastDt()`çš„è¾“å…¥å‚æ•°ï¼Œæ£€ç´¢è§†é¢‘ id åˆ—è¡¨å’Œæœ€æ–°ä¸Šä¼ æ—¥æœŸã€‚

ä¸‹ä¸€ä¸ªåŠ¨ä½œä½¿ç”¨æ–¹æ³•`getHighestViewedFromID()`ä¸­çš„`video IDs`æ¥è·å–æ¯ä¸ªé¢‘é“ä¸­è§‚çœ‹ç‡æœ€é«˜çš„è§†é¢‘çš„è¯¦ç»†ä¿¡æ¯ã€‚

ä¹‹åï¼Œæ‰€æœ‰éœ€è¦çš„æ•°æ®åœ¨ä¸€ä¸ªäºŒç»´æ•°ç»„ä¸­è€¦åˆåœ¨ä¸€èµ·ï¼Œè¯¥å‡½æ•°è¿”å›ç”±`preliminary data`ã€`latest-upload date`ã€`highest_viewed_video_title`å’Œ`highest_viewed_video_count`ç»„æˆçš„æ•°æ®ã€‚

![](img/8ae0961b06ed1cf040cf95de4564054d.png)

äºŒç»´é˜µåˆ—ä¸­çš„æ ·æœ¬å“åº”(å›¾ç‰‡ç”±ä½œè€…æä¾›)

æœ€åï¼ŒåŒ…å«æ¯ä¸ªé€šé“ç»†èŠ‚çš„äºŒç»´æ•°ç»„æ•°æ®è¢«å†™å…¥ç”µå­è¡¨æ ¼ã€‚

å®Œæ•´çš„ä»£ç ç‰‡æ®µ

è®°å¾—æŒ‰ä»¥ä¸‹é¡ºåºåˆ›å»ºåˆ—æ ‡é¢˜:*æ ‡é¢˜ã€å‘å¸ƒæ—¥æœŸã€è®¢é˜…äººæ•°ã€æ€»æµè§ˆé‡ã€æ€»ä¸Šä¼ é‡ã€ä¸Šä¼ æ’­æ”¾åˆ—è¡¨ Idã€æœ€åä¸Šä¼ æ—¥æœŸã€æœ€é«˜è§‚çœ‹è§†é¢‘å’Œæœ€é«˜è§‚çœ‹è§†é¢‘è®¡æ•°ã€‚*

![](img/df53facc00761e4f1a69e0a7cb2bc348.png)

è°·æ­Œè¡¨å•ä¸­çš„æœ€ç»ˆæ•°æ®(å›¾ç‰‡ç”±ä½œè€…æä¾›)

# è‡ªåŠ¨åŒ–æ•°æ®æå–

ä½ ç°åœ¨åœ¨è°·æ­Œè¡¨å•ä¸­æœ‰äº†æˆ‘ä»¬çš„æ•°æ®ã€‚æˆ‘ä»¬çš„ä¸‹ä¸€ä¸ªéœ€æ±‚ç‚¹å°†æ¶‰åŠåœ¨ç‰¹å®šæ—¶é—´æ®µè§¦å‘è¯¥æ•°æ®çš„æ›´æ–°ï¼Œè¿™å°†é€šè¿‡åº”ç”¨ç¨‹åºè„šæœ¬ä¸­çš„æ—¶é—´é©±åŠ¨è§¦å‘å™¨æ¥å®Œæˆã€‚

[æ—¶é—´è§¦å‘å™¨](https://developers.google.com/apps-script/guides/triggers/events)æ˜¯åœ¨ç‰¹å®šæ—¶é—´è§¦å‘äº‹ä»¶çš„ä¿ç•™åŠŸèƒ½ã€‚åœ¨è¿™ä¸ªä¸Šä¸‹æ–‡ä¸­ï¼Œäº‹ä»¶æ˜¯æ›´æ–°å·¥ä½œè¡¨ä¸­çš„æ•°æ®ï¼›æ‚¨å¸Œæœ›æ¯éš” 12 å°æ—¶å®šæœŸè¿›è¡Œä¸€æ¬¡è¯¥äº‹ä»¶ã€‚

åœ¨åº”ç”¨è„šæœ¬é¡µé¢ä¸Šï¼Œç‚¹å‡»å·¦ä¾§é¢æ¿ä¸Šçš„`**Triggers**`æŒ‰é’®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

![](img/f571506bff34b96ebf3e1b9fc9d06bb0.png)

è§¦å‘é¡µé¢(ä½œè€…å›¾ç‰‡)

å®Œæˆæ­¤è®¾ç½®å°†æ¶‰åŠä»¥ä¸‹æ­¥éª¤:

*   ç‚¹å‡»æŒ‰é’®`Add Trigger`ã€‚è¯¥æ“ä½œå°†æ‰“å¼€æç¤ºé¡µé¢ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ ¹æ®è§¦å‘å™¨å¡«å……è¿™äº›å€¼ã€‚
*   åœ¨æ–‡æœ¬`choose which function to run`ä¸‹ï¼Œé€‰æ‹©`executeAll()`åŠŸèƒ½ï¼›å®ƒåŒ…å«ä»å·¥ä½œè¡¨ä¸­æå–æ•°æ®æ‰€éœ€çš„æ‰€æœ‰ç®—æ³•ï¼›å…¶ä»–å‡½æ•°æ˜¯å¸®åŠ©ä¸»è¿›ç¨‹çš„è¾…åŠ©å‡½æ•°ã€‚
*   åœ¨`select event resource`ä¸Šé€‰æ‹©`Time-Driven`ï¼Œ
*   åœ¨`Select type of time-based trigger`ä¸‹é€‰æ‹©`*hour timer*`ã€‚ç„¶åé€‰æ‹©å°æ—¶é—´éš”ä¸ºæ¯`12 hours`ã€‚

æœ€åå°†`Failure notifiction settings` è®¾ç½®ä¸º`Notify me immediately`ã€‚è¿™å°†åœ¨æ‚¨çš„ä»£ç å‡ºç°é—®é¢˜æ—¶ç«‹å³å‘é€é€šçŸ¥æ¶ˆæ¯ã€‚è¯·æ³¨æ„ï¼Œæ­¤æ¶ˆæ¯å°†è¢«å‘é€åˆ°æ‚¨çš„ google å¸æˆ·çš„ç”µå­é‚®ä»¶ä¸­ã€‚
ç„¶åç‚¹å‡» ***ä¿å­˜*** æŒ‰é’®ã€‚

ä¿å­˜åï¼Œè§¦å‘å™¨å°†ä»å½“å‰ä¿å­˜æ—¶é—´å¼€å§‹æ¯ 12 å°æ—¶æ‰§è¡Œä¸€æ¬¡ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå®ƒä» 12 ç‚¹å¼€å§‹è¯»å–ã€‚

æ‚¨å¯ä»¥é€‰æ‹©ä»¥ç¼–ç¨‹æ–¹å¼ä¸ºæç¤ºé¡µé¢ä¸Šä¸å¯ç”¨çš„è§¦å‘é—´éš”åˆ›å»ºè‡ªå®šä¹‰çš„æ—¶é—´é©±åŠ¨è§¦å‘å™¨ã€‚

# æ•°æ®å¯è§†åŒ–

æœ€åä¸€éƒ¨åˆ†æ˜¯åœ¨ Tableau ä¸­åˆ›å»ºä¸€ä¸ªç®€å•çš„æ•°æ®å¯è§†åŒ–ã€‚åœ¨è¿™ä¸ªæ¼”ç¤ºé˜¶æ®µï¼Œæ‚¨å°†æŠŠ Google Sheets ä¸­çš„æ•°æ®è¿æ¥åˆ° Tableauï¼Œå¹¶åˆ›å»ºä¸€ä¸ªç®€å•çš„æ¡å½¢å›¾ï¼Œæ˜¾ç¤ºè§†é¢‘ä¸Šä¼ æ•°é‡æœ€å¤šçš„é¢‘é“ï¼›ä»¥åŠ`number of subscribers` vs `published date`ä¹‹é—´çš„é›¶æ•£å‰§æƒ…ã€‚å› æ­¤ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬ä¸ºå®ç°è¿™ä¸€ç›®æ ‡å°†è¦åšçš„äº‹æƒ…ã€‚

## å°†æ•°æ®è¿æ¥åˆ° Tableau Public

åœ¨ Tableau public ä¸Šï¼Œç‚¹å‡»***Google sheet connector***

*![](img/b32e908faf96acd0fbb7915f37bac8fc.png)*

*Tableau ä¸­çš„ Google å·¥ä½œè¡¨è®¿é—®(å›¾ç‰‡ç”±ä½œè€…æä¾›)*

*Tableau å°†è¯·æ±‚åœ¨æ‚¨çš„æµè§ˆå™¨ä¸­è®¿é—®æ‚¨çš„ Google Sheetsï¼Œå› æ­¤å•å‡»æ‚¨å„è‡ªçš„å¸æˆ·å¹¶è®¿é—®å®ƒã€‚å®Œæˆåï¼Œæ‚¨å°†çœ‹åˆ°ä¸€ä¸ªå±å¹•ï¼Œé€šçŸ¥æ‚¨æˆåŠŸè®¿é—®ã€‚*

*ä½ å¯ä»¥å®‰å…¨åœ°å…³é—­ï¼Œå›åˆ°ä½ çš„èˆå°ä¸Šã€‚*

*åœ¨å±å¹•ä¸Šï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ªè°·æ­Œè¡¨åˆ—è¡¨ï¼Œé€‰æ‹©ä¸€ä¸ªæ˜¯ä¸ºè¿™é¡¹å·¥ä½œåˆ›å»ºçš„ã€‚ç„¶åç‚¹å‡»ä¸‹é¢é€‰é¡¹å¡ä¸Šçš„ ***ç¬¬ 1 é¡µ*** å¼€å§‹å¯è§†åŒ–ã€‚*

*![](img/bfb9eaa64d18ede1089aebf1371ffbf5.png)*

*è®¿é—®è¡¨(å›¾ç‰‡ç”±ä½œè€…æä¾›)*

## *å‡†å¤‡æ•°æ®*

*è¯·æ³¨æ„ï¼Œåœ¨å·¦ä¾§é¢æ¿ä¸Šï¼Œæ‚¨ä¼šçœ‹åˆ°å›¾æ ‡`Abc`é è¿‘è¡¨æ ¼é¢æ¿ä¸­çš„å˜é‡å`Last upload Date`å’Œ`Published Date`ã€‚è¿™æ„å‘³ç€ Tableau é”™è¯¯åœ°å°†è¿™äº›æ—¥æœŸ-æ—¶é—´å˜é‡æ£€æµ‹ä¸ºæ–‡æœ¬ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»å°†å®ƒä»¬è½¬æ¢ä¸ºæ—¥æœŸ-æ—¶é—´æ•°æ®ç±»å‹ã€‚*

*ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†é‡‡å–ä»¥ä¸‹æ­¥éª¤:*

*   *é€‰æ‹©`Last Upload Date`å’Œ`Published date`ã€‚*
*   *å³é”®å•å‡»å¹¶é€‰æ‹©**æ›´æ”¹æ•°æ®ç±»å‹>æ—¥æœŸ&æ—¶é—´ã€‚***

*æ—¥æœŸ-æ—¶é—´åˆ—ç°åœ¨æˆåŠŸåœ°å¤„äºå…¶é€‚å½“çš„æ•°æ®ç±»å‹ä¸­ã€‚*

## *å˜é‡å¯è§†åŒ–å’Œæ ¼å¼åŒ–*

*åœ¨è¿™ä¸€é˜¶æ®µï¼Œæ‚¨å°†åˆ›å»ºæ¯ä¸ªå˜é‡çš„å›¾å½¢è¡¨ç¤ºã€‚ä»ä¸€ä¸ªç®€å•çš„è§†é¢‘ä¸Šä¼ æ•°é‡æ¡å½¢å›¾å¼€å§‹ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼›*

*   *å°†å·¦ä¾§é¢æ¿ä¸­çš„`*Total Uploads*`æ‹–åŠ¨åˆ°**åˆ—**ä¸­ï¼Œå°†`Title`æ‹–åŠ¨åˆ°**è¡Œ**ä¸­ã€‚*
*   *å†æ¬¡æ‹–åŠ¨`Total Uploads`åˆ°**æ ‡ç­¾å¡ä¸­çš„**ï¼Œ**æ ‡è®°***

*![](img/4438f6e375dce2892480563f85c71740.png)*

*ç®€å•æ¡å½¢å›¾(ä½œè€… gif)*

*ä¸ºäº†è¿›ä¸€æ­¥æ¢ç´¢ï¼Œæ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ªæ•£ç‚¹å›¾æ¥æ˜¾ç¤º`Published date`å’Œ`Number of subscribers`ä¹‹é—´çš„å…³ç³»ã€‚*

*é¦–å…ˆï¼Œæ‰“å¼€ä¸€ä¸ª**æ–°å·¥ä½œè¡¨**ï¼›åˆ†åˆ«æ‹–åŠ¨`Published date`å’Œ`Number of subscribers`åˆ°**åˆ—**å’Œ**è¡Œ**è´§æ¶ã€‚*

*é»˜è®¤æƒ…å†µä¸‹ï¼ŒTableau å°†æ•°æ®å’Œæ—¶é—´å˜é‡èšåˆåˆ°å¹´ä»½ã€‚å› æ­¤ï¼Œæ‚¨éœ€è¦æŒ‰å¤©æ±‡æ€»`published date`,å› ä¸ºæˆ‘ä»¬å¸Œæœ›çœ‹åˆ°æŸä¸ªç‰¹å®šæ—¥æœŸçš„å…³ç³»ã€‚*

*æ¥ä¸‹æ¥ï¼Œå³é”®å•å‡»**åˆ—**æ¶ä¸­çš„`Published date`ï¼Œå¹¶å•å‡»`select Day`ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚*

*![](img/265c3f9c0329b9a1e542ce27635dfdcb.png)*

*æ•£ç‚¹å›¾(ä½œè€… gif)*

*åœ¨**æ ‡è®°**å¡ä¸Šé€‰æ‹©**åœ†**ç„¶åæ‹–åŠ¨`Title`å˜é‡åˆ°**æ ‡è®°**ã€‚è¿™å°†æ˜¾ç¤ºå›¾è¡¨ä¸­æ¯ä¸ªåœ†åœˆçš„é¢‘é“åç§°ã€‚*

## *ä»ªè¡¨æ¿åˆ›å»º*

*ç°åœ¨è¿›ä¸€æ­¥åˆ›å»ºä¸€ä¸ªåŒ…å«ä¸¤ä¸ªæ„å»ºå›¾è¡¨çš„ä»ªè¡¨æ¿ã€‚*

*ç‚¹å‡»èœå•æ ä¸Šçš„**ä»ªè¡¨ç›˜>æ–°å»ºä»ªè¡¨ç›˜**ã€‚
ç„¶åå°†æ¡å½¢å›¾æ‹–åˆ°ä»ªè¡¨æ¿çš„å³ä¾§é¢æ¿ï¼Œå°†æ•£ç‚¹å›¾æ‹–åˆ°å·¦ä¾§é¢æ¿ã€‚
ç„¶åé€‰æ‹©**å°ºå¯¸**ä¸º**è‡ªåŠ¨**ã€‚
è¦æ·»åŠ æ ‡é¢˜ï¼Œå³å‡»é¡¶éƒ¨èœå•æ ä¸­çš„ä»ªè¡¨æ¿ï¼Œå¹¶é€‰æ‹©`show title`ã€‚ä»é‚£é‡Œï¼Œæ‚¨å¯ä»¥åˆ é™¤æ ‡é¢˜ï¼Œå¹¶æ ¹æ®æ‚¨å–œæ¬¢çš„æ ‡é¢˜åç§°é‡æ–°å‘½åã€‚åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†â€œ*æˆ‘æœ€å–œæ¬¢çš„ Youtube å–œå‰§åˆ†æâ€*ã€‚*

*![](img/b3cd7f16f57521dab986df5647736e03.png)*

*ä»ªè¡¨æ¿åˆ›å»º(ä½œè€…å›¾ç‰‡)*

*å®Œæˆåï¼Œç‚¹å‡» **Ctrl + S** ä¿å­˜ Tableau public ä¸Šçš„åˆ†æã€‚ç¡®ä¿æ‚¨å‹¾é€‰äº†æ“ä½œæŒ‰é’®ï¼Œâ€œ ***ä¿æŒæˆ‘çš„æ•°æ®ä¸ Google sheet åŒæ­¥ï¼Œå¹¶åµŒå…¥æˆ‘çš„å‡­æ®ã€‚*** "ç„¶åç‚¹å‡»ä¿å­˜æŒ‰é’®ã€‚*

*![](img/ac02f0c8c90feb08e7dce6502de53ae1.png)*

*YouTube é¢‘é“åˆ†æä»ªè¡¨æ¿(å›¾ç‰‡ç”±ä½œè€…æä¾›)*

*ä½ ç°åœ¨å¯ä»¥æŸ¥çœ‹ä½ æœ€å–œæ¬¢çš„ [YouTuber çš„åˆ†æå›¾ç‰‡](https://public.tableau.com/app/profile/warrie.warrie/viz/YoutubeChannelsAnalytics/Dashboard1?publish=yes)ã€‚
ä½†æ˜¯ï¼Œè¿™å¹¶æ²¡æœ‰ç»“æŸï¼Œå› ä¸ºæ‚¨å¯ä»¥å°è¯•åŸºäºå¯ç”¨æ•°æ®çš„å…¶ä»–ç±»å‹çš„åˆ†æï¼›ä¾‹å¦‚è·Ÿè¸ªæœ€åçš„ä¸Šä¼ æ—¥æœŸæˆ–åˆ†æå…·æœ‰æœ€é«˜è§‚çœ‹æ¬¡æ•°çš„è§†é¢‘ã€‚*

# *ä¸´åˆ«èµ è¨€â€¦*

*æ­å–œä½ ï¼Œä½ ç°åœ¨æœ‰äº†æ¥è‡ªä½ æœ€å–œæ¬¢çš„ YouTube é¢‘é“çš„æ•°æ®ï¼Œå¯ä»¥é€šè¿‡åˆ©ç”¨ apps è„šæœ¬åœ¨ Tableau ä¸ŠæŸ¥çœ‹ã€è·Ÿè¸ªå’Œåˆ†æè¿™äº›æ•°æ®ã€‚ä½ å¯ä»¥åˆ©ç”¨è¿™ä¸ªæƒ³æ³•æ¥è¿½è¸ªä½ æœ€å–œæ¬¢çš„ youtube é¢‘é“çš„å…¶ä»–æ–¹é¢ã€‚å¹¶ä¸”åœ¨ Tableau ä¸­åˆ›å»ºæ›´å¥½æ›´æ¼‚äº®çš„æ•°æ®å¯è§†åŒ–ã€‚æœ¬æ•™ç¨‹ä¸­ä½¿ç”¨çš„æ•°æ®å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°[ï¼Œä»£ç å¯ä»¥åœ¨è¿™é‡Œ](https://docs.google.com/spreadsheets/d/19U338q1Lu4ZqckEjMp5xJt4dOYDq9Y702HfoR_zztwA/edit#gid=0)æ‰¾åˆ°[ã€‚](https://gist.github.com/warrienelly/bdf5a7a436db464f67e5cdb80195a216)*

*è°¢è°¢å¤§å®¶ï¼ğŸ‘‹*

# *å‚è€ƒ*

*   *[https://developers.google.com/apps-script/advanced/youtube](https://developers.google.com/apps-script/advanced/youtube)*
*   *Javascript åº“:[https://developer . Mozilla . org/en-US/docs/Web/JavaScript/Reference/Global _ Objects/Array/map](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map)*
*   *åœ°å›¾å‚è€ƒ:[https://developers . Google . com/apps-script/guides/sheets/functions #ä¼˜åŒ–](https://developers.google.com/apps-script/guides/sheets/functions#optimization)*
*   *[https://developers . Google . com/apps-script/guides/services/authorization](https://developers.google.com/apps-script/guides/services/authorization)*
*   *[https://developers . Google . com/apps-script/guides/triggers/events](https://developers.google.com/apps-script/guides/triggers/events)*