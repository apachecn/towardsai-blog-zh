# å¦‚ä½•ä½¿ stg nns èƒ½å¤Ÿé¢„æµ‹é•¿æœŸå¤šå…ƒæ—¶é—´åºåˆ—æ•°æ®ï¼Ÿ

> åŸæ–‡ï¼š<https://pub.towardsai.net/how-to-make-stgnnscapable-of-forecasting-long-term-multivariate-time-series-data-9fe5efd77fa1?source=collection_archive---------0----------------------->

ä»èƒ½æºåˆ°åŒ»ç–—ä¿å¥ï¼Œæ—¶é—´åºåˆ—é¢„æµ‹(TSF)æ•°æ®åœ¨æ‰€æœ‰è¡Œä¸šä¸­éƒ½è‡³å…³é‡è¦ã€‚ç ”ç©¶äººå‘˜é€šè¿‡å¼€å‘ TFS æ¨¡å‹å–å¾—äº†ä¸€äº›é‡å¤§è¿›å±•ã€‚é€šè¿‡å½»åº•è€ƒè™‘æ—¶é—´åºåˆ—çš„æ¨¡å¼åŠå…¶å…³ç³»ï¼ŒåŸºäºæ•°æ®é›†ä¸­çš„é•¿æœŸä¾èµ–æ€§çš„åˆ†ææ˜¯å¿…é¡»çš„ã€‚è¿™ç¯‡æ–‡ç« æ˜¯å…³äºåœ¨å¦ä¸€ä¸ªæ¨¡å‹çš„åŸºç¡€ä¸Šè®¾è®¡ä¸€ä¸ªæ–°çš„æ¨¡å‹æ¥æ‰§è¡Œé•¿æœŸä¾èµ–å’Œäº§ç”Ÿæ®µçº§è¡¨ç¤ºã€‚è¿™ä¸ªæ¨¡å‹ç«™åœ¨ STEP ä¸Šï¼ŒSTGNN(æ—¶ç©ºå›¾ç¥ç»ç½‘ç»œ)çš„ç¼©å†™+å¢å¼º+é¢„è®­ç»ƒæ¨¡å‹ã€‚

## æ­¥éª¤:

é¦–å…ˆï¼Œä¸è¦æ··æ·†:

*   **æ—¶ç©ºå›¾æ•°æ®=å¤šå…ƒæ—¶é—´åºåˆ—**

è¿™é‡Œï¼Œä½¿ç”¨çš„æ•°æ®*(äº¤é€šæµé‡)*æ˜¯ç”±*ä¼ æ„Ÿå™¨*è®°å½•çš„é“è·¯ä¸Šçš„æ—¶é—´åºåˆ—æ•°æ®ã€‚

![](img/40203229cf9245d034dcb2a4a04a9f95.png)

æ‚¨çœ‹åˆ°ä¸Šé¢å›¾ 1 ä¸­çš„ä¸¤ç§æ¨¡å¼äº†å—ï¼Ÿï¼Ÿ

**å›ç­”**:é‡å¤æ¨¡å¼æœ‰ä¸¤ç§:1ã€‚**æ—¥å¸¸** 2ã€‚**æ¯å‘¨å‘¨æœŸ**

ç¬¬ä¸€ï¼ŒSTGNNs æ˜¯â€œæ—¶ç©ºå›¾ç¥ç»ç½‘ç»œâ€çš„ç¼©å†™ï¼Œç»™é‚£äº›ä¸çŸ¥é“/çŸ¥é“å¾®è–„çš„äººã€‚(ä¸éš¾ï¼Œåªéœ€è¦*Google ä¸€ä¸‹*ï¼›ä¸ºä¸æƒ³æµªè´¹æ—¶é—´æˆ–åˆ†å¿ƒçš„äººæåŠ)

**STGGNNs =åºåˆ—ç½‘ç»œ+å›¾å½¢ç¥ç»ç½‘ç»œ(GNNs)**

æˆ‘ä»¬ä½¿ç”¨ *GNNs* æ¥å¤„ç†æ—¶åºå’Œæ—¶åºæ¨¡å‹ä¹‹é—´çš„å…³ç³»ï¼Œä»¥æŒ‡ç¤ºæ—¶åº*æ¨¡å¼*ã€‚é€šè¿‡è¿™ä¸¤ä¸ªæœ¯è¯­çš„ç»“åˆï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ¡ ***çš„æ°å‡ºæˆæœ*** ã€‚é¡ºä¾¿è¯´ä¸€å¥ï¼Œæ­£å¦‚ç ”ç©¶äººå‘˜æ‰€è¯´ï¼Œæ²¡æœ‰å…è´¹çš„åˆé¤ã€‚è¿™æ„å‘³ç€**å¼ºå¤§çš„æ¨¡å‹**éœ€è¦**å¤æ‚çš„æ¶æ„**ï¼›å› æ­¤(åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹)ï¼Œ**çš„è®¡ç®—æˆæœ¬éšç€è¾“å…¥é•¿åº¦çš„å¢åŠ è€Œå¢åŠ **(*æˆ–*)ã€‚æ­¤å¤–ï¼Œä¸è¦å¿˜è®°æˆ‘ä»¬çš„æ—¶é—´åºåˆ—çš„å¤§å°ï¼Œè¿™é€šå¸¸æ˜¯ç›¸å½“å¯è§‚çš„ã€‚ ***STGNNs*** å’Œå…¶ä»–æ¨¡å‹ä¸€æ ·ï¼Œå¯ä»¥é¢„æµ‹å°çª—å£åšå‡ºé¢„æµ‹ã€‚è¿™ç§ä¾èµ–å°çª—å£çš„èƒ½åŠ›ä½¿å¾—æ¨¡å‹ä¸å¯é ã€‚**

****é—®é¢˜** : 1ã€‚STGNNs ä¸èƒ½æ•è·é•¿æœŸä¾èµ–å…³ç³»ã€‚**

**2.ç¼ºå°‘ä¾èµ–å…³ç³»å›¾ã€‚**

****è§£å†³æ–¹æ¡ˆ**:æ­¥éª¤(STGNN é€šè¿‡å¯æ‰©å±•çš„æ—¶é—´åºåˆ—é¢„è®­ç»ƒå¾—åˆ°å¢å¼º)**

**STGNNs çš„ä¿®æ”¹ç‰ˆæœ¬**

****æ’å›¾**:**

**ä¸¤é¡¹ä¸¾æª:**

****1** ã€‚æå‡º**t å˜å‹å™¨**ï¼Œä¸€ä¸ªåŸºäºå˜å‹å™¨çš„æ¨¡å—ï¼Œå…·æœ‰è‡ªåŠ¨ç¼–ç å™¨(ç¼–ç å™¨-è§£ç å™¨)ç»“æ„ï¼Œä½œä¸ºæ— ç›‘ç£æ¨¡å‹ã€‚è¿™ä¸ªè½¬æ¢å™¨èƒ½å¤Ÿæ•è·é•¿ä¾èµ–å…³ç³»ã€‚**

****2** ã€‚æå‡ºä¸€ä¸ª**å›¾æ¶æ„å­¦ä¹ å™¨**æ¥å­¦ä¹ ä¾èµ–å›¾ã€‚**

**åœ¨æå‡ºè¿™ä¸¤ä¸ªä¹‹åï¼Œæˆ‘ä»¬åªéœ€è¦å°†å®ƒä»¬ç„Šæ¥æˆä¸€ä¸ªè”åˆæ¨¡å‹ï¼Œè¿™å°±æ˜¯æœ€ç»ˆçš„è§£å†³æ–¹æ¡ˆã€‚å°±æ˜¯è¿™æ ·ï¼ï¼å¬èµ·æ¥å¾ˆå®¹æ˜“ï¼Ÿï¼è®©æˆ‘ä»¬å°½å¯èƒ½ä½¿å®ƒä»¬ç®€å•ã€‚ğŸ˜‰**

**è®©æˆ‘ä»¬çœ‹çœ‹æè®®çš„æ¶æ„:**

**![](img/f5c2da3f3ac1e9db39b733de93864462.png)**

**ä»å›¾ 2 ä¸­å¯ä»¥çœ‹å‡ºï¼Œè¯¥æ¨¡å‹åŒ…æ‹¬ä¸¤ä¸ªé˜¶æ®µ:**

****ç¬¬ä¸€é˜¶æ®µ)**é¢„åŸ¹è®­**

**![](img/1631110ba2ff270d834f9b8f3edbe3b9.png)**

**å›¾ 3**

**è¯¥æ–¹æ¡ˆæ˜¯ä¸€ä¸ªå±è”½çš„è‡ªåŠ¨ç¼–ç æ¨¡å‹ï¼Œå®ƒæ˜¯ä¸ºä¾èµ–äºå˜æ¢å—(TSFormer)çš„æ—¶é—´åºåˆ—æ•°æ®è®­ç»ƒçš„ã€‚è¯¥æ¨¡å‹èƒ½å¤Ÿæ•è·é•¿ä¾èµ–å…³ç³»ï¼Œå¹¶äº§ç”ŸåŒ…å«ä¸€äº›æœ‰ä»·å€¼ä¿¡æ¯çš„æ®µçº§è¡¨ç¤ºã€‚**

****ç¬¬äºŒé˜¶æ®µ)**é¢„æµ‹**

**![](img/2d54aa0ce4994a6d4b820e217a423aa3.png)**

**å›¾ 4**

**åœ¨æ­¤é˜¶æ®µï¼Œæ¥è‡ªå‰ä¸€é˜¶æ®µçš„é¢„è®­ç»ƒæ¨¡å‹(å…¶æ•è·é•¿æœŸä¾èµ–æ€§)ç”¨äºä¿®æ”¹ä¸‹æ¸¸ STGNNã€‚æ­¤å¤–ï¼Œè¿˜è®¾è®¡äº†ä¸€ä¸ªç¦»æ•£ç¨€ç–å›¾å­¦ä¹ å™¨ï¼Œä»¥é˜²é¢„å®šä¹‰å›¾ä¸¢å¤±ã€‚**

**å¤§ä½“ä¸Šæˆ‘å°±åšäº†è¿™ä¹ˆå¤šã€‚å› æ­¤ï¼Œè®©æˆ‘ä»¬æ›´æ·±å…¥åœ°äº†è§£è¿™ä¸¤ä¸ªé˜¶æ®µçš„ç»†èŠ‚:**

# **1.è®­ç»ƒå‰é˜¶æ®µ**

**è¿™ç§å°è¯•ï¼Œæˆ‘çš„æ„æ€æ˜¯ä½¿ç”¨é¢„å…ˆè®­ç»ƒçš„æ¨¡å‹ï¼Œæ˜¯ç”±äºåœ¨ NLP é¡¹ç›®ä¸­åº”ç”¨å®ƒä»¬çš„å…´è¶£(å½“ç„¶ï¼Œç»“æœ)çš„å¢åŠ ã€‚è™½ç„¶é¢„è®­ç»ƒæ¨¡å‹åœ¨ NLP(åºåˆ—æ•°æ®)ä¸­è¢«å¹¿æ³›é‡‡ç”¨ï¼Œä½†ä¸æ—¶é—´åºåˆ—æœ‰ä¸€äº›**å·®å¼‚**ã€‚ä½ å¯ä»¥åœ¨æˆ‘ä¹‹å‰çš„æ–‡ç« ä¸­è¯»åˆ°å®ƒçš„å®Œæ•´æè¿°:â€œ [***å¦‚ä½•ä¸ºæ—¶é—´åºåˆ—è®¾è®¡ä¸€ä¸ªé¢„è®­ç»ƒæ¨¡å‹(TSFormer)ï¼Ÿ***](/how-to-design-a-pre-training-model-tsformer-for-time-series-c2a177ebb51d)**

# **2.é¢„æµ‹é˜¶æ®µ**

**è¿™é‡Œçš„è¾“å…¥åˆ†ä¸º ***P* é•¿åº¦**çš„ä¸é‡å é¢ç‰‡***L*ã€‚æˆ‘ä»¬çš„ ***TSFormer*** ä¸ºé¢„æµ‹é˜¶æ®µçš„æ¯ä¸ªè¾“å…¥( **S** i)äº§ç”ŸæŒ‡ç¤ºã€‚**stg ns**çš„ä¸€ä¸ªç‰¹ç‚¹æ˜¯å®ƒä»¬é‡‡ç”¨äº†æœ€æ–°çš„**ã€‚å› æ­¤ï¼Œæ ¹æ®***t å‰*** äº§ç”Ÿçš„æŒ‡ç¤ºï¼Œæˆ‘ä»¬å°†ä¿®æ”¹ **STGNNs** ã€‚**

# **ä»é›¶å¼€å§‹|æµç¨‹**

*   **è¿™ä¸€é˜¶æ®µçš„ç¼–ç å™¨éƒ¨åˆ†ä¸ TSFormer ä¸­çš„ç›¸åŒï¼›è¿™é‡Œä¸æä¾›å¯¹å®ƒçš„æè¿°ï¼Œä»¥å…è¿™ç¯‡æ–‡ç« å¤ªé•¿ã€‚æƒ³äº†è§£è¯¦æƒ…å¯ä»¥çœ‹æˆ‘å®Œæ•´æ¼”ç¤ºè¿‡çš„å¦ä¸€ç¯‡æ–‡ç« ( [*)å¦‚ä½•ä¸ºæ—¶é—´åºåˆ—è®¾è®¡ä¸€ä¸ªé¢„è®­ç»ƒæ¨¡å‹(TSFormer)ï¼Ÿ*](/how-to-design-a-pre-training-model-tsformer-for-time-series-c2a177ebb51d) )ã€‚**

## **å›¾å½¢å­¦ä¹ çš„ç»“æ„**

****é—®é¢˜)**å¤§å¤šæ•°å›¾ä¾èµ–**ä¸€ä¸ªé¢„å®šä¹‰çš„å›¾**å°±æ˜¯**ä¸å¯ç”¨**æˆ–è€…**ä¸å¤Ÿå¥½**å¤§å¤šæ•°æƒ…å†µä¸‹â€”â€”è¿˜æœ‰ï¼Œ**æ··åˆ****å­¦ä¹ **çš„**æ–¹å¼(æ±‚èŠ‚ç‚¹ä¹‹é—´çš„å…³ç³»(å¯¹äº *exã€‚****I****å’Œ *j* )çš„æ—¶åºå’Œ **STGNNs** å¯¼è‡´**æå¤§çš„å¤æ‚æ€§**ã€‚*****

****è§£å†³æ–¹æ¡ˆ)**é¢„åŸ¹è®­çš„ TSFormer**

****è§£é‡Š)**æå‡º**ä¸€ä¸ªç¦»æ•£ç¨€ç–å›¾**ã€‚æ€ä¹ˆä¼šï¼Ÿ **1ã€‚å›¾å½¢è§„åˆ™åŒ–**åˆ°*æ‹Ÿåˆ* **ç›‘ç£ä¿¡æ¯**ã€‚ **2ã€‚ä¸€ä¸ª KNN å›¾**åˆ°*ç¼°*çš„**ç¨€ç–åº¦**ã€‚å…¶é…æ–¹æ€»ç»“å¦‚ä¸‹:**

**![](img/daf45f89cbcd84ca0aaf1996a83f5ff3.png)**

## **ä¸‹æ¸¸æ—¶ç©ºå›¾ç¥ç»ç½‘ç»œ**

****é—®é¢˜** ) **å¸¸ç”¨è¡¥ä¸** **è¾“å…¥** : **æœ€åè¡¥ä¸** + **ä¾èµ–å›¾****

****è§£** ) **æ­¥éª¤**(å°†è¾“å…¥é¢ç‰‡çš„è¡¨ç¤ºæ·»åŠ åˆ°è¾“å…¥)**

****è§£è¯»**)æ­£å¦‚æˆ‘ä»¬åœ¨æˆ‘ä¹‹å‰çš„æ–‡ç« ã€Š [***å¦‚ä½•ä¸ºæ—¶é—´åºåˆ—è®¾è®¡ä¸€ä¸ªé¢„è®­ç»ƒæ¨¡å‹(TSFormer)ï¼Ÿ***](/how-to-design-a-pre-training-model-tsformer-for-time-series-c2a177ebb51d) â€ï¼Œ**t former**æ•æ‰**long-dependencies**ï¼›å› æ­¤ï¼Œå®ƒä½¿å¾— **H åœ¨**ä¿¡æ¯**æ–¹é¢æ›´åŠ ä¸°å¯Œ**ã€‚æ­¤å¤–ï¼ŒWaveNet è¢«é€‰ä¸ºæˆ‘ä»¬çš„**åç«¯ï¼Œ**å®ƒæœ‰åŠ©äºæ­£ç¡®æ•è·å¤šå…ƒæ—¶é—´åºåˆ—ã€‚*ä½†æ˜¯å¦‚ä½•ï¼Ÿï¼Ÿ*å®ƒå°†**å›¾å½¢å·ç§¯**ä¸**æ‰©å¼ å·ç§¯**æ··åˆã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„**é¢„æµ‹**å¾—åˆ°äº† **WaveNet çš„è¾“å‡ºæ½œåœ¨çš„ã€éšè—çš„è¡¨ç¤º**çš„æ”¯æŒã€‚*å¦‚ä½•ï¼Ÿï¼Ÿ*é€šè¿‡ä½¿ç”¨ **MLP** ã€‚**

****Q)** å¦‚æœä½ è§‚å¯Ÿé¢„æµ‹é˜¶æ®µæ¶æ„ï¼Œä½ ä¼šçœ‹åˆ°**ä¸¤ä¸ªæµ**è¿›å…¥ ***æ—¶ç©ºå›¾ NN å—*** ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•åº”å¯¹å‘¢ï¼Ÿ**

****A)** é€šè¿‡ä½¿ç”¨ Eq7:**

**![](img/ce6b87d15e29565d86db6878e8f62d41.png)**

**æœ€åï¼ŒMLP åšå‡ºäº†é¢„æµ‹:**

**![](img/1b1023485a98e200aeae55a3a0e5f683.png)**

**ä¸‹æ¸¸ STGNN çš„è¾“å‡º:**

**![](img/bef370523e0be8ac12cf9979f4364e6e.png)**

> **è¿™æ¬¡ STGNN ä¿®æ”¹åˆ°æ­¤ç»“æŸã€‚å¸Œæœ›ä½ å–œæ¬¢ã€‚å…¶ä½™çš„æ˜¯çœŸå®ä¸–ç•Œæ•°æ®é›†ä¸Šçš„ç»“æœã€‚**

## **ç»“æœ:**

## ****æ•°æ®:****

**è¯¥æ¨¡å‹åœ¨ç¾å›½ä¸‰ä¸ªåœ°åŒºçš„ä¸‰ä¸ªäº¤é€šé€Ÿåº¦æ•°æ®é›†ä¸Šè¿›è¡Œè®­ç»ƒ:**

1.  ****METR-æ‹‰****
2.  ****PEMS æ¹¾****
3.  ****PEMS04****

**![](img/e380c7ec551e80d77445d038cf0b749c.png)**

**è¡¨ 1ã€‚æ•°æ®é›†çš„ç»Ÿè®¡**

## **æŒ‡æ ‡:**

1.  ****MAE ( *å¹³å‡ç»å¯¹è¯¯å·®* )****
2.  ****RMSE ( *å‡æ–¹æ ¹ç»å¯¹è¯¯å·®* )****
3.  ****MAPE ( *å¹³å‡ç»å¯¹ç™¾åˆ†æ¯”è¯¯å·®* )****

**![](img/939c0c9b6b81fa072f13a4e732f6ddfe.png)**

# **ç»“æŸäº†**

> ***å‡ºå¤„æ˜¯* [*æœ¬*](https://ui.adsabs.harvard.edu/abs/2022arXiv220609113S/abstract) *ã€‚***
> 
> ***ä½ å¯ä»¥* ***è”ç³»*** *æˆ‘ä¸Š* ***æ¨ç‰¹*** [è¿™é‡Œ](https://twitter.com/reza__yazdanfar) *æˆ–è€…****LinkedIn***[è¿™é‡Œ](http://www.linkedin.com/in/rezayazdanfar) *ã€‚æœ€åï¼Œå¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰è¶£åˆæœ‰ç”¨ï¼Œå¯ä»¥* ***å…³æ³¨*** *æˆ‘ä¸Š* ***ä¸­*** *è·å–æ›´å¤šæ¥è‡ªæˆ‘çš„æ–‡ç« ã€‚***