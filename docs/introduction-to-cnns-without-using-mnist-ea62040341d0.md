# CNN ç®€ä»‹â€”â€”ä¸ä½¿ç”¨ MNISTï¼

> åŸæ–‡ï¼š<https://pub.towardsai.net/introduction-to-cnns-without-using-mnist-ea62040341d0?source=collection_archive---------2----------------------->

## [è®¡ç®—æœºè§†è§‰](https://towardsai.net/p/category/computer-vision)ï¼Œ[æ·±åº¦å­¦ä¹ ](https://towardsai.net/p/category/machine-learning/deep-learning)

## CNN ç®€ä»‹ï¼Œä¸ºæ·±åº¦å­¦ä¹ çš„åˆå­¦è€…æä¾›æ˜“äºè®¿é—®çš„æ•°æ®é›†ã€‚

![](img/f233683867007dac73db061898d4aea5.png)

[æ¥æº](https://quickdraw.withgoogle.com)

# ä»‹ç»ğŸµ

MNIST æ•°æ®é›†æ˜¯å¼€å§‹å½±åƒåˆ†ç±»æ—¶ä½¿ç”¨æœ€é¢‘ç¹çš„æ•°æ®é›†ã€‚Yann LeCun åœ¨ 1998 å¹´å¼•å…¥çš„ç”± 10 ç±»æ‰‹å†™æ•°å­—ç»„æˆçš„ MNIST æ•°æ®é›†åœ¨ç§‘å­¦è®ºæ–‡ã€åšå®¢å¸–å­ç­‰ä¸­åå¤å‡ºç°ã€‚å®ƒåŒ…å«æ‰‹å†™æ•°å­—çš„ 28Ã—28(ä¹Ÿæ˜¯ 32Ã—32)ç°åº¦å›¾åƒï¼Œæ¯ä¸ªå›¾åƒåŒ…å« 0 åˆ° 9 ä¹‹é—´çš„æ•´æ•°ã€‚

MNIST å¦‚æ­¤å—æ¬¢è¿çš„åŸå› ä¸å…¶è§„æ¨¡æœ‰å…³ï¼Œå®ƒå…è®¸æ·±åº¦å­¦ä¹ å®è·µè€…å¿«é€Ÿæ£€æŸ¥ã€è®­ç»ƒå’Œå‘å¸ƒä»–ä»¬çš„ç®—æ³•ã€‚MNIST æœ‰ä¸€å®šçš„å˜åŒ–å’Œå±€é™æ€§ã€‚

ä¸»è¦ç›®æ ‡æ˜¯æå‡ºä¸€ä¸ªæ–°çš„æ•°æ®é›†æ¥ç†è§£ä½¿ç”¨ CNN çš„å›¾åƒåˆ†ç±»ã€‚

# å¦‚æœä¸æ˜¯ MNISTï¼Œé‚£æ˜¯ä»€ä¹ˆï¼ŸğŸ¤”

å‡ºäºç®€å•è§£é‡Šçš„ç›®çš„ï¼Œæˆ‘é€‰æ‹©äº†è°·æ­Œçš„å¿«é€Ÿç»˜åˆ¶å›¾åƒã€‚è¿™äº›å›¾åƒæ˜¯åœ¨äººå·¥æ™ºèƒ½å®éªŒä¸­ç”Ÿæˆçš„æ¶‚é¸¦ã€‚

ä»è¿™ä¸ªè§†é¢‘ä¸­äº†è§£æ›´å¤šå…³äºæ•°æ®é›†çš„ä¿¡æ¯ï¼Œ

[è°·æ­Œäº‘å¹³å°](https://www.youtube.com/channel/UCJS9pqu9BzkAMNTmzNMNhvg)

ä½ ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œè‡ªå·±å°è¯•å¿«é€Ÿç»˜å›¾ï¼Œ

[](https://quickdraw.withgoogle.com) [## å¿«ï¼Œç”»ï¼

### è¿™æ˜¯ä¸€ä¸ªç”¨æœºå™¨å­¦ä¹ æ„å»ºçš„æ¸¸æˆã€‚ä½ ç”»ç”»ï¼Œç¥ç»ç½‘ç»œè¯•å›¾çŒœæµ‹ä½ åœ¨ç”»ä»€ä¹ˆã€‚çš„â€¦

quickdraw.withgoogle.com](https://quickdraw.withgoogle.com) 

æ•°æ®è¢«æ ¼å¼åŒ–æˆå„ç§ç±»å‹ã€‚æˆ‘ç”¨è¿‡ NumPy ç‰ˆæœ¬(ã€‚npy æ–‡ä»¶)ã€‚è¿™äº›å·²è¢«æ¸²æŸ“æˆ NumPy æ ¼å¼çš„ 28x28 ç°åº¦ä½å›¾ã€‚é€šè¿‡ä¸‹é¢åˆ†äº«çš„æ–‡æ¡£äº†è§£æ›´å¤šä¿¡æ¯ï¼Œ

[](https://github.com/googlecreativelab/quickdraw-dataset) [## Google creative lab/quick draw-dataset

### å¿«é€ŸæŠ½å¥–æ•°æ®é›†æ˜¯ç”±æ¸¸æˆç©å®¶æä¾›çš„ 345 ä¸ªç±»åˆ«çš„ 5000 ä¸‡å¼ å›¾ç‰‡çš„é›†åˆâ€¦

github.com](https://github.com/googlecreativelab/quickdraw-dataset) 

# ğŸ§ä½¿ç”¨çš„å›¾åƒå’Œç±»åˆ«

æ•°æ®é›†å¾ˆå¤§ï¼Œç±»åˆ«ä¹Ÿå¾ˆå¹¿ã€‚ä¸ºäº†æ¼”ç¤ºçš„ç›®çš„ï¼Œæˆ‘ä½¿ç”¨äº† **10 ä¸ªç±»**å’Œå¤§çº¦ **60ï¼Œ000 å¼ å›¾ç‰‡**ã€‚æœ¬æ¥æ•°æ®é›†å°±å¾ˆå¤§ã€‚å¦‚æœæ‚¨ä½¿ç”¨ Colabï¼Œé‚£ä¹ˆå®ƒå¯èƒ½ä¼šåœ¨æ‰§è¡Œæ“ä½œæ—¶å´©æºƒã€‚ä»¥ä¸‹æ˜¯æ‰€è€ƒè™‘çš„ 10 ä¸ªç±»åˆ«çš„ç›´è§‚è¡¨ç¤ºã€‚

![](img/d008e804c7a060b012bb03354c15bda3.png)

æ¥æº: [Jupyter ç¬”è®°æœ¬](https://github.com/pr2tik1/blog/blob/master/_notebooks/2020-09-08-Sketch-Recognition.ipynb)

è¿™äº›ç±»åˆ«æ˜¯:

```
'cloud', 'sun', 'pants', 'umbrella', 'table', 'ladder', 'eyeglasses', 'clock', 'scissors', 'cup'
```

æˆ‘å°†åˆ†äº«å®Œæ•´çš„ä»£ç å’Œè„šæœ¬ï¼Œä»¥æ”¹å˜å›¾åƒå’Œç±»çš„æ•°é‡ã€‚è¯·åœ¨è¿™ç¯‡æ–‡ç« çš„ç»“å°¾æ‰¾åˆ°å®ƒã€‚

æ‚¨å¯èƒ½ä¼šæ³¨æ„åˆ°ï¼Œè¿™ä¸ MNIST çš„æ•°æ®æœ‰äº›ç›¸ä¼¼ï¼Œ

*   å®ƒæœ‰ç°åº¦å›¾åƒ(æ²¡æœ‰ RGB é€šé“)
*   28 x 28 å°ºå¯¸çš„å›¾åƒ
*   å®ƒæœ‰ 10 ä¸ªç­çº§ï¼Œè€Œ MNIST æœ‰ 0-9 ä¸ªç­çº§ã€‚

# å·ç§¯ç¥ç»ç½‘ç»œğŸ’ª

ä¸ä¼ ç»Ÿçš„çº¿æ€§å’Œéçº¿æ€§åˆ†ç±»ç®—æ³•ç›¸æ¯”, **CNN** åœ¨å›¾åƒåˆ†ç±»ä¸­äº§ç”Ÿæ›´å¥½çš„ç»“æœã€‚è¿™æ˜¯å› ä¸ºå®ƒä»¬å‡å°‘äº†è¦å­¦ä¹ çš„å‚æ•°æ•°é‡ã€‚

CNN ä½¿ç”¨å›¾åƒå’Œæ»¤æ³¢å™¨çš„å·ç§¯æ¥æå–æ¯ä¸€å±‚çš„å¤æ‚ä¸å˜ç‰¹å¾ã€‚æå–çš„ç‰¹å¾çš„å¤æ‚æ€§éšç€å±‚çš„æ·±åº¦è€Œå¢åŠ ã€‚å®ƒä»¬æˆåŠŸåœ°æ•æ‰äº†å›¾åƒä¸­çš„ç©ºé—´å’Œæ—¶é—´ç›¸å…³æ€§ã€‚

ç‰¹å¾çš„å¤æ‚æ€§â€”

*   ç¬¬ 1 å±‚:è¾¹ç¼˜
*   ç¬¬ 2 å±‚:å½¢çŠ¶
*   ç¬¬ä¸‰å±‚:å½¢çŠ¶å›¾æ¡ˆ
*   â€¦.
*   è¾“å‡º

è¦äº†è§£æ›´å¤šå…³äºå„å±‚ä¹‹é—´å®é™…å‘ç”Ÿçš„æƒ…å†µï¼Œ

[](https://distill.pub/2018/building-blocks/) [## å¯è§£é‡Šæ€§çš„åŸºçŸ³

### éšç€ç¥ç»ç½‘ç»œçš„æ—¥ç›ŠæˆåŠŸï¼Œç›¸åº”åœ°éœ€è¦èƒ½å¤Ÿè§£é‡Šå®ƒä»¬çš„å†³å®šâ€¦

è’¸é¦. pub](https://distill.pub/2018/building-blocks/) 

# ğŸ› æœ‰çº¿ç”µè§†æ–°é—»ç½‘çš„ç»„æˆéƒ¨åˆ†

ä»¥ä¸‹æ˜¯å·ç§¯ç¥ç»ç½‘ç»œçš„ç‰¹å¾ï¼Œ

## 1.å›æ—‹

![](img/334265920b1b81953d91ddf6e2d908cd.png)

[ä¸€ä¸ªæ ‡å‡†å·ç§¯](https://arxiv.org/abs/1603.07285)

å·ç§¯æ˜¯ä¸€ç§çŸ©é˜µè¿ç®—ï¼Œç”±ä¸€ä¸ªæ ¸(ä¸€ä¸ªå°çš„æƒé‡çŸ©é˜µ)ç»„æˆï¼Œå®ƒåœ¨è¾“å…¥æ•°æ®ä¸Šæ»‘åŠ¨ï¼Œä¸è¾“å…¥æ•°æ®æ‰€åœ¨çš„éƒ¨åˆ†æ‰§è¡Œé€å…ƒç´ ä¹˜æ³•ï¼Œç„¶åå°†ç»“æœç›¸åŠ å¾—åˆ°ä¸€ä¸ªè¾“å‡ºã€‚

è¿™äº›åŸºæœ¬ä¸Šæ˜¯åˆå¹¶ä¸¤ç»„ä¿¡æ¯ã€‚æ•°å­¦ä¸Šï¼Œå·ç§¯æ˜¯æŒ‡ä¸¤ä¸ªå‡½æ•°çš„ç»„åˆäº§ç”Ÿç¬¬ä¸‰ä¸ªå‡½æ•°ã€‚åœ¨ CNN çš„æƒ…å†µä¸‹ï¼Œå·ç§¯æ˜¯å°†æ»¤æ³¢å™¨/å†…æ ¸åº”ç”¨äºè¾“å…¥å›¾åƒï¼Œå¯¼è‡´æ¿€æ´»ã€‚

## 2.è”è¥

æ± å›¾å±‚é€šè¿‡æ±‡æ€»è¦ç´ åœ°å›¾çš„å›¾ç‰‡ä¸­è¦ç´ çš„å­˜åœ¨æƒ…å†µï¼Œæä¾›äº†ä¸€ç§å¯¹è¦ç´ åœ°å›¾è¿›è¡Œç¼©å‡é‡‡æ ·çš„æ–¹æ³•ã€‚ä¸¤ç§å¸¸è§çš„è”è¥æ–¹æ³•æ˜¯å¹³å‡è”è¥å’Œæœ€å¤§è”è¥ã€‚

![](img/7ff48c0374b4c87540619dd4203b7dcb.png)

[T5ã€æœ€å¤§æ± ã€‘å’Œ CNNT7ã€å¹³å‡æ± ã€‘](https://arxiv.org/abs/1603.07285)

# PyTorch å®ç°ğŸ’»

ç¼–ç éƒ¨åˆ†ä½¿ç”¨ PyTorch å®Œæˆã€‚å®ƒå¯ä»¥åˆ†ä¸º:

*   å®šä¹‰æ¨¡å‹
*   å®šä¹‰è¶…å‚æ•°
*   åŸ¹è®­å’Œæµ‹è¯•

## 1.å®šä¹‰æ¨¡å‹

æˆ‘ä»¬ä½¿ç”¨ PyTorch çš„ NN æ¨¡å—å®šä¹‰ä¸€ä¸ªæ¨¡å‹æˆ– CNN æ¶æ„ã€‚ä»¥ä¸‹æ˜¯å…·æœ‰ä¸¤ä¸ªå·ç§¯å±‚å’Œä¸¤ä¸ªå…¨è¿æ¥å±‚çš„ç¥ç»ç½‘ç»œæ¶æ„ã€‚

```
**class** **CNN(**nn**.**Module**):**
    **def** __init__**(***self***,** input_size**,** n_feature**,** output_size**):**
        *super***(**CNN**,** *self***).**__init__**()**
        *self***.**n_feature **=** n_feature
        *self***.**conv1 **=** nn**.**Conv2d**(**in_channels**=**1**,** 
                               out_channels**=**n_feature**,** 
                               kernel_size**=**5**)**
        *self***.**conv2 **=** nn**.**Conv2d**(**n_feature**,** n_feature**,** kernel_size**=**5**)**
        *self***.**fc1 **=** nn**.**Linear**(**n_feature*****4*****4**,** 50**)**
        *self***.**fc2 **=** nn**.**Linear**(**50**,** 10**)**

    **def** **forward(***self***,** x**,** verbose**=False):**
        x **=** F**.**relu**(***self***.**conv1**(**x**))**
        x **=** F**.**max_pool2d**(**x**,** kernel_size**=**2**)**
        x **=** F**.**relu**(***self***.**conv2**(**x**))**
        x **=** F**.**max_pool2d**(**x**,** kernel_size**=**2**)**
        x **=** x**.**view**(-**1**,** *self***.**n_feature*****4*****4**)**
        x **=** F**.**relu**(***self***.**fc1**(**x**))**
        x **=** F**.**log_softmax**(**x**,** dim**=**1**)**
        **return** x
```

## 2.å®šä¹‰è¶…å‚æ•°

é‡‡ç”¨çš„æ¨¡å‹å°ºå¯¸å–å†³äºæ‰€è€ƒè™‘çš„è¾“å…¥å’Œè¾“å‡ºã€‚CNN å°†æŠŠ 784(= 28x28)ä½œä¸ºè¾“å…¥ï¼Œå¹¶äº§ç”Ÿ 10 ä¸ªç±»ã€‚

æˆ‘é€‰æ‹©çš„æŸå¤±å‡½æ•°æ˜¯è´Ÿå¯¹æ•°ä¼¼ç„¶æŸå¤±ã€‚ä¼˜åŒ–å‡½æ•°æ˜¯éšæœºæ¢¯åº¦ä¸‹é™ã€‚è¿™å°†æ›´æ–°æˆ‘ä»¬ç½‘ç»œçš„æƒé‡å’Œåå¥½ã€‚æˆ‘æŠŠå­¦ä¹ ç‡è®¾ä¸º 0.03ï¼ŒåŠ¨é‡è®¾ä¸º 0.9ã€‚

```
model **=** CNN**(**784**,** 24**,** 10**)**
model **=** model**.**to**(**device**)**

*#Loss criterian*
criterion **=** nn**.**NLLLoss**()**

*#Optimization Function/Weights and Bias Updating Rule*
optimizer **=** optim**.**SGD**(**model**.**parameters**(),** lr**=**0.03**,** momentum**=**0.9**)**
```

## 3.åŸ¹è®­å’Œæµ‹è¯•

å¦‚éœ€åŸ¹è®­å’Œæµ‹è¯•ï¼Œè¯·å…³æ³¨ä»¥ä¸‹åˆ†äº«çš„åšå®¢å¸–å­ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘å¯¹ç½‘ç»œè¿›è¡Œäº†è®­ç»ƒå’Œæµ‹è¯•ã€‚è¿™æ˜¯æˆ‘çš„ä¸ªäººåšå®¢ç½‘ç«™ï¼Œåœ¨è¿™é‡Œæˆ‘åˆ†äº«äº†å®Œæ•´çš„ä»£ç å’Œ Jupyter ç¬”è®°æœ¬ã€‚æ­¤å¤–ï¼Œæˆ‘è¿˜æ¢ç´¢äº†é™ç»´æŠ€æœ¯ã€‚

æˆ‘çš„ç½‘ç»œè¿è¡Œè‰¯å¥½ï¼Œå‡†ç¡®ç‡ä¸º 96.7%ï¼ŒæŸè€—ä¸º 0.122%ï¼ŒT2 ä¸º 0.3%ã€‚æ‚¨è¿˜å¯ä»¥é€šè¿‡ Colab è¿è¡Œå¹¶æµ‹è¯•è‡ªå·±çš„å®ç°ã€‚

[](https://pr2tik1.github.io/blog/pytorch/cnn/pca/t-sne/2020/09/08/Sketch-Recognition.html) [## åŸºäº PyTorch çš„æ¶‚é¸¦å›¾åƒåˆ†ç±»

### åœ¨è¿™æœ¬ç¬”è®°æœ¬ä¸­ï¼Œæˆ‘å®ç°äº† LeNet-5 çš„ä¿®æ”¹ç‰ˆæœ¬ï¼Œè¿™æ˜¯ä¸€ä¸ªç¥ç»ç½‘ç»œæ¨¡å‹ï¼ŒåŒ…æ‹¬â€¦

pr2tik1.github.io](https://pr2tik1.github.io/blog/pytorch/cnn/pca/t-sne/2020/09/08/Sketch-Recognition.html) 

# èµ„æºå’Œå‚è€ƒèµ„æ–™ğŸ“š

1.  [CS231n](https://cs231n.github.io)
2.  [Jupyter ç¬”è®°æœ¬](https://github.com/pr2tik1/blog/blob/master/_notebooks/2020-09-08-Sketch-Recognition.ipynb) â€”ä»£ç 
3.  [åšæ–‡](https://pr2tik1.github.io/blog/pytorch/cnn/pca/t-sne/2020/09/08/Sketch-Recognition.html) â€”æ¶‚é¸¦å›¾ç‰‡åˆ†ç±»å®Œæ•´è¯´æ˜ã€‚

# è°¢è°¢å¤§å®¶ï¼ğŸ˜‡

![](img/638a07dd0a1bdcb76085d9d56758d127.png)

ç…§ç‰‡ç”± [Niclas Illg](https://unsplash.com/@nicklbaert?utm_source=medium&utm_medium=referral) åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„

å¸Œæœ›ä½ å–œæ¬¢ã€‚è°¢è°¢ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« ï¼è¯·åŠ¡å¿…æ£€æŸ¥ä¸Šé¢å…±äº«çš„å­˜å‚¨åº“ï¼Œå¦‚æœéœ€è¦è§£é‡Šï¼Œè¯·è”ç³»ã€‚è¦äº†è§£æ›´å¤šå…³äºæˆ‘çš„ä¿¡æ¯ï¼Œè¯·è®¿é—®æˆ‘çš„æŠ•èµ„ç»„åˆç½‘ç«™[è¿™é‡Œã€‚](https://pr2tik1.github.io)

æ€»ä¹‹ï¼Œæˆ‘ä»¬å·²ç»ç ”ç©¶äº† CNN åŠå…¶å®ç°ã€‚æ­¤å¤–ï¼Œæ‚¨å¯ä»¥æ¢ç´¢èƒ¶å›Šç½‘ç»œå’Œ rnnã€‚

ä½ ä¹Ÿå¯ä»¥å…³æ³¨æˆ‘åˆ†äº«çš„åšæ–‡ï¼Œåœ¨é‚£é‡Œæˆ‘ä¹Ÿç ”ç©¶äº† t-SNE å’Œ PCA å¯¹è¿™äº›æ•°æ®çš„è¡¨ç¤ºã€‚å¦‚æœä½ å¯¹è¿™ç¯‡æ–‡ç« æœ‰ä»»ä½•ç–‘é—®ï¼Œè¯·éšæ—¶è”ç³»æˆ‘ã€‚

***è°¢è°¢ï¼***

# æ›´å¤šæ¥è‡ªä½œè€…:

[](https://towardsdatascience.com/understanding-kaplan-meier-estimator-68258e26a3e4) [## äº†è§£å¡æ™®å…°-è¿ˆè€¶ä¼°è®¡é‡

### ä¸€ç§ç”Ÿå­˜åˆ†ææŠ€æœ¯çš„ä»‹ç»ã€‚

towardsdatascience.com](https://towardsdatascience.com/understanding-kaplan-meier-estimator-68258e26a3e4) [](https://pr2tik1.medium.com/what-happens-to-programmers-in-2020-d04a6bd7452f) [## å¼€å‘è€…è¶‹åŠ¿

### æ ¹æ®è°ƒæŸ¥æ•°æ®åˆ†æå¼€å‘äººå‘˜å’Œç¼–ç¨‹è¶‹åŠ¿ã€‚

pr2tik1.medium.com](https://pr2tik1.medium.com/what-happens-to-programmers-in-2020-d04a6bd7452f) [](https://medium.com/towards-artificial-intelligence/neural-networks-from-scratch-a-brief-introduction-for-beginners-d3776599aaac) [## æ¢ç´¢ç¥ç»ç½‘ç»œ(ç¬¬ä¸€éƒ¨åˆ†)

### ç†è§£æ·±åº¦å­¦ä¹ çš„æ¦‚å¿µä»¥åŠä½¿ç”¨ Python å’Œå®ƒçš„ç¥ç»ç½‘ç»œçš„å®ç°â€¦

medium.com](https://medium.com/towards-artificial-intelligence/neural-networks-from-scratch-a-brief-introduction-for-beginners-d3776599aaac) [](https://towardsdatascience.com/explore-new-github-readme-feature-7d5cc21bf02f) [## å¦‚ä½•åˆ›å»ºä»¤äººæ•¬ç•çš„ Github ä¸ªäººèµ„æ–™-è‡ªè¿°æ–‡ä»¶ï¼

### æ¢ç´¢å±•ç¤ºä½ ä½œä¸ºå¼€å‘è€…æˆ–å¼€æºè´¡çŒ®è€…çš„â€œGitHub ç®€å†â€çš„æ–°æ–¹æ³•ã€‚æ¯ä¸€ä¸ªå¼€æºâ€¦

towardsdatascience.com](https://towardsdatascience.com/explore-new-github-readme-feature-7d5cc21bf02f)