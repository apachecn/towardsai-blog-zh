# NTM:ç¥ç»å›¾çµæœº

> åŸæ–‡ï¼š<https://pub.towardsai.net/neural-turing-machines-eaada7e7a6cc?source=collection_archive---------0----------------------->

## ç¥ç»å›¾çµæœºçš„è¯¦ç»†èµ°æŸ¥

![](img/5c9301986551bb40648d0b169870bf90.png)

ç”± [Unsplash](https://unsplash.com/s/photos/technology?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) ä¸Šçš„ [Kvistholt æ‘„å½±](https://unsplash.com/@freeche?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)æ‹æ‘„

# ä»‹ç»

æˆ‘ä»¬è®¨è®ºç¥ç»å›¾çµæœº(NTM)ï¼Œä¸€ç§ç”± Graves ç­‰äººåœ¨ DeepMind ä¸­æå‡ºçš„æ¶æ„ã€‚ntm æ—¨åœ¨è§£å†³éœ€è¦å‘å¤–éƒ¨å­˜å‚¨å™¨å†™å…¥ä¿¡æ¯å’Œä»å¤–éƒ¨å­˜å‚¨å™¨æ£€ç´¢ä¿¡æ¯çš„ä»»åŠ¡ï¼Œè¿™ä½¿å…¶ç±»ä¼¼äºå·¥ä½œè®°å¿†ç³»ç»Ÿï¼Œå¯ä»¥é€šè¿‡ä¿¡æ¯çš„çŸ­æœŸå­˜å‚¨(è®°å¿†)åŠå…¶åŸºäºè§„åˆ™çš„æ“ä½œæ¥æè¿°ã€‚ä¸å…·æœ‰å†…éƒ¨å­˜å‚¨å™¨çš„ RNN ç»“æ„ç›¸æ¯”ï¼Œntm åˆ©ç”¨æ³¨æ„æœºåˆ¶æ¥é«˜æ•ˆåœ°è¯»å†™å¤–éƒ¨å­˜å‚¨å™¨ï¼Œè¿™ä½¿å¾—å®ƒä»¬æˆä¸ºæ•è·é•¿ç¨‹ç›¸å…³æ€§çš„æ›´æœ‰åˆ©çš„é€‰æ‹©ã€‚ä½†æ˜¯ï¼Œæ­£å¦‚æˆ‘ä»¬å°†çœ‹åˆ°çš„ï¼Œè¿™ä¸¤è€…å¹¶ä¸æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œå¯ä»¥ç»“åˆèµ·æ¥å½¢æˆä¸€ä¸ªæ›´å¼ºå¤§çš„ä½“ç³»ç»“æ„ã€‚

# ç¥ç»å›¾çµæœº

![](img/02bdb85d480f585eef3dde7d2ad41a2b.png)

èµ„æ–™æ¥æº:äºšå†å…‹æ–¯Â·æ ¼é›·å¤«æ–¯ã€æ ¼é›·æ ¼Â·éŸ¦æ©å’Œä¼Šæ²ƒÂ·è¾¾å°¼åŸƒå°”å¡ã€‚2014.â€œç¥ç»å›¾çµæœºâ€

NTM çš„æ•´ä½“æ¶æ„å¦‚å›¾ 1 æ‰€ç¤ºï¼Œå…¶ä¸­*æ§åˆ¶å™¨*æ˜¯ä¸€ä¸ªæ™®é€šçš„ç¥ç»ç½‘ç»œï¼Œä¸€ä¸ª MLP æˆ– RNNï¼Œå®ƒæ¥æ”¶è¾“å…¥å’Œå…ˆå‰çš„è¯»å–å‘é‡ï¼Œå¹¶ä½œä¸ºå“åº”çœç•¥è¾“å‡ºã€‚æ­¤å¤–ï¼Œå®ƒé€šè¿‡ä¸€ç»„å¹¶è¡Œè¯»å†™å¤´ä»å­˜å‚¨å™¨çŸ©é˜µä¸­è¯»å–å’Œå†™å…¥ã€‚*å†…å­˜*æ˜¯ä¸€ä¸ª *N â¨‰ W* çŸ©é˜µï¼Œå…¶ä¸­ *N* æ˜¯å†…å­˜ä½ç½®(è¡Œ)çš„æ•°é‡ï¼Œ *W* æ˜¯æ¯ä¸ªä½ç½®çš„å‘é‡å¤§å°ã€‚

## é˜…è¯»

åœ¨æ¯ä¸ªæ—¶é—´æ­¥ *t* ï¼Œè¯»å–å¤´è¾“å‡ºåœ¨ *N* ä¸ªä½ç½®ä¸Šçš„å½’ä¸€åŒ–æƒé‡çš„çŸ¢é‡***w****_ t*ã€‚ç£å¤´è¿”å›çš„é•¿åº¦ä¸º *W* çš„è¯»å–å‘é‡***r****_ t*å®šä¹‰ä¸ºè¡Œå‘é‡***M****_ t(I)*çš„åŠ æƒç»„åˆ:

![](img/8086c70cbafda968efb7afd3099a67d8.png)

æˆ‘ä»¬å¯ä»¥å°†ä¸Šé¢çš„ç­‰å¼çŸ¢é‡åŒ–å¦‚ä¸‹

![](img/0b25b7f17b83a86f5dc987eca0935a4d.png)

ç­‰å¼ 1

# å†™ä½œ

å†™æ“ä½œè¢«åˆ†è§£æˆä¸¤ä¸ªéƒ¨åˆ†:ä¸€ä¸ª*æ“¦é™¤*ï¼Œéšåæ˜¯ä¸€ä¸ª*æ·»åŠ *ã€‚åœ¨æ¯ä¸ªæ—¶é—´æ­¥ *t* ï¼Œå†™å¤´å‘å‡ºä¸‰ä¸ªå‘é‡:ä¸€ä¸ª*N*-ç»´åº¦åŠ æƒå‘é‡ ***w*** *_t* ï¼Œä¸€ä¸ª*W*-ç»´åº¦æ“¦é™¤å‘é‡***e****_ t*ï¼Œä»¥åŠä¸€ä¸ª*W*-ç»´åº¦ç›¸åŠ å‘é‡ ***a*** *æ¯ä¸ªå­˜å‚¨å™¨å‘é‡***M****_ { t-1 }(t)*é¦–å…ˆè¢«æ“¦é™¤å‘é‡ä¿®æ”¹:*

![](img/1183a1408ce39a98ba8c3263a5fc1288.png)

å…¶ä¸­ ***1*** æ˜¯å…¨ 1 çš„è¡Œå‘é‡ï¼Œé’ˆå¯¹å­˜å‚¨ä½ç½®çš„ä¹˜æ³•æ˜¯é€ç‚¹è¿›è¡Œçš„

åˆ™åº”ç”¨æ·»åŠ å‘é‡

![](img/210699046be75f81ac69859cc3b8a0c5.png)

æˆ‘ä»¬è¿˜å¯ä»¥å°†ä¸Šè¿°ä¸¤ç§æ“ä½œç»“åˆèµ·æ¥ï¼Œå¹¶å¯¹å®ƒä»¬è¿›è¡ŒçŸ¢é‡åŒ–ï¼Œå¦‚ä¸‹æ‰€ç¤º

![](img/50eec9a6268541b4c557a5eb0e48ea19.png)

ç­‰å¼ 2ã€‚å…¶ä¸­ ***E*** æ˜¯å…·æœ‰ä¸ ***M*** ç›¸åŒå½¢çŠ¶çš„ 1 çš„çŸ©é˜µï¼Œå¹¶ä¸”âˆ˜è¡¨ç¤ºé€å…ƒç´ ä¹˜æ³•

# å¯»å€æœºåˆ¶

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»å±•ç¤ºäº†è¯»å†™çš„ç­‰å¼ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ²¡æœ‰æè¿°æƒé‡æ˜¯å¦‚ä½•äº§ç”Ÿçš„ã€‚è¿™äº›æƒé‡æ˜¯é€šè¿‡å°†ä¸¤ç§å¯»å€æœºåˆ¶ä¸äº’è¡¥è®¾æ–½ç›¸ç»“åˆè€Œäº§ç”Ÿçš„:

1.  ç¬¬ä¸€ç§æœºåˆ¶æ˜¯åŸºäºå†…å®¹çš„å¯»å€ï¼Œå®ƒåŸºäºä½ç½®ä¸æ§åˆ¶å™¨å‘å‡ºçš„æƒé‡çš„ç›¸ä¼¼æ€§æ¥å…³æ³¨ä½ç½®ã€‚è¿™å¯èƒ½æ˜¯ä¸€ç§å»ºç«‹åœ¨ä½™å¼¦ç›¸ä¼¼æ€§åŸºç¡€ä¸Šçš„æ³¨æ„æœºåˆ¶ï¼Œæˆ‘ä»¬åœ¨è®¨è®º[å˜å‹å™¨](https://medium.com/towards-artificial-intelligence/attention-is-all-you-need-transformer-4c34aa78308f?source=friends_link&sk=a259e84597d542f812a155711e9c8e97)æ—¶å·²ç»çœ‹åˆ°è¿‡ã€‚
2.  ç¬¬äºŒç§æœºåˆ¶æ˜¯åŸºäºä½ç½®çš„å¯»å€ï¼Œå®ƒæ ¹æ®å˜é‡çš„ä½ç½®è€Œä¸æ˜¯å†…å®¹æ¥è¯†åˆ«å˜é‡ã€‚è¿™ç§æœºåˆ¶å¯¹äºç®—æœ¯é—®é¢˜éå¸¸æœ‰ç”¨:ä¾‹å¦‚ï¼Œå˜é‡ *x* å’Œ *y* å¯ä»¥å–ä»»ä½•å€¼ï¼Œä½†æ˜¯åªè¦å®ƒä»¬çš„åœ°å€è¢«è¯†åˆ«ï¼Œè¿‡ç¨‹ *f(xï¼Œy)= x â¨‰ y* ä»ç„¶åº”è¯¥è¢«å®šä¹‰ã€‚

è¯·æ³¨æ„ï¼ŒåŸºäºå†…å®¹çš„å¯»å€æ¯”åŸºäºä½ç½®çš„å¯»å€æ›´æ™®éï¼Œå› ä¸ºå†…å­˜ä½ç½®çš„å†…å®¹å¯èƒ½åŒ…å«ä½ç½®ä¿¡æ¯ã€‚ç„¶è€Œï¼Œåœ¨å®éªŒä¸­ï¼ŒGraves ç­‰äººå‘ç°æä¾›åŸºäºä½ç½®çš„å¯»å€ä½œä¸ºåŸå§‹æ“ä½œå¯¹äºæŸäº›å½¢å¼çš„ä¸€èˆ¬åŒ–æ˜¯å¿…è¦çš„ï¼Œå› æ­¤ä»–ä»¬åŒæ—¶ä½¿ç”¨äº†è¿™ä¸¤ç§æœºåˆ¶ã€‚å›¾ 2 å±•ç¤ºäº†æ•´ä¸ªå¯»å€æœºåˆ¶ã€‚æˆ‘ä»¬å°†åœ¨ä¸‹é¢çš„å°èŠ‚ä¸­ä¸€æ­¥ä¸€æ­¥åœ°ä»‹ç»å®ƒã€‚

![](img/0fde94a0b886b58daa9128c74de687d6.png)

èµ„æ–™æ¥æº:äºšå†å…‹æ–¯Â·æ ¼é›·å¤«æ–¯ã€æ ¼é›·æ ¼Â·éŸ¦æ©å’Œä¼Šæ²ƒÂ·è¾¾å°¼åŸƒå°”å¡ã€‚2014.â€œç¥ç»å›¾çµæœºâ€

## åŸºäºå†…å®¹çš„å¯»å€

å¯¹äºå†…å®¹å¯»å€ï¼Œæˆ‘ä»¬åŸºäº ***M*** *_t* å’Œ*w***k****_ t*çš„è¡Œä¹‹é—´çš„ä½™å¼¦ç›¸ä¼¼åº¦æ¥è®¡ç®—å½’ä¸€åŒ–æƒé‡ ***w*** *_t^c* ï¼Œä¸ºäº†è°ƒæ•´ç›¸ä¼¼åº¦çš„æœ‰æ•ˆæ€§ï¼Œæˆ‘ä»¬å¦å¤–å¼•å…¥äº†ä¸€ä¸ªæ­£çš„å¯†é’¥å¼ºåº¦ *ğ›½_t* ï¼Œå®ƒå¯ä»¥è¿™å¯¼è‡´ä»¥ä¸‹åŠ æƒ*

![](img/e604a6034b1b306d6c48689ff486f0ed.png)

æˆ‘ä»¬å¯ä»¥å°†è¿™ç§è®¡ç®—çŸ¢é‡åŒ–ä¸º

![](img/c58a667c81e3fee9007157bacaf3530d.png)

ç­‰å¼ 3ã€‚å…¶ä¸­\æ³¢æµªå· M æ˜¯å…·æœ‰ l2 è§„èŒƒåŒ–è¡Œçš„ Mï¼Œè€Œ\æ³¢æµªå· k æ˜¯ l2 è§„èŒƒåŒ–çš„ kï¼Œ

## åŸºäºä½ç½®çš„å¯»å€

åŸºäºä½ç½®çš„å¯»å€æœºåˆ¶è¢«è®¾è®¡æˆä¾¿äºè·¨è¶Šå­˜å‚¨å™¨ä½ç½®çš„ç®€å•è¿­ä»£å’Œéšæœºå­˜å–è·³è½¬ã€‚è¿™æ˜¯é€šè¿‡å®ç°åŠ æƒçš„æ—‹è½¬ç§»ä½æ¥å®ç°çš„ã€‚

åœ¨æ—‹è½¬ä¹‹å‰ï¼Œæ¯ä¸ªå¤´å‘å‡ºä¸€ä¸ªèŒƒå›´ä¸º *(0ï¼Œ1 )* çš„æ ‡é‡æ’å€¼é—¨ *g_t* ã€‚ *g_t* çš„å€¼ç”¨äºèåˆå¤´éƒ¨åœ¨å‰ä¸€æ—¶é—´æ­¥äº§ç”Ÿçš„æƒé‡****w****_ { t-1 }*å’ŒåŸºäºå†…å®¹çš„æƒé‡***w****_t^c*:*

*![](img/9b47b72dceae44b44ac9ba131124636d.png)*

*ç­‰å¼ 4*

*å°¤å…¶æ˜¯å½“ *g_t=0* ã€**ã€ *w* ã€**ã€ *_t^g* ç­‰äº**ã€ *w* ã€**ã€ *_{t-1}ã€*æ—¶ï¼Œå®Œå…¨çœç•¥äº†åŸºäºå†…å®¹çš„åŠ æƒï¼Œç®€å•åœ°ä¸“æ³¨äºä½ç½®ç§»ä½ã€‚*

*æ’å€¼åï¼Œæˆ‘ä»¬å¯¹åŠ æƒåº”ç”¨ 1-D å·ç§¯ç§»ä½æ ¸ï¼Œå…¶å‚æ•°***s****_ t*æ˜¯ç”±å¤´éƒ¨äº§ç”Ÿçš„å½’ä¸€åŒ–åˆ†ç±»åˆ†å¸ƒï¼Œå¿…è¦æ—¶ç”¨é›¶å¡«å……(ä¾‹å¦‚å‚è§æœ€åçš„ä»£ç ):*

*![](img/353214a43c2bb8fa5a926704d7521687.png)*

*ç­‰å¼ 5*

*å…¶ä¸­æ‰€æœ‰ç´¢å¼•ç®—æ³•éƒ½æ˜¯ä»¥ *N* ä¸ºæ¨¡è®¡ç®—çš„ã€‚å¦‚æœç§»ä½åŠ æƒ**_ t*ä¸å°–é”ï¼Œè¿™ç§å·ç§¯è¿ç®—ä¼šå¯¼è‡´æƒé‡éšæ—¶é—´çš„æ³„æ¼æˆ–åˆ†æ•£ã€‚ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œæ¯ä¸ªå¤´å‘å°„å¦ä¸€ä¸ªæ ‡é‡ *ğ›¾_tâ‰¥1* ï¼Œå…¶ä½œç”¨æ˜¯é”åŒ–æœ€ç»ˆæƒé‡ï¼Œå¦‚ä¸‹æ‰€ç¤º:**

**![](img/92b254cb3089ece6fcdfbfa29c742e65.png)**

**ç­‰å¼ 6**

**å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ­£å¦‚ Graves ç­‰äººåœ¨å®éªŒä¸­æåˆ°çš„ï¼Œä»–ä»¬å‘ç°æ–¹ç¨‹ 4 å’Œæ–¹ç¨‹ 6 åœ¨è®­ç»ƒæ•°æ®èŒƒå›´ä¹‹å¤–çš„ NTM æ¨å¹¿ä¸­èµ·ç€é‡è¦ä½œç”¨ã€‚**

## **æ‘˜è¦**

**ç°åœ¨æˆ‘ä»¬å°†å¯»å€æœºåˆ¶æ€»ç»“å¦‚ä¸‹:**

1.  **ä½¿ç”¨ç­‰å¼ 3 è®¡ç®—å†…å®¹æƒé‡***w****_t^c*ã€‚**
2.  **é€šè¿‡å°†å†…å®¹æƒé‡ ***w*** *_t^c* å†…æ’åˆ°å…ˆå‰çš„æƒé‡****w****_ { t-1 }*ä¸­æ¥è®¡ç®—é—¨æ§æƒé‡ ***w*** *_t^g* ï¼Œè¿™æ˜¯é€šè¿‡ç­‰å¼ 4 æ¥å®Œæˆçš„ã€‚***
3.  **å°† 1D å·ç§¯æ ¸åº”ç”¨äºé—¨æ§åŠ æƒï¼Œä»¥è·å¾—åŸºäºå±€éƒ¨çš„åŠ æƒ*\æ³¢æµªå·****w****_ t*éµå¾ªç­‰å¼ 5ã€‚**
4.  **ä½¿ç”¨ç­‰å¼ 6 é€šè¿‡é”åŒ–*\æ³¢æµªå·****w****_ t*æ¥è®¡ç®—æœ€ç»ˆæƒé‡ã€‚**

**åŠ æƒæ’å€¼å’ŒåŸºäºå†…å®¹å’Œä½ç½®çš„å¯»å€çš„ç»„åˆå¯»å€ç³»ç»Ÿå¯ä»¥åœ¨ä¸‰ç§äº’è¡¥æ¨¡å¼ä¸‹æ“ä½œ:**

1.  **å†…å®¹ç³»ç»Ÿå¯ä»¥é€‰æ‹©æƒé‡ï¼Œè€Œæ— éœ€ä½ç½®ç³»ç»Ÿè¿›è¡Œä»»ä½•ä¿®æ”¹ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯¹äº jâ‰ 0ï¼Œå’Œ*Î³t = 1*ï¼Œæˆ‘ä»¬æœ‰ *g_t=1ï¼Œs_t(0)=1ï¼Œs_t(j)=0ã€‚***
2.  **ç”±å†…å®¹å¯»å€ç³»ç»Ÿäº§ç”Ÿçš„æƒé‡å¯ä»¥è¢«é€‰æ‹©ï¼Œç„¶åè¢«ç§»åŠ¨ã€‚è¿™å…è®¸ç„¦ç‚¹è·³è½¬åˆ°å†…å®¹è®¿é—®çš„åœ°å€æ—è¾¹çš„ä½ç½®ï¼Œè€Œä¸æ˜¯åœ¨è¯¥åœ°å€ä¸Šï¼›åœ¨è®¡ç®—æ–¹é¢ï¼Œè¿™å…è®¸ç£å¤´æ‰¾åˆ°ä¸€ä¸ªè¿ç»­çš„æ•°æ®å—ï¼Œç„¶åè®¿é—®è¯¥æ•°æ®å—ä¸­çš„ç‰¹å®šå…ƒç´ **
3.  **æ¥è‡ªå…ˆå‰æ—¶é—´æ­¥é•¿çš„æƒé‡å¯ä»¥è¢«æ—‹è½¬ï¼Œè€Œæ— éœ€æ¥è‡ªåŸºäºå†…å®¹çš„å¯»å€ç³»ç»Ÿçš„ä»»ä½•è¾“å…¥( *g_t=0* )ã€‚è¿™å…è®¸åŠ æƒé€šè¿‡åœ¨æ¯ä¸ªæ—¶é—´æ­¥é•¿æ¨è¿›ç›¸åŒçš„è·ç¦»æ¥è¿­ä»£é€šè¿‡åœ°å€åºåˆ—ã€‚**

# **å±¥è¡Œ**

**åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†è¿›ä¸€æ­¥è®¨è®º Collier&Beel å·¥ä½œä¸­çš„ä¸€äº›å®ç°ç»†èŠ‚ã€‚**

## **å­˜å‚¨å™¨å†…å®¹åˆå§‹åŒ–**

**ä»–ä»¬å°è¯•äº†ä¸‰ç§ä¸åŒçš„å†…å­˜å†…å®¹åˆå§‹åŒ–:**

1.  ***å¸¸é‡åˆå§‹åŒ–*:æ‰€æœ‰å†…å­˜ä½ç½®åˆå§‹åŒ–ä¸º *10^{-6}***
2.  ***å­¦ä¹ åˆå§‹åŒ–*:æˆ‘ä»¬åœ¨è®­ç»ƒæ—¶é€šè¿‡å†…å­˜åˆå§‹åŒ–åå‘ä¼ æ’­**
3.  ***éšæœºåˆå§‹åŒ–*:æ¯ä¸ªå†…å­˜ä½ç½®è¢«åˆå§‹åŒ–ä¸ºä¸€ä¸ªä»æˆªå°¾æ­£æ€åˆ†å¸ƒä¸­æå–çš„å€¼ï¼Œå¹³å‡å€¼ *0* å’Œæ ‡å‡†åå·® *0.5* ã€‚**

**ä»–ä»¬å‘ç°å¸¸é‡åˆå§‹åŒ–æ¯”å…¶ä»–ä¸¤ç§æ–¹æ¡ˆæ›´æœ‰æ•ˆã€‚**

## **å…¶ä»–å‚æ•°åˆå§‹åŒ–**

**å®ƒä»¬é€šè¿‡è¯»å–å‘é‡***r****_ 0*å’Œåœ°å€æƒé‡***w****_ 0*çš„åˆå§‹åŒ–æ¥åå‘ä¼ æ’­ï¼Œè€Œä¸æ˜¯å°†å®ƒä»¬åˆå§‹åŒ–ä¸ºåç½®å€¼ã€‚**

## **ç›¸ä¼¼æ€§æµ‹åº¦**

**ä»–ä»¬ä½¿ç”¨ä½™å¼¦ç›¸ä¼¼æ€§ï¼Œå¦‚ç­‰å¼ 3 æ‰€ç¤º**

## **æ§åˆ¶å™¨è¾“å…¥**

**åœ¨æ¯ä¸ªæ—¶é—´æ­¥ *t* ï¼Œæ§åˆ¶å™¨æ¥æ”¶æ¥è‡ªç¯å¢ƒçš„è¾“å…¥ï¼Œå¹¶ä» NTM çš„æ‰€æœ‰è¯»å–å¤´è¯»å–å‘é‡**_ { t-1 }*ã€‚***

## **å‚æ•°éçº¿æ€§**

**ä»–ä»¬ç”³è¯·**

*   **tanh å‡½æ•°å¯¹å…³é”®å‘é‡ ***k*** *_r* å’Œæ·»åŠ å‘é‡***a****_ t***
*   **sigmoid å‡½æ•°å¯¹æ“¦é™¤å‘é‡***e****_ t*å’Œé—¨ *g_t***
*   **softplus å‡½æ•°ç”¨äºé”®å…¥å¼ºåº¦ä»¥æ»¡è¶³çº¦æŸ *ğ›½_t > 0***
*   **softmax å‡½æ•°å¯¹å·ç§¯ç§»ä½å‘é‡***s****_ t***
*   **oneplus åŠŸèƒ½(*ã€1+log(1+e^xã€‘)*)é”åŒ–å› å­**

## **ç­‰å¼ 5 çš„ä»£ç **

```
**s = tf.concat(
  [s[:, :shift_range + 1],
  tf.zeros([s.get_shape()[0], memory_size - (shift_range * 2 + 1)]),
  s[:, -shift_range:]], axis=1
)
t = tf.concat([tf.reverse(s, axis=[1]), tf.reverse(s, axis=[1])], axis=1)
s_matrix = tf.stack(
    [t[:, memory_size - i - 1: memory_size * 2 - i - 1] 
     for i in range(memory_size)],
    axis=1
)
w_ = tf.reduce_sum(tf.expand_dims(w_g, axis=1) * s_matrix, axis=2)      # Equation 5**
```

**è®©æˆ‘ä»¬ä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥æ›´æ¸…æ¥šåœ°çœ‹åˆ°è¿™ä¸ªè¿‡ç¨‹ã€‚å‡è®¾å†…å­˜å¤§å°(å³ *N* )ä¸º *4* ï¼Œç§»ä½èŒƒå›´ä¸º *1* ï¼Œ*s =ã€0.5ï¼Œ0.2ï¼Œ0.3ã€‘*ï¼Œå…¶ä¸­ *0.5* ä¸ºä¸­å¿ƒè´¨é‡(ä¸ºç®€å•èµ·è§ï¼Œæ­¤å¤„çœç•¥æ‰¹é‡å°ºå¯¸)ã€‚é‚£ä¹ˆæˆ‘ä»¬æœ‰**

```
**w_g = np.array([
  [.1, .2, .3, .4]
])
s = np.array([.5, .2, 0, .3])
t = np.array([.3, 0, .2, .5, .3, 0, .2, .5])
s_matrix = np.array([
  [.5, .3, 0, .2],
  [.2, .5, .3, 0],
  [0, .2, .5, .3],
  [.3, 0, .2, .5]
])
w_ = np.sum(w_g * s_matrix, axis=1)
# >>> array([0.19, 0.21, 0.31, 0.29])**
```

# **å‚è€ƒ**

**äºšå†å…‹æ–¯Â·æ ¼é›·å¤«æ–¯ï¼Œæ ¼é›·æ ¼Â·éŸ¦æ©å’Œä¼Šæ²ƒÂ·ä¸¹å°¼å¡ã€‚2014.ã€Šç¥ç»å›¾çµæœºã€‹1â€“26ã€‚[http://arxiv.org/abs/1410.5401](http://arxiv.org/abs/1410.5401)ã€‚**

**ç§‘åˆ©å°”ï¼Œé©¬å…‹å’Œä¹”å…°Â·æ¯”å°”ã€‚2018."å®ç°ç¥ç»å›¾çµæœºã€‚"è®¡ç®—æœºç§‘å­¦è®²ä¹‰(åŒ…æ‹¬äººå·¥æ™ºèƒ½çš„å­ç³»åˆ—è®²ä¹‰å’Œç”Ÿç‰©ä¿¡æ¯å­¦çš„è®²ä¹‰)11141 LNCS:94â€“104ã€‚[https://doi.org/10.1007/978-3-030-01424-7_10](https://doi.org/10.1007/978-3-030-01424-7_10)ã€‚**

**ä»£å·:[https://github.com/MarkPKCollier/NeuralTuringMachine](https://github.com/MarkPKCollier/NeuralTuringMachine)**