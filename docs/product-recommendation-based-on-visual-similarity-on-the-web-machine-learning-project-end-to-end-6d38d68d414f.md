# åŸºäºç½‘é¡µè§†è§‰ç›¸ä¼¼æ€§çš„äº§å“æ¨è:æœºå™¨å­¦ä¹ /æ•°æ®ç§‘å­¦/æ·±åº¦å­¦ä¹ 

> åŸæ–‡ï¼š<https://pub.towardsai.net/product-recommendation-based-on-visual-similarity-on-the-web-machine-learning-project-end-to-end-6d38d68d414f?source=collection_archive---------0----------------------->

## [æœºå™¨å­¦ä¹ ](https://towardsai.net/p/category/machine-learning)

![](img/c7beb8a7f6c6570cb08f25812d849010.png)

æ¨èç³»ç»Ÿ

ä¼—æ‰€å‘¨çŸ¥ï¼Œè°·æ­Œã€äºšé©¬é€Šã€ç½‘é£ç­‰å¤§å‹ç§‘æŠ€å…¬å¸æ­£åœ¨ä½¿ç”¨æ¨èç³»ç»Ÿï¼Œæ ¹æ®æˆ‘ä»¬çš„è§‚å¯Ÿåå•æä¾›æ¨èï¼Œä»–ä»¬æ­£é€šè¿‡è¿™äº›æŠ€æœ¯è·å¾—å¤§é‡åˆ©æ¶¦â€¦

æ ¹æ®éº¦è‚¯é”¡æœ€è¿‘çš„ä¸€é¡¹ç ”ç©¶ï¼Œæ¶ˆè´¹è€…åœ¨ç½‘é£ä¸Šè§‚çœ‹çš„èŠ‚ç›®ä¸­ï¼Œé«˜è¾¾ 75%æ¥è‡ªè¯¥å…¬å¸çš„æ¨èç³»ç»Ÿï¼Œè¿™ä¸ä»…æ˜¯å› ä¸ºæ¶ˆè´¹è€…å‘ç°äº†æ›´å¤šçš„èŠ‚ç›®ï¼Œè€Œä¸”æ¨èç³»ç»Ÿå¯ä»¥ä¸ºè¯¥å…¬å¸èŠ‚çœå¤§é‡è¥é”€èµ„é‡‘

> **æˆ‘ä»¬å°†åœ¨æœ¬æ–‡ä¸­æ¶‰åŠçš„å†…å®¹**

1.  ä»€ä¹ˆæ˜¯æ¨èç³»ç»Ÿï¼Ÿ
2.  æ¨èç³»ç»Ÿçš„ç±»å‹ã€‚
3.  ä»€ä¹ˆæ˜¯è§†è§‰ç›¸ä¼¼ï¼Ÿ
4.  å¦‚ä½•å®ç°ä¸€ä¸ªåŸºäºè§†è§‰ç›¸ä¼¼æ€§çš„æ¨èç³»ç»Ÿ(Python)ï¼Ÿ
5.  ä½¿ç”¨ Streamlit åœ¨ web ä¸Šå®ç°ã€‚

> **é‚£ä¹ˆè®©æˆ‘ä»¬å¼€å§‹:**

åœ¨äº†è§£æ›´å¤šç»†èŠ‚ä¹‹å‰ï¼Œå¦‚æœä½ æƒ³çœ‹æœ€ç»ˆç»“æœï¼Œè¯·æŸ¥çœ‹æˆ‘çš„ YouTube è§†é¢‘ğŸ‘‰:- [**YouTube**](https://www.youtube.com/watch?v=JzEzBYtjBsE&t=68s&ab_channel=HimanshuTripathi)

> **ä»€ä¹ˆæ˜¯æ¨èç³»ç»Ÿï¼Ÿ**

![](img/26b23770f659d0c3edc10d2f3813a898.png)

å¤§å‹ç§‘æŠ€å…¬å¸

ä¸€ä¸ª**æ¨èç³»ç»Ÿ**ï¼Œæˆ–è€…ä¸€ä¸ª**æ¨èç³»ç»Ÿ**(æœ‰æ—¶ç”¨ä¸€ä¸ªåŒä¹‰è¯å¦‚ä¸€ä¸ªå¹³å°æˆ–è€…ä¸€ä¸ª**å¼•æ“**æ¥ä»£æ›¿**ç³»ç»Ÿ**)ï¼Œæ˜¯ä¸€ä¸ªä¿¡æ¯è¿‡æ»¤**ç³»ç»Ÿ**çš„å­ç±»ï¼Œå®ƒè¯•å›¾é¢„æµ‹ä¸€ä¸ªç”¨æˆ·å¯¹ä¸€ä¸ªé¡¹ç›®çš„â€œè¯„åˆ†â€æˆ–è€…â€œåå¥½â€ã€‚

æ¨èç³»ç»Ÿé€šè¿‡åŸºäºç”¨æˆ·æä¾›çš„æ•°æ®å’Œç…§é¡¾ç”¨æˆ·åå¥½å’Œå…´è¶£çš„å…¶ä»–å› ç´ è¿‡æ»¤æœ€é‡è¦çš„ä¿¡æ¯æ¥å¤„ç†å¤§é‡å­˜åœ¨çš„ä¿¡æ¯ã€‚å®ƒæ‰¾å‡ºç”¨æˆ·å’Œé¡¹ç›®ä¹‹é—´çš„åŒ¹é…ï¼Œå¹¶ä¼°ç®—å‡ºç”¨æˆ·å’Œé¡¹ç›®ä¹‹é—´çš„ç›¸ä¼¼åº¦ä»¥è¿›è¡Œæ¨èã€‚

ç”¨æˆ·å’Œæ‰€æä¾›çš„æœåŠ¡éƒ½ä»è¿™ç±»ç³»ç»Ÿä¸­å—ç›Šã€‚é€šè¿‡è¿™äº›ç³»ç»Ÿï¼Œè´¨é‡å’Œå†³ç­–è¿‡ç¨‹ä¹Ÿå¾—åˆ°æ”¹å–„ã€‚

> ä¸ºä»€ä¹ˆæ¨èç³»ç»Ÿå¾ˆé‡è¦ï¼Ÿ

![](img/f8cab9f612ea8678ddcd21b5fd072499.png)

*   å¸®åŠ©ç”¨æˆ·æ‰¾åˆ°ä»–ä»¬æ„Ÿå…´è¶£çš„é¡¹ç›®ã€‚
*   å¸®åŠ©ç‰©å“ä¾›åº”å•†å°†ç‰©å“äº¤ä»˜ç»™æ­£ç¡®çš„ç”¨æˆ·ã€‚
*   è¯†åˆ«ä¸ç”¨æˆ·æœ€ç›¸å…³çš„äº§å“ã€‚
*   ä¸ªæ€§åŒ–å†…å®¹ã€‚
*   å¸®åŠ©ç½‘ç«™æé«˜ç”¨æˆ·å‚ä¸åº¦ã€‚

> **æœ‰ä»€ä¹ˆå¯ä»¥æ¨èçš„ï¼Ÿ**

ç³»ç»Ÿå¯ä»¥æ¨èè®¸å¤šä¸åŒçš„ä¸œè¥¿ï¼Œå¦‚ç”µå½±ã€ä¹¦ç±ã€æ–°é—»ã€æ–‡ç« ã€å·¥ä½œã€å¹¿å‘Šç­‰ã€‚ç½‘é£ä½¿ç”¨æ¨èç³»ç»Ÿå‘ç”¨æˆ·æ¨èç”µå½±å’Œç½‘ç»œç³»åˆ—ã€‚åŒæ ·ï¼ŒYouTube æ¨èä¸åŒçš„è§†é¢‘ã€‚ç°åœ¨æœ‰è®¸å¤šå¹¿æ³›ä½¿ç”¨çš„æ¨èç³»ç»Ÿçš„ä¾‹å­ã€‚

> **æ¨èç³»ç»Ÿçš„ç±»å‹ã€‚**

![](img/340a299a2b723789a11914ba2336f201.png)

# 1.åŸºäºæµè¡Œåº¦çš„æ¨èç³»ç»Ÿ

è¿™æ˜¯ä¸€ç§æ¨èç³»ç»Ÿï¼Œå®ƒçš„å·¥ä½œåŸç†æ˜¯æµè¡Œæˆ–ä»»ä½•æµè¡Œçš„ä¸œè¥¿ã€‚è¿™äº›ç³»ç»Ÿæ£€æŸ¥æµè¡Œçš„æˆ–æœ€å—ç”¨æˆ·æ¬¢è¿çš„äº§å“æˆ–ç”µå½±ï¼Œå¹¶ç›´æ¥æ¨èå®ƒä»¬ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªäº§å“ç»å¸¸è¢«å¤§å¤šæ•°äººè´­ä¹°ï¼Œé‚£ä¹ˆç³»ç»Ÿå°†çŸ¥é“è¯¥äº§å“æ˜¯æœ€å—æ¬¢è¿çš„ï¼Œå› æ­¤å¯¹äºæ¯ä¸ªåˆšåˆšç­¾ç½²è¯¥äº§å“çš„æ–°ç”¨æˆ·ï¼Œç³»ç»Ÿä¹Ÿå°†å‘è¯¥ç”¨æˆ·æ¨èè¯¥äº§å“ï¼Œå¹¶ä¸”æ–°ç”¨æˆ·ä¹Ÿå°†è´­ä¹°è¯¥äº§å“çš„æœºä¼šå˜é«˜ã€‚

## ä¼˜ç‚¹

*   å®ƒæ²¡æœ‰å†·å¯åŠ¨é—®é¢˜ï¼Œè¿™æ„å‘³ç€åœ¨ä¸šåŠ¡çš„ç¬¬ä¸€å¤©ï¼Œå®ƒè¿˜å¯ä»¥æ¨èå„ç§ä¸åŒè¿‡æ»¤å™¨çš„äº§å“ã€‚
*   ä¸éœ€è¦ç”¨æˆ·çš„å†å²æ•°æ®ã€‚

## ç¼ºç‚¹

*   ä¸ä¸ªæ€§åŒ–
*   è¯¥ç³»ç»Ÿå°†å‘æ¯ä¸ªå…¶ä»–ç”¨æˆ·æ¨èå®Œå…¨åŸºäºå—æ¬¢è¿ç¨‹åº¦çš„åŒç±»äº§å“/ç”µå½±ã€‚

## ä¾‹å­

*   è°·æ­Œæ–°é—»:é€šè¿‡è¶‹åŠ¿å’Œæœ€å—æ¬¢è¿çš„æ–°é—»è¿‡æ»¤çš„æ–°é—»ã€‚
*   YouTube:è¶‹åŠ¿è§†é¢‘ã€‚

# 2.åŸºäºå†…å®¹çš„æ¨èç³»ç»Ÿ

è¿™æ˜¯å¦ä¸€ç§åŸºäºç›¸ä¼¼å†…å®¹åŸç†çš„æ¨èç³»ç»Ÿã€‚å¦‚æœç”¨æˆ·æ­£åœ¨è§‚çœ‹ç”µå½±ï¼Œåˆ™ç³»ç»Ÿå°†æ£€æŸ¥ä¸ç”¨æˆ·æ­£åœ¨è§‚çœ‹çš„ç”µå½±å†…å®¹ç›¸ä¼¼æˆ–ç±»å‹ç›¸åŒçš„å…¶ä»–ç”µå½±ã€‚åœ¨æ£€æŸ¥ç›¸ä¼¼å†…å®¹æ—¶ï¼Œæœ‰å„ç§ç”¨äºè®¡ç®—ç›¸ä¼¼æ€§çš„åŸºæœ¬å±æ€§ã€‚

åŸºäºå†…å®¹çš„ç³»ç»Ÿä½¿ç”¨ä¸åŒç±»å‹çš„æ–¹æ³•æ¥è·å¾—ç›¸ä¼¼æ€§

*   æ¬§å‡ é‡Œå¾—è·ç¦»
*   ä½™å¼¦ç›¸ä¼¼åº¦(æˆ‘ä»¬å°†ä½¿ç”¨ä½™å¼¦ç›¸ä¼¼åº¦çŸ©é˜µ)
*   é›…å…‹å¡ç›¸ä¼¼æ€§

# 3.ååŒè¿‡æ»¤

å®ƒè¢«è®¤ä¸ºæ˜¯éå¸¸æ™ºèƒ½çš„æ¨èç³»ç»Ÿä¹‹ä¸€ï¼Œå¯ä»¥å¤„ç†ä¸åŒç”¨æˆ·ä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼Œä¹Ÿå¯ä»¥å¹¿æ³›ç”¨äºç”µå­å•†åŠ¡ç½‘ç«™å’Œåœ¨çº¿ç”µå½±ç½‘ç«™ã€‚å®ƒä¼šæ£€æŸ¥ç›¸ä¼¼ç”¨æˆ·çš„å£å‘³å¹¶è¿›è¡Œæ¨èã€‚

ç›¸ä¼¼æ€§ä¸é™äºç”¨æˆ·çš„å–œå¥½ï¼Œæ­¤å¤–ï¼Œè¿˜å¯ä»¥è€ƒè™‘ä¸åŒé¡¹ç›®ä¹‹é—´çš„ç›¸ä¼¼æ€§ã€‚å¦‚æœæˆ‘ä»¬æœ‰å¤§é‡å…³äºç”¨æˆ·å’Œé¡¹ç›®çš„ä¿¡æ¯ï¼Œç³»ç»Ÿä¼šç»™å‡ºæ›´æœ‰æ•ˆçš„æ¨èã€‚

ååŒè¿‡æ»¤ä¸»è¦ä½¿ç”¨ä¸¤ç§æ–¹æ³•

*   åŸºäºç”¨æˆ·çš„æœ€è¿‘é‚»ååŒè¿‡æ»¤
*   åŸºäºé¡¹ç›®çš„æœ€è¿‘é‚»ååŒè¿‡æ»¤

> **ä»€ä¹ˆæ˜¯è§†è§‰ç›¸ä¼¼ï¼Ÿ**

![](img/859f9c54424957edaacee0d6b30b40b6.png)

è§†è§‰ç›¸ä¼¼æ€§æ£€ç´¢â€œçœ‹èµ·æ¥ç›¸ä¼¼â€çš„å›¾åƒï¼Œè€Œä¸ç®¡å›¾åƒå†…å®¹å¦‚ä½•ã€‚æ£€ç´¢åˆ°çš„å›¾åƒä¸é€‰æ‹©çš„å›¾åƒå…·æœ‰ç›¸ä¼¼çš„è§†è§‰å±æ€§ï¼Œä¾‹å¦‚å¯æ¯”è¾ƒçš„é¢œè‰²ã€çº¹ç†å’Œå½¢çŠ¶ã€‚

ä¸ºäº†è·å¾—å›¾åƒçš„è§†è§‰ç›¸ä¼¼æ€§ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ CNN å¹¶æå–å›¾åƒç‰¹å¾

> **å¦‚ä½•å®ç°åŸºäºè§†è§‰ç›¸ä¼¼åº¦çš„æ¨èç³»ç»Ÿ(Python)ã€‚**

**åŸºäºè§†è§‰ç›¸ä¼¼åº¦çš„äº§å“æ¨è**

è¿™ä¸ªå®éªŒçš„ç›®æ ‡æ˜¯åšä¸€ä¸ªéå¸¸åŸºæœ¬çš„æ¨èç³»ç»Ÿ:å¯¹äºä¸€ä¸ªç»™å®šçš„æ—¶å°šäº§å“ï¼Œæˆ‘ä»¬æƒ³è¦æ¨èçœ‹èµ·æ¥ç›¸ä¼¼çš„äº§å“ã€‚

è¿™ç§æ¨èç³»ç»Ÿç»å¸¸åœ¨æµè§ˆè´­ç‰©ç½‘ç«™æ—¶ä½¿ç”¨ã€‚å®ƒä»¬é€šå¸¸å‡ºç°åœ¨äº§å“é¡µé¢ä¸Šï¼Œå°±åƒâ€œä½ å¯èƒ½ä¹Ÿä¼šå–œæ¬¢â€éƒ¨åˆ†ã€‚

è¿™ç§æ¨èç³»ç»ŸèƒŒåçš„æƒ³æ³•å¾ˆç®€å•:å¦‚æœä¸€ä¸ªé¡¾å®¢é€šè¿‡æµè§ˆä¸€ä¸ªäº§å“çš„é¡µé¢è¡¨ç°å‡ºå¯¹è¯¥äº§å“çš„å…´è¶£ï¼Œä»–ä¹Ÿå¯èƒ½å¯¹ç±»ä¼¼çš„å‰¯äº§å“æ„Ÿå…´è¶£ã€‚

> **å¦‚ä½•è¿›è¡Œï¼Ÿ**

![](img/4255147ee13e752365dc6e30718fcd4d.png)

æˆ‘ä»¬å°†ä½¿ç”¨æ¥è‡ª Keras çš„é¢„è®­ç»ƒ CNN æ¨¡å‹æ¥æå–å›¾åƒç‰¹å¾ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å…ˆå‰æå–çš„å›¾åƒç‰¹å¾æ¥è®¡ç®—ä¸åŒäº§å“ä¹‹é—´çš„ç›¸ä¼¼æ€§ã€‚

> **ç¬¬ä¸€æ­¥:**

**ä¸‹è½½æ•°æ®é›†:**

æˆ‘ä»¬å°†ä½¿ç”¨â€œé£æ ¼å½©è‰²å›¾åƒæ•°æ®é›†â€ã€‚æˆ‘ä»¬å¯ä»¥ä»â€œKaggleâ€ä¸‹è½½æ•°æ®é›†

æ•°æ®é›†:â€”â€”[https://www.kaggle.com/olgabelitskaya/style-color-images](https://www.kaggle.com/olgabelitskaya/style-color-images)

> **ç¬¬äºŒæ­¥:**

```
# imports
from keras.applications import vgg16
from keras.preprocessing.image import load_img,img_to_array
from keras.models import Model
from keras.applications.imagenet_utils import preprocess_input
from PIL import Image
import os
import matplotlib.pyplot as plt
import numpy as np
from sklearn.metrics.pairwise import cosine_similarity
import pandas as pd
```

> **#å‚æ•°è®¾ç½®**

```
# parameters setupimgs_path = "/content/data/style"imgs_model_width, imgs_model_height = 224, 224nb_closest_images = 5 # number of most similar images to retrieve
```

> **#ä» Keras åŠ è½½ VGG é¢„è®­ç»ƒæ¨¡å‹**

Keras æ¨¡å—åŒ…å«å‡ ä¸ªé¢„è®­ç»ƒçš„æ¨¡å‹ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°åŠ è½½ã€‚å¯¹äºæˆ‘ä»¬åŸºäºè§†è§‰ç›¸ä¼¼æ€§çš„æ¨èç³»ç»Ÿï¼Œæˆ‘ä»¬éœ€è¦åŠ è½½ä¸€ä¸ªå·ç§¯ç¥ç»ç½‘ç»œ(CNN)æ¥è§£é‡Šå›¾åƒå†…å®¹ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†åŠ è½½åœ¨ imagenet ä¸Šè®­ç»ƒçš„ VGG16 æ¨¡å‹ï¼Œimagenet æ˜¯ä¸€ä¸ªå¤§çš„å¸¦æ ‡ç­¾çš„å›¾åƒæ•°æ®åº“ã€‚å¦‚æœæˆ‘ä»¬é‡‡ç”¨æ•´ä¸ªæ¨¡å‹ï¼Œæˆ‘ä»¬å°†å¾—åˆ°ä¸€ä¸ªåŒ…å«å±äºæŸäº›ç±»çš„æ¦‚ç‡çš„è¾“å‡ºï¼Œä½†è¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚æˆ‘ä»¬å¸Œæœ›æ£€ç´¢æ¨¡å‹èƒ½å¤Ÿä»å›¾åƒä¸­è·å¾—çš„æ‰€æœ‰ä¿¡æ¯ã€‚ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¿…é¡»åˆ é™¤ CNN çš„æœ€åå‡ å±‚ï¼Œå®ƒä»¬åªç”¨äºç±»åˆ«é¢„æµ‹ã€‚

> **#åŠ è½½æ¨¡å‹**

```
# load the model
vgg_model = vgg16.VGG16(weights='imagenet')# remove the last layers in order to get features instead of predictions
feat_extractor = Model(inputs=vgg_model.input,
outputs=vgg_model.get_layer("fc2").output)# print the layers of the CNN
feat_extractor.summary()
```

> **#è·å–å›¾åƒè·¯å¾„:**

```
files = []
for x in os.listdir(imgs_path):
    if 'png' in x:
        # print(x)
        files.append(f"{imgs_path}/{x}")
        # break
```

> **#å°†ä¸€å¹…å›¾åƒè¾“å…¥ CNN**

![](img/5739d7834113e716412ef35a5de8bbd5.png)

é¦–å…ˆï¼Œæˆ‘ä»¬è§‚å¯Ÿå½“æŠŠä¸€ä¸ªå›¾åƒæ”¾å…¥ CNN æ—¶æˆ‘ä»¬å¾—åˆ°ä»€ä¹ˆè¾“å‡ºã€‚

**ä»¥ä¸‹æ­¥éª¤æ˜¯:**

*   **åŠ è½½å›¾åƒ**
*   **å‡†å¤‡å°†å›¾åƒè¾“å…¥ CNN**
*   **è·å–ä¸å›¾åƒç‰¹å¾ç›¸å¯¹åº”çš„ CNN è¾“å‡º**

```
# load an image in PIL format
original = load_img(files[1],target_size=(imgs_model_width,                           imgs_model_height))
plt.imshow(original)
plt.show()
print("image loaded successfully!")
```

> **#ä¸€ä¸ªå›¾åƒçš„ç‰¹å¾æå–**

```
# in PIL - image is in (width, height, channel)
# in Numpy - image is in (height, width, channel)
numpy_image = img_to_array(original)# convert the image / images into batch format
# expand_dims will add an extra dimension to the data at a particular axis
# we want the input matrix to the network to be of the form (batchsize, height, width, channels)
# thus we add the extra dimension to the axis 0.image_batch = np.expand_dims(numpy_image, axis=0)
print('image batch size', image_batch.shape)# prepare the image for the VGG model
processed_image = preprocess_input(image_batch.copy())
```

> **#æŠŠæ‰€æœ‰çš„å›¾åƒè¾“å…¥ CNN**

æˆ‘ä»¬èƒ½å¤Ÿå¯¹ä¸€å¹…å›¾åƒè¿›è¡Œç‰¹å¾æå–ã€‚ç°åœ¨è®©æˆ‘ä»¬ä¸ºæˆ‘ä»¬æ‰€æœ‰çš„å›¾åƒè¿™æ ·åšï¼

```
# load all the images and prepare them for feeding into the CNNimportedImages = []for f in files:
    filename = f
    original = load_img(filename, target_size=(224, 224))
    numpy_image = img_to_array(original)
    image_batch = np.expand_dims(numpy_image, axis=0)
    importedImages.append(image_batch)images = np.vstack(importedImages)
processed_imgs = preprocess_input(images.copy())
```

> **#æå–å›¾ç‰‡ç‰¹å¾**

```
imgs_features = feat_extractor.predict(processed_imgs)
print("features successfully extracted!")
imgs_features.shape
```

> **#è®¡ç®—ä½™å¼¦ç›¸ä¼¼åº¦**

ç°åœ¨æˆ‘ä»¬æœ‰äº†æ¯å¹…å›¾åƒçš„ç‰¹å¾ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—æ¯å¯¹å›¾åƒä¹‹é—´çš„ç›¸ä¼¼æ€§åº¦é‡ã€‚

**æˆ‘ä»¬å°†åœ¨è¿™é‡Œä½¿ç”¨ä½™å¼¦ç›¸ä¼¼æ€§åº¦é‡ã€‚**

```
# compute cosine similarities between images
cosSimilarities = cosine_similarity(imgs_features)# store the results into a pandas dataframe
cos_similarities_df = pd.DataFrame(cosSimilarities,columns=files, index=files)
cos_similarities_df.head()
```

> **å°†é¢„å¤„ç†æ•°æ®é›†ä¿å­˜ä¸º csv æ–‡ä»¶ï¼Œä»¥ä¾¿æˆ‘ä»¬ä»¥åä½¿ç”¨**

```
cos_similarities_df.to_csv("model.csv")
```

> **#æ£€ç´¢æœ€ç›¸ä¼¼äº§å“**

**æœ€åä¸€æ­¥æ˜¯å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œå¯¹äºä»»ä½•ç»™å®šçš„äº§å“ï¼Œè¿”å›è§†è§‰ä¸Šæœ€ç›¸ä¼¼çš„äº§å“ã€‚**

```
def retrieve_most_similar_products(given_img):
    print("-"*50)
    print("original product:")
    original = load_img(given_img, target_size=(imgs_model_width,      imgs_model_height))
    plt.imshow(original)
    plt.show() print("-"*50)
    print("most similar products:") closest_imgs = df[given_img].sort_values(ascending=False)[1:nb_closest_images+1].index
    closest_imgs_scores = df[given_img].sort_values(ascending=False)[1:nb_closest_images+1] for i in range(0,len(closest_imgs)):
        original = load_img(closest_imgs[i], target_size=(imgs_model_width, imgs_model_height))
        plt.imshow(original)
        plt.show()
        print("similarity score : ",closest_imgs_scores[i])
```

> **ä½¿ç”¨ Streamlit åœ¨ web ä¸Šå®ç°ã€‚**

![](img/8ee6a984da5d8c1436565254d18bc921.png)

ç»†æµ

**åˆ¶ä½œå¥½é¢„å¤„ç†çš„ CSV æ–‡ä»¶å’Œæ•°æ®æºåï¼Œæˆ‘ä»¬çš„æ–‡ä»¶ç›®å½•çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„:**

![](img/d5da1ee576a9a50d1d112373ffd5094c.png)

**å†…å®¹:-** æ˜¯æ•°æ®æ–‡ä»¶(å›¾ç‰‡)

**Main:-** è¿è¡Œåº”ç”¨ç¨‹åºçš„ä¸»æ–‡ä»¶(streamlit)

**æ¨¡å‹:-** é¢„å¤„ç†åçš„ CSV æ–‡ä»¶

> **ç¬¬ä¸€æ­¥:**
> 
> **#å®‰è£…æµçº¿**

```
**pip install streamlit**
```

> **ç¬¬äºŒæ­¥:**
> 
> **#å¯¼å…¥å¿…è¦çš„åº“**

```
**import streamlit as st
from tensorflow.keras.applications import vgg16
from tensorflow.keras.preprocessing.image import load_img,img_to_array
from tensorflow.keras.models import Model
from tensorflow.keras.applications.imagenet_utils import preprocess_input****from PIL import Image
import os
import matplotlib.pyplot as plt
import numpy as np
from sklearn.metrics.pairwise import cosine_similarity
import pandas as pd**
```

> **#è®¾å®šå›¾åƒå®½åº¦å’Œå›¾åƒé«˜åº¦**

```
**imgs_model_width, imgs_model_height = 224, 224****nb_closest_images = 5**
```

> **#åŠ è½½ CSV æ–‡ä»¶**

```
**@st.cache
def load_data():
    df = pd.read_csv('model.csv')
    df.set_index("Unnamed: 0", inplace=True)
    return df**
```

> **#æ£€ç´¢äº§å“(ä¸»è¦åŠŸèƒ½)**

```
**def retrieve_most_similar_products(given_img,df):
    st.write("-"*50)
    st.success("original product:")** **original = load_img(given_img, target_size=(imgs_model_width,  imgs_model_height))
    plt.imshow(original)
    st.pyplot()** **st.write("-"*50) 
    st.error("most similar products:")
    given_img = "/"+given_img
    closest_imgs = df[given_img].sort_values(ascending=False)[1:nb_closest_images+1].index
    closest_imgs_scores = df[given_img].sort_values(ascending=False)[1:nb_closest_images+1]
    # st.write(closest_imgs[1][1:])
    for i in range(0,len(closest_imgs)):
        original = load_img(closest_imgs[i][1:], target_size=(imgs_model_width, imgs_model_height))
        plt.imshow(original)
        st.write("Simillarity",closest_imgs_scores[i])
        st.pyplot()
        plt.show()**
```

> **#ç”¨äºåŠ è½½å›¾åƒ**

```
[**@st**](http://twitter.com/st)**.cache()
def names():
    list_data = os.listdir('content/data/style')

    return list_data**
```

> **#ä¸»è¦åŠŸèƒ½**

```
**def main():
    st.sidebar.title("Himanshu Tripathi")

    st.sidebar.subheader('A recommender system, or a recommendation system, is a subclass of information filtering system that seeks to predict the "rating" or "preference" a user would give to an item. They are primarily used in commercial applications.')****activites = ['Product','About']
    choice = st.sidebar.selectbox("Select Actvity", activites)****if choice == 'Product':
        st.title("Product Recommendation System")

        name = names()
        n = st.selectbox("Select Image",name)
        if n is not None:
            path = "content/data/style/"+n
            df = load_data()

            retrieve_most_similar_products(path,df)
        else:
            st.error("Write the path name")****elif choice =='About':
        st.title("About Me")****st.success("Machine Learning and Data Science enthusiast, Android Developer, programmer and always willing to learn and work across new technologies and domains.")
        st.error("If you like the project Please Like Share and Subscribe")
        st.title("Please Like Share and Subscribe....")****if __name__ == '__main__':
 main()**
```

**åœ¨æˆ‘çš„ YouTube ä¸ŠæŸ¥çœ‹æ›´å¤šæœ‰è¶£çš„æœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ ã€æ•°æ®ç§‘å­¦é¡¹ç›®ğŸ‘‰:-**[**YouTube**](https://www.youtube.com/c/himanshutripathi)**(ğŸ‘)**

**æš‚æ—¶å°±è¿™æ ·äº†ğŸ‘ğŸ‘ã€‚ä¸‹ä¸€ç¯‡æ–‡ç« å†è§ã€‚**

**å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰è¶£ï¼Œæœ‰å¸®åŠ©ï¼Œå¦‚æœä½ ä»è¿™ç¯‡æ–‡ç« ä¸­å­¦åˆ°äº†ä»€ä¹ˆï¼Œè¯·é¼“æŒğŸ‘ğŸ‘)**å¹¶ç•™ä¸‹åé¦ˆã€‚****

****æ„Ÿè°¢é˜…è¯»ï¼****

> ****å‚è€ƒæ–‡çŒ®:-****

**[**https://www . ka ggle . com/olgabelitskaya/style-color-images/notebooks**](https://www.kaggle.com/olgabelitskaya/style-color-images/notebooks)**

**[**https://www . analyticssteps . com/blogs/what-are-recommendation-systems-machine-learning**](https://www.analyticssteps.com/blogs/what-are-recommendation-systems-machine-learning)**

****è¿˜æœ‰ï¼Œè®©æˆ‘ä»¬åœ¨**[**Linkedin**](https://www.linkedin.com/in/iamhimanshu0/)**[**Twitter**](https://twitter.com/iam_himanshu0)**[**insta gram**](https://instagram.com/iamhimanshu0/)**[**Github**](https://github.com/iamhimanshu0)**ï¼Œä»¥åŠ** [**è„¸ä¹¦**](https://www.facebook.com/iamhimanshu0) **ã€‚**********