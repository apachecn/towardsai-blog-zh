# ğŸ–ğŸ²Recibrewï¼ç”¨æ·±åº¦å­¦ä¹ é¢„æµ‹é£Ÿç‰©æˆåˆ†ï¼ğŸ²ğŸ–

> åŸæ–‡ï¼š<https://pub.towardsai.net/recibrew-find-out-the-foods-ingredients-dbc2a4e37383?source=collection_archive---------2----------------------->

## [æ·±åº¦å­¦ä¹ ](https://towardsai.net/p/category/machine-learning/deep-learning)ï¼Œ[æ•™ç¨‹](https://towardsai.net/p/category/tutorial)

## åœ¨ Pytorch Lightning ä¸­å®ç°çš„æ·±åº¦å­¦ä¹ ä¸­ä½¿ç”¨ seq2seq é¢„æµ‹é£Ÿå“æˆåˆ†çš„â–¶ï¸â–¶ï¸å¾ªåºæ¸è¿›æ•™ç¨‹ã€‚â—€ï¸â—€ï¸

![](img/58629bc3ee4da7bceb675ed7a47c88ad.png)

ç…§ç‰‡ç”±[ä¸¹é‡‘](https://unsplash.com/@danielcgold?utm_source=medium&utm_medium=referral)åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„

å—¨ï¼Œä¼™è®¡ä»¬ï¼Œæ¬¢è¿æ¥åˆ°æˆ‘çš„æ–°æ–‡ç« ã€‚è·ç¦»ä¸Šæ¬¡å†™ä¸œè¥¿å·²ç»å¾ˆä¹…äº†ã€‚ä»Šå¤©ï¼Œæˆ‘æƒ³å†™ä¸€å†™æˆ‘çš„ç®€å•æœ‰è¶£çš„é¡¹ç›®ï¼Œå«åš**é…æ–¹é…¿é…’å¸ˆ** (Recibrew)ã€‚Recipe Brewer æ˜¯æˆ‘åœ¨ç©ºé—²æ—¶é—´åšçš„æœ‰è¶£é¡¹ç›®ä¹‹ä¸€ï¼Œä»¥æ»¡è¶³æˆ‘çš„å¥½å¥‡å¿ƒã€‚å› æ­¤ï¼Œæˆ‘æƒ³å°½å¯èƒ½è¯šå®åœ°åˆ†äº«æˆ‘æ˜¯å¦‚ä½•å®Œæˆè¿™ä¸ªæœ‰è¶£çš„å°é¡¹ç›®çš„ğŸ˜„ã€‚æ‰€ä»¥ä½ å¯ä»¥å¤åˆ¶å’Œå­¦ä¹ æˆ‘åšçš„ä¸œè¥¿ã€‚

# æ¦‚è¿°

1.  ä»‹ç»
2.  è´®è—å®¤ËŒä»“åº“
3.  æ¨¡å‹
4.  æ•°æ®é›†ã€EDA å’Œæ•°æ®é¢„å¤„ç†
5.  è¯„ä¼°æŒ‡æ ‡
6.  è§£ç ç­–ç•¥
7.  å±¥è¡Œ
8.  å®éªŒ
9.  ç»“æœ
10.  å»ºè®®
11.  è¶£å‘³é…æ–™ç”Ÿæˆå™¨
12.  ç»“è®º
13.  ç¼–åè®°

# ä»‹ç»

![](img/b455dee19148fb3c845e071ec3d6a953.png)

ç…§ç‰‡ç”± [Loija Nguyen](https://unsplash.com/@loija?utm_source=medium&utm_medium=referral) åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„

è¯¥é¡¹ç›®æ˜¯å…³äºå»ºç«‹ä¸€ä¸ªé…æ–™ç”Ÿæˆå™¨åº”ç”¨ç¨‹åºã€‚å®ƒæ˜¯åŸºäºé…æ–¹æ ‡é¢˜ä½œä¸ºè¾“å…¥çš„é…æ–™é¢„æµ‹å™¨ã€‚æˆ‘ä½¿ç”¨**æ·±åº¦å­¦ä¹ **ä½œä¸ºåˆ›å»ºç”Ÿæˆé£Ÿè°±åç§°çš„æ¨¡å‹çš„æ–¹æ³•ã€‚

å½“æˆ‘å¦ˆå¦ˆåšé¥­æ—¶ï¼Œæƒ³çŸ¥é“ç”¨ä»€ä¹ˆé…æ–™æ¥åšä¸€äº›æ–°çš„é£Ÿç‰©ï¼Œè¿™ä¸ªæƒ³æ³•å°±æ¥äº†ã€‚ç„¶åæˆ‘æƒ³ï¼Œâ€˜å—¯ï¼Œä¸å¦‚æˆ‘å»ºä¸€ä¸ªç¨‹åºï¼Œå¯ä»¥ä»é£Ÿç‰©åç§°ä¸­æå–é…æ–™ã€‚â€™æ—¢ç„¶æˆ‘æœ‰å¼€å‘ä¸€äº›æ·±åº¦å­¦ä¹ (DL)åº”ç”¨çš„ç»éªŒï¼Œä¸ºä»€ä¹ˆä¸ä»ä¸­è·å¾—ä¹è¶£å‘¢ï¼ŒâœŒï¸.

æ€»ä¹‹ï¼Œæˆ‘æƒ³å»ºç«‹ä¸€ä¸ªç¨‹åºï¼Œå®ƒæ¥æ”¶é£Ÿç‰©åç§°ä½œä¸ºè¾“å…¥ï¼Œå¹¶è¾“å‡ºé…æ–™ã€‚ä¸‹é¢æ˜¯æˆ‘æƒ³å¼€å‘çš„ä¸€ä¸ªä¾‹å­:

```
Input : 'fried rice'
Model Output : '1 gr rice || 1 gr salt' 
```

è¿™ç¯‡æ–‡ç« å°†ä¸»è¦æ˜¯å…³äºåœ¨è‡ªç„¶è¯­è¨€å¤„ç†(NLP)ä¸­è¯•éªŒä¸€äº›æ·±åº¦å­¦ä¹  **Seq2Seq** æ¶æ„ã€‚åˆ†åˆ«æ˜¯**é—¨æ§å¾ªç¯å•å…ƒ(GRU)+å·´ä¸¹ç‘™æ³¨æ„**å’Œ**å˜å‹å™¨**ã€‚å› ä¸ºæˆ‘å¯¹å®ƒä»¬åœ¨ä½å‚æ•°ä¸‹çš„æ€§èƒ½å¾ˆå¥½å¥‡ï¼Œæ‰€ä»¥æˆ‘æŠŠè¿™äº›æ¶æ„åšå¾—å¾ˆå°ã€‚å®ƒä»¬æ¯ä¸ªéƒ½æœ‰å‡ ä¹ç›¸ä¼¼çš„å‚æ•°(1M å·¦å³)ã€‚ç¨åï¼Œæˆ‘ä»¬å°†æ¯”è¾ƒå®ƒä»¬ä¸­çš„æ¯ä¸€ä¸ªï¼Œçœ‹çœ‹å“ªä¸ªæ¶æ„æ˜¯æœ€å¥½çš„ã€‚æˆ‘è¿˜æƒ³ä»‹ç»ä¸€äº›åœ¨ **Pytorch** ä¸­å¼€å‘æ·±åº¦å­¦ä¹ åº”ç”¨çš„ä¼Ÿå¤§å·¥å…·ï¼Œè¿™å°±æ˜¯ **Pytorch Lightning** ã€‚æˆ‘ä¼šå‘Šè¯‰ä½ è®©æˆ‘çš„ä»£ç åº“æ›´åŠ ç»“æ„åŒ–æ˜¯å¤šä¹ˆæœ‰å¸®åŠ©ã€‚

æœ¬æ–‡çš„ä¸»è¦ç„¦ç‚¹å°†ä¸»è¦æ˜¯ä¸€æ­¥ä¸€æ­¥åœ°è®²è¿°å¦‚ä½•å®ç°å’Œè¯•éªŒ**é…æ–¹é…¿é€ å™¨**ã€‚è¿™ç¯‡æ–‡ç« ä¸ä¼šè¿‡å¤šåœ°è®¨è®ºè¿™ä¸ªæ¦‚å¿µçš„ç»†èŠ‚ã€‚å°½ç®¡å¦‚æ­¤ï¼Œæˆ‘è¿˜æ˜¯ä¼šæä¾›ä¸€äº›å¥½çš„è¯»ç‰©æ¥å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£è¿™ä¸ªæ¦‚å¿µã€‚å¦‚æœä½ æ˜¯æ–°æ¥çš„ï¼Œä¸è¦æ‹…å¿ƒï¼æˆ‘å°†å¯¹è¿™äº›æ¦‚å¿µè¿›è¡Œæ¸©å’Œçš„æè¿°ã€‚å¦‚æœä½ è¿˜ä¸æ˜ç™½ã€‚ä¸è¦æ‹…å¿ƒï¼

è¿™æ˜¯æˆ‘ä»ä¸€ä½åŒ»å­¦å¤§å¸ˆé‚£é‡Œå¾—åˆ°çš„ç»ˆæåè¨€ï¼Œå®ƒå¯èƒ½ä¼šè®©ä½ ç²¾ç¥æŒ¯å¥‹ğŸ˜†ã€‚

> å¦‚æœä½ ä¸æ˜ç™½ï¼Œä¸è¦æ‹…å¿ƒ
> 
> ~å´æ©è¾¾

# è´®è—å®¤ËŒä»“åº“

å¯¹äºä»»ä½•æƒ³æ·±å…¥ç ”ç©¶ä»£ç çš„äººæ¥è¯´ï¼Œè¿™é‡Œæ˜¯å­˜å‚¨åº“é“¾æ¥:

[](https://github.com/haryoa/ingredbrew.git) [## haryoa/ingredbrew

### åœ¨ GitHub ä¸Šåˆ›å»ºä¸€ä¸ªå¸æˆ·ï¼Œä¸º haryoa/ingredbrew å¼€å‘åšè´¡çŒ®ã€‚

github.com](https://github.com/haryoa/ingredbrew.git) 

å‡ ä¸ªæ³¨æ„äº‹é¡¹:

*   æºä»£ç åœ¨' **recibrew** 'ä¸­æºä»£ç ä¸»è¦ç”¨ Pytorch å†™ï¼Œç”¨ Pytorch Lightning åŒ…è£…ã€‚
*   å­˜å‚¨åº“ä¸­çš„ç¬”è®°æœ¬æ˜¯æ„å»ºä»£ç åº“çš„â€œè‰ç¨¿æœ¬â€ã€‚å¯¹äºä»»ä½•å¯¹æˆ‘å¦‚ä½•æ²®ä¸§åœ°å®ç°æˆ‘çš„æƒ³æ³•æ„Ÿå…´è¶£çš„äººï¼Œè¯·çœ‹ç¬”è®°æœ¬ã€‚(EDA é™¤å¤–)
*   è¦è¿è¡Œ GRU +å·´èµ«è¾¾ç‘™æ³¨æ„åŠ›å®éªŒï¼Œè¯·è®¿é—®è¿™ä¸ª [Colab é“¾æ¥](https://colab.research.google.com/drive/1T_Bp_RSsNpp16wu001YF3REwAYkkD00d?usp=sharing)
*   è¦è¿è¡Œå˜å‹å™¨å®éªŒï¼Œä½¿ç”¨è¿™ä¸ª [Colab é“¾æ¥](https://colab.research.google.com/drive/1S91goRUhoSEu6JcflPuhhm55BUjBTC6g?usp=sharing)

# æ¨¡å‹

æˆ‘åœ¨ç®€ä»‹é‡Œè¯´è¿‡ï¼Œæˆ‘ç”¨äº† 2 ä¸ª **Seq2Seq æ¶æ„**ï¼Œåˆ†åˆ«æ˜¯ **GRU +å·´èµ«è¾¾ç‘™æ³¨æ„**å’Œ**å˜å‹å™¨**ã€‚æˆ‘å°†ç®€è¦æè¿°å®ƒä»¬ä¸­çš„æ¯ä¸€ä¸ªã€‚

## Seq2Seq

é¡¾åæ€ä¹‰ï¼Œseq2seq æ˜¯æ·±åº¦å­¦ä¹ ä¸­çš„ä¸€ç§æ¶æ„â€œæ¨¡å¼â€ï¼Œå®ƒæ¥æ”¶é¡ºåºè¾“å…¥(æ–‡æœ¬ã€éŸ³é¢‘ã€è§†é¢‘)ï¼Œä¹Ÿäº§ç”Ÿé¡ºåºè¾“å‡º(æ–‡æœ¬ã€éŸ³é¢‘ã€è§†é¢‘)ã€‚è¯¥æ¶æ„ä¸»è¦åŒ…å«**ç¼–ç å™¨**å’Œ**è§£ç å™¨**ã€‚**ç¼–ç å™¨**æ˜¯ä¸€ä¸ªæ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œå®ƒå¯¹è¾“å…¥ seq2seq è¿›è¡Œç¼–ç ï¼Œç¼–ç åçš„è¾“å…¥å°†ç”±**è§£ç å™¨è§£ç ï¼Œä»¥å¸®åŠ©äº§ç”Ÿè¾“å‡ºåºåˆ—ã€‚**è§£ç å™¨ä¹Ÿæ˜¯æ·±åº¦å­¦ä¹ æ¨¡å‹ã€‚è¯·å‚è§å›¾åƒ 0 ä»¥æŸ¥çœ‹å¯è§†åŒ–æ•ˆæœã€‚

å®ç° seq2seq çš„ä¸€äº›ç¤ºä¾‹:

1.  **æœºå™¨ç¿»è¯‘**:è¾“å…¥æºè¯­è¨€ï¼Œè¾“å‡ºç›®æ ‡è¯­è¨€
2.  **æ‘˜è¦**:è¾“å…¥æ–‡ç« ï¼Œè¾“å‡ºæ–‡ç« æ‘˜è¦
3.  **é£Ÿå“é…æ–™**:(æœ¬é¡¹ç›®)

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†åªæ¢è®¨ **GRU** å’Œ**å˜å‹å™¨ seq2seq** æ¶æ„ã€‚

å…³äº seq2seq çš„æ›´å¤šä¿¡æ¯ï¼Œå¯ä»¥çœ‹è¿™ä¸ª[é“¾æ¥](https://www.geeksforgeeks.org/seq2seq-model-in-machine-learning/)ã€‚

![](img/18c0827f96fea11c893503c35108553a.png)

å›¾ 0 : Seq2Seq å¯è§†åŒ–

## GRU +æ³¨æ„ seq2seq

æˆ‘å»ºé€ çš„ä¸€ä¸ª **seq2seq** ç”± **GRU** ç¼–ç å™¨å’Œ **GRU** è§£ç å™¨ç»„æˆï¼Œå¸¦æœ‰ **Bahdanau æ³¨æ„**ã€‚æˆ‘å°†åœ¨ä¸‹é¢é€ä¸€ä»‹ç»ã€‚

**é—¨æ§å¾ªç¯å•å…ƒ(GRU)** æ˜¯ RNN çš„å˜ä½“ï¼Œå¤„ç†é¡ºåº(ä¾‹å¦‚æ–‡æœ¬)è¾“å…¥ã€‚è¾“å…¥åºåˆ—ç”±**å¤ä½é—¨**å’Œ**æ›´æ–°é—¨**è¿›è¡Œâ€œé—¨æ§â€ã€‚**æ›´æ–°é—¨**å¢åŠ æˆ–åˆ é™¤åºåˆ—ä¸­æ¯ä¸€æ­¥çš„ä¿¡æ¯ã€‚åŒæ—¶ï¼Œ**å¤ä½é—¨**å†³å®šåœ¨è¿‡å»æ­¥éª¤ä¸­å¿˜è®°å¤šå°‘ä¿¡æ¯ã€‚

å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äº GRU çš„ç»†èŠ‚ï¼Œæˆ‘å»ºè®®ä½ é˜…è¯»è¿™ç¯‡æ–‡ç« (æ„Ÿè°¢è¿ˆå…‹å°”Â·çš®):

[](https://towardsdatascience.com/illustrated-guide-to-lstms-and-gru-s-a-step-by-step-explanation-44e9eb85bf21) [## LSTM å’Œ GRU çš„å›¾è§£æŒ‡å—:ä¸€æ­¥ä¸€æ­¥çš„è§£é‡Š

### å—¨ï¼Œæ¬¢è¿æ¥åˆ°é•¿çŸ­æœŸè®°å¿†(LSTM)å’Œé—¨æ§å¾ªç¯å•ä½(GRU)çš„å›¾è§£æŒ‡å—ã€‚æˆ‘æ˜¯è¿ˆå…‹å°”â€¦

towardsdatascience.com](https://towardsdatascience.com/illustrated-guide-to-lstms-and-gru-s-a-step-by-step-explanation-44e9eb85bf21) 

**æ³¨æ„åŠ›ï¼Œ**ç®€å•æ¥è¯´ï¼Œå­¦ä¹ å˜é‡ä¹‹é—´ä»€ä¹ˆé‡è¦ä»€ä¹ˆä¸é‡è¦æ¥åšä¸€äº›ä»»åŠ¡ã€‚åœ¨æƒ…æ„Ÿåˆ†æä»»åŠ¡ä¸­ï¼Œå½“ä½¿ç”¨æ³¨æ„åŠ›æ—¶ï¼Œå®ƒå¯èƒ½ä¼šå­¦ä¹ ä½¿ç”¨ä»€ä¹ˆä»¤ç‰Œæ¥ä½¿æ¨¡å‹æ›´å®¹æ˜“å­¦ä¹ ã€‚å›¾ 1 å‘Šè¯‰æˆ‘ä»¬ä¸€äº›ä¾‹å­ï¼Œå½“çœ‹åˆ°ä¸€ä¸ªå•è¯å¯¹å…¶ä»–å•è¯è¿›è¡Œâ€œè‡ªæˆ‘å…³æ³¨â€æ—¶ã€‚

ç›´è§‰ä¸Šï¼Œæ³¨æ„åŠ›æ˜¯ä¸€ç§è®°ä½è¾“å…¥é¡ºåºçš„æœºåˆ¶ã€‚åœ¨ç»™å®šä¸€ä¸ªè¾“å‡ºçš„æƒ…å†µä¸‹ï¼Œå®ƒå­¦ä¹ ä»€ä¹ˆæ ·çš„è¾“å…¥æ˜¯æœ€å¥½çš„ã€‚ç»™å®šå•è¯ï¼Œæ³¨æ„åŠ›é€‰æ‹©æ€§åœ°å†³å®šéœ€è¦ä»€ä¹ˆè¾“å…¥ã€‚å®ƒå¯èƒ½ä¼šæé«˜æ¨¡å‹çš„æ€§èƒ½ã€‚

![](img/ad9156e3c4d7d57a4ea70efaa000da18.png)

å›¾ 1:å…¶ä»–æ³¨æ„ç›´è§‚ä¾‹å­ã€‚

åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæ¨¡å‹æƒ³è¦äº†è§£è¾“å…¥(æº)å’Œè¾“å‡ºæ ‡è®°(ç›®æ ‡)çš„é‡è¦æ€§ã€‚è¿™é‡Œæœ‰ä¸€äº›ä¾‹å­

```
Source : **fried** rice
Current token in target : **oil**
The model should learn that **oil** should become attentiveto the **fried** token in the **source.** 
```

> **æ³¨**:
> 
> ä½ ç”¨æ²¹æ¥åšæ²¹ç‚¸é£Ÿå“ï¼Œå¯¹å—ï¼Ÿå‘Šè¯‰æˆ‘ï¼Œå¦‚æœæˆ‘é”™äº†ï¼Œå› ä¸ºæˆ‘åœ¨è¿™æ–¹é¢ä¸€æ— æ‰€çŸ¥ **XDã€‚**

æ³¨æ„åŠ›å…¬å¼å¦‚ä¸‹:

![](img/9b9eb090e51d222e63b50bca5a07ed4d.png)

å›¾äºŒ:æ³¨æ„åŠ›å…¬å¼[æ¥æº:https://www . tensor flow . org/tutorials/text/NMT _ with _ attention](https://www.tensorflow.org/tutorials/text/nmt_with_attention)

æˆ‘ä»¬ä½¿ç”¨ Bahdanau çš„æ³¨æ„åŠ›å…¬å¼ã€‚æ³¨æ„åŠ›çš„è¾“å…¥æ˜¯ä½œä¸º**å€¼(h_t)** çš„æºç¼–ç è¾“å‡º(ç¼–ç å™¨çš„è¾“å‡º)å’Œä½œä¸º**æŸ¥è¯¢(h_s)çš„è§£ç å™¨ GRU å±‚çš„éšè—çŠ¶æ€ã€‚** vï¼ŒW æ˜¯å­¦ä¹ åˆ°çš„å‚æ•°ã€‚

è¦äº†è§£æ›´å¤šä¿¡æ¯ï¼Œæˆ‘é¼“åŠ±ä½ é˜…è¯»è¿™ç¯‡å…³äºæ³¨æ„åŠ›çš„æŠ€æœ¯ç»†èŠ‚çš„æ–‡ç« ã€‚

[](https://lilianweng.github.io/lil-log/2018/06/24/attention-attention.html) [## æ³¨æ„ï¼Ÿç«‹æ­£ï¼

### è¿‘å¹´æ¥ï¼Œæ³¨æ„åŠ›å·²ç»æˆä¸ºæ·±åº¦å­¦ä¹ ç¤¾åŒºä¸­ä¸€ä¸ªç›¸å½“æµè¡Œçš„æ¦‚å¿µå’Œæœ‰ç”¨çš„å·¥å…·ã€‚åœ¨è¿™ä¸ªâ€¦

lilianweng.github.io](https://lilianweng.github.io/lil-log/2018/06/24/attention-attention.html) 

## å˜å‹å™¨åºåˆ— 2 åºåˆ—

å˜å‹å™¨æ˜¯**å½“å‰å…ƒç‚’ä½œåŸºç¡€**æ·±åº¦å­¦ä¹ æ¶æ„ã€‚ç°æœ‰çš„ NLP æ¶æ„ä¸»è¦ä½¿ç”¨å˜å‹å™¨ä½œä¸ºåŸºç¡€æ¶æ„ã€‚è¿™ç§æ¶æ„å‚¬ç”Ÿäº†å¾ˆå¤šèŠéº»è¡—å‘½åçš„æ·±åº¦å­¦ä¹ æ¶æ„ï¼Œåƒä¼¯ç‰¹å’Œ GPTã€‚

**è½¬æ¢å™¨**æœ¬èº«æ˜¯ä¸€ä¸ª **seq2seq** æ¶æ„ï¼Œç”±ç¼–ç å™¨å’Œè§£ç å™¨ç«¯çš„å‡ ä¸ª**è‡ªå…³æ³¨å±‚**ç»„æˆ(GRU seq2seq åœ¨ç¼–ç å™¨å’Œè§£ç å™¨ç«¯ä½¿ç”¨ GRU)ã€‚è¯¥å˜å‹å™¨ç¼“è§£äº† GRU **éœ€è¦ç­‰å¾…æ¯ä¸ªé¡ºåºæ­¥éª¤çš„è¿›ç¨‹**çš„å¼±ç‚¹ã€‚è½¬æ¢å™¨åŒæ—¶å¤„ç†å®ƒä»¬ä¸­çš„æ¯ä¸€ä¸ªï¼Œä½¿è½¬æ¢å™¨èƒ½å¤Ÿå¹¶è¡ŒåŒ–ã€‚

æ¶æ„å¯è§†åŒ–å¦‚å›¾ 3 æ‰€ç¤ºã€‚å…³äº Transformer å¦‚ä½•å·¥ä½œæ›´å¤šä¿¡æ¯ï¼Œæˆ‘å¼ºçƒˆå»ºè®®æ‚¨è®¿é—®è¿™ç¯‡ä¼˜ç§€çš„æ–‡ç« ã€‚

[](http://jalammar.github.io/illustrated-transformer/) [## å›¾ç¤ºçš„å˜å‹å™¨

### è®¨è®º:é»‘å®¢æ–°é—»(65 åˆ†ï¼Œ4 æ¡è¯„è®º)ï¼ŒReddit r/MachineLearning (29 åˆ†ï¼Œ3 æ¡è¯„è®º)ç¿»è¯‘â€¦

jalammar.github.io](http://jalammar.github.io/illustrated-transformer/) ![](img/c18e6a094b65ce871476c8929da2ed33.png)

å›¾ 3:å˜å½¢é‡‘åˆšåœ¨[æ³¨æ„ä½ æ‰€éœ€è¦çš„ä¸€åˆ‡](https://papers.nips.cc/paper/7181-attention-is-all-you-need.pdf)

# æ•°æ®é›†ã€EDA å’Œæ•°æ®é¢„å¤„ç†

## èµ„æ–™ç»„

![](img/21384d494f10f636e07bbbb3c1a4ad4f.png)

å†è§é˜¿è¨å§†ã€‚æ¥æº:[ç»´åŸºç™¾ç§‘](https://id.wikipedia.org/wiki/Berkas:Sayur_asem_vegetable_soup.jpg) ( CC BY-SA 2.0)

åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ä½¿ç”¨äº†ä¸€ä¸ªé£Ÿç‰©é£Ÿè°±æ•°æ®é›†ã€‚æˆ‘è¯•ç€åœ¨è°·æ­Œæœç´¢é£Ÿç‰©é£Ÿè°±ï¼Œåœ¨ **Kaggle** æ‰¾åˆ°äº†ä¸€ä¸ªå°å°¼é£Ÿç‰©é£Ÿè°±æ•°æ®é›†ã€‚å› ä¸ºè¿™æ˜¯æˆ‘æƒ³è¦çš„æ•°æ®ï¼Œæ‰€ä»¥æˆ‘å†³å®šç”¨å®ƒä½œä¸ºæˆ‘é¡¹ç›®çš„æ•°æ®é›†ã€‚

æ•°æ®é›†ä½¿ç”¨å°åº¦å°¼è¥¿äºšè¯­è¨€ã€‚æˆ‘è¯•å›¾ç”¨è‹±è¯­æœç´¢æ•°æ®é›†é£Ÿç‰©é£Ÿè°±ï¼Œä½†æˆ‘æ²¡æœ‰æ‰¾åˆ°ã€‚æ‰€ä»¥ï¼Œæˆ‘æ”¾å¼ƒäº†ï¼Œå†³å®šç”¨å°å°¼çš„ã€‚

ä¸è¦æ‹…å¿ƒè¯­è¨€ã€‚æˆ‘å°†æä¾›ä¸€äº›å…³äºæ•°æ®å«ä¹‰çš„è§£é‡Š(å¦‚æœ‰å¿…è¦)ã€‚æˆ‘æƒ³å¼ºè°ƒçš„æ˜¯æˆ‘åšè¿™ä¸ªé¡¹ç›®çš„è¿‡ç¨‹ã€‚ä½ å¯ä»¥æŠŠæ•°æ®è½¬æ¢æˆä½ æƒ³è¦çš„å…¶ä»–é£Ÿç‰©é£Ÿè°±æ•°æ®é›†ã€‚

è¿™æ˜¯æ•°æ®é›†:

[](https://www.kaggle.com/canggih/indonesian-food-recipes) [## å°åº¦å°¼è¥¿äºšé£Ÿç‰©é£Ÿè°±

### 14000 ä»½é¸¡è‚‰ã€ç¾Šè‚‰ã€ç‰›è‚‰ã€é¸¡è›‹ã€è±†è…ã€è±†è±‰å’Œé±¼çš„é£Ÿè°±

www.kaggle.com](https://www.kaggle.com/canggih/indonesian-food-recipes) 

åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘æ¢ç´¢å’Œåˆ†ææ•°æ®ï¼Œä»¥ç¡®å®šæˆ‘å¤„ç†ä»€ä¹ˆæ ·çš„æ•°æ®ã€‚ä¹‹åï¼Œæˆ‘æ ¹æ® seq2seq æ¨¡å‹çš„éœ€è¦å¯¹æ•°æ®è¿›è¡Œäº†é¢„å¤„ç†ã€‚

## æ¢ç´¢æ€§æ•°æ®åˆ†æ

æˆ‘åšçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯çœ‹æ•°æ®çš„æ ¼å¼ã€‚æ•°æ®åœ¨é‡Œé¢ã€‚csv 'æ ¼å¼ã€‚æ‰€ä»¥æˆ‘åšäº†è¿™ä¸ª:

```
df = pd.read_csv("../data/raw/indonesia_food_recipe.csv")
```

ä»¥ä¸‹æ˜¯ä¸€äº›ä¾‹å­:

![](img/a0c7b42f9170e4552e7e8791cdb74c9a.png)

è¯¥æ•°æ®åŒ…å«'**æ ‡é¢˜**'ã€**é…æ–™**'ã€**æ­¥éª¤**'ã€**çˆ±**'ã€**ç½‘å€**'ã€ã€åŸºæœ¬ _ é…æ–™ã€‘ã€‚**Titleâ€™**æ˜¯é£Ÿç‰©åç§°ï¼Œ **Steps** æ˜¯å¦‚ä½•çƒ¹é¥ªé£Ÿç‰©ï¼ŒLoves æ˜¯ç”¨æˆ·å–œæ¬¢åœ¨ç½‘ç«™ä¸­ï¼Œâ€œbasic_ingredientâ€æ˜¯åˆ¶ä½œé£Ÿç‰©æ‰€éœ€çš„æ ¸å¿ƒé…æ–™

> **æ³¨**
> 
> (' ayam' ==é¸¡)ã€‚

å› ä¸ºè¿™ä¸ªé¡¹ç›®æ˜¯**â€˜é¢„æµ‹é…æ–™ç»™å‡ºé£Ÿç‰©åç§°â€™**æ­¤é¡¹ç›®éœ€è¦çš„åˆ—æ˜¯â€œæ ‡é¢˜â€ã€â€œæˆåˆ†â€å’Œâ€œåŸºæœ¬æˆåˆ†â€ã€‚åˆ†å‰²æ•°æ®é›†éœ€è¦â€œbasic_ingredientâ€ã€‚

ç„¶åï¼Œæˆ‘å†³å®šæå–è¿™äº›ç»Ÿè®¡æ•°æ®æ¥å›ç­”è¿™ä¸ªæè¿°æ€§çš„é—®é¢˜:

1.  ä»¤ç‰Œæ•°é‡
2.  å”¯ä¸€ä»¤ç‰Œçš„æ•°é‡
3.  å‰ 20 ä¸ªé¢‘ç‡å”¯ä¸€ä»¤ç‰Œ

ä¸ºæ­¤ï¼Œæˆ‘ä½¿ç”¨æˆ‘çš„ python åŒ…æ¥æå–å®ƒä»¬ä¸­çš„æ¯ä¸€ä¸ªã€‚æˆ‘æŠŠå®ƒå‘½åä¸º **Exploda(æ¢ç´¢æ•°æ®)ã€‚**è¯¥åŒ…æå–æ•°æ®çš„åŸºæœ¬ç»Ÿè®¡æ•°æ®ã€‚

> æˆ‘çš„æ•…äº‹/è§‚ç‚¹
> 
> ç›®å‰è¿™ä¸ªåŒ…æ˜¯ç§æœ‰çš„ã€‚ç„¶è€Œï¼Œå¦‚æœæœ‰äººå¯¹å®ƒæ„Ÿå…´è¶£ï¼Œæˆ‘å¯èƒ½ä¼šæƒ³å¼€æºå®ƒã€‚

**EDA æˆåˆ†**

```
from exploda.explore import get_stat
result = get_stat(df, 'Ingredients', ['get_total_instances', 'get_value_counts_column_and_unique_token', 'get_sum_count_token',
                                      'get_stat_token'])
print('total_instance : ', result['get_total_instances'])
print('total token : ', result['get_sum_count_token'])
print('unique token : ', result['get_value_counts_column_and_unique_token']['total_unique'])
```

**è¾“å‡º:**

![](img/6a14b08b86165364bc2723c7297abb2f.png)

**æ•°æ®é›†ä¸­å‰ 20 ä¸ªä»¤ç‰Œ**

```
[('1', 48903),
 ('2', 30534),
 ('bawang', 27729),
 ('secukupnya', 20039),
 ('merah', 16548),
 ('buah', 15676),
 ('siung', 14954),
 ('putih', 14403),
 ('3', 13590),
 ('garam', 12228),
 ('sdm', 11257),
 ('daun', 10905),
 ('4', 10013),
 ('sdt', 9542),
 ('cabe', 9451),
 ('5', 9141),
 ('gula', 7777),
 ('bumbu', 6922),
 ('air', 6892),
 ('iris', 6244)]
```

æ‰€ä»¥åœ¨æ•°æ®é›†ä¸­ï¼Œâ€˜1â€™å’Œâ€˜2â€™å‡ºç°çš„é¢‘ç‡æœ€é«˜ã€‚å®ƒä»¬å¯èƒ½æ˜¯ä¸€ç§æˆåˆ†çš„æ•°é‡(ä¾‹å¦‚ï¼Œ1 ä»¶ï¼Œ2 å…¬æ–¤)ã€‚â€œç‹éœ¸â€æˆ–**æ´‹è‘±æ˜¯å°åº¦å°¼è¥¿äºšä¸€ç§ç›¸å½“å¸¸è§çš„é£Ÿæï¼Œå…¶å‡ºç°é¢‘ç‡ä½å±…ç¬¬ä¸‰ã€‚**

æ€»è€Œè¨€ä¹‹ï¼Œå¤§å¤šæ•°å‰ 20 ä¸ªä»¤ç‰Œæ˜¯å…³äºå¦‚ä½•åº”ç”¨â€œsecukupnyaâ€(å……åˆ†)ã€â€œbuahâ€(æ°´æœ)ã€1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5ã€sdmã€SDTâ€œirisâ€(åˆ‡ç‰‡)ç­‰æˆåˆ†çš„åº¦é‡ã€‚

å®ƒè¿˜å«æœ‰å—æ¬¢è¿çš„æˆåˆ†ï¼Œå¦‚â€œç‹éœ¸æ™®æâ€(å¤§è’œ)ã€â€œç‹éœ¸æ¢…æ‹‰â€(é¦™è‘±)ã€â€œé“æ©â€(å¶å­)ã€â€œå¡å¸ƒâ€(è¾£æ¤’)ã€â€œå¤æ‹‰â€(ç³–)ã€â€œç©ºæ°”â€(æ°´)ã€‚

**EDA é£Ÿå“åç§°**

```
result2 = get_stat(df, 'Title', ['get_total_instances', 'get_value_counts_column_and_unique_token', 'get_sum_count_token'])
print('total_instance : ', result2['get_total_instances'])
print('total token : ', result2['get_sum_count_token'])
print('unique token : ', result2['get_value_counts_column_and_unique_token']['total_unique'])
```

**è¾“å‡º:**

![](img/baeb2b1cce5f5c19a7b6311e4bd645c6.png)

æ­£å¦‚æ‰€æ–™ï¼Œé£Ÿå“åç§°çš„æ€»çš„å’Œå”¯ä¸€çš„ä»¤ç‰Œä½äºé…æ–™ã€‚

**æ•°æ®é›†ä¸­å‰ 20 ä¸ªä»¤ç‰Œ**

```
[('tahu', 2557),
 ('tempe', 2269),
 ('ayam', 1999),
 ('telur', 1768),
 ('sapi', 1611),
 ('kambing', 1442),
 ('goreng', 1000),
 ('daging', 928),
 ('ikan', 842),
 ('tumis', 748),
 ('pedas', 733),
 ('bumbu', 607),
 ('ala', 572),
 ('kecap', 485),
 ('telor', 453),
 ('balado', 434),
 ('sambal', 428),
 ('dan', 426),
 ('sate', 417),
 ('beef', 406)]
```

![](img/a3ffee3054429cb3f9bbd2dfc74f54fa.png)

ç”±[ç‘å®‰Â·æ˜†å¡”å°”](https://unsplash.com/@ryanquintal?utm_source=medium&utm_medium=referral)åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„çš„ç…§ç‰‡

é£Ÿå“åç§°ä¸­å‰ 20 ä¸ªæœ€é«˜é¢‘ç‡æ ‡è®°ä¸­çš„å¤§å¤šæ•°æ˜¯ä¸»è¦æˆåˆ†ï¼Œå¦‚â€œtahuâ€(è±†è…)ã€tempeã€â€œayamâ€(é¸¡è‚‰)ã€â€œtelurâ€(é¸¡è›‹)ã€â€œsapiâ€(ç‰›è‚‰)ã€â€œkambingâ€(å±±ç¾Š)ã€â€œdagingâ€(è‚‰)ã€â€œikanâ€(é±¼)ã€â€œtelorâ€(ä¹Ÿæ˜¯é¸¡è›‹)ã€â€œsateâ€(æ²™çˆ¹)ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå®ƒä»¬æ˜¯é£Ÿç‰©çš„å‘³é“(â€œè¾£â€)

é€šè¿‡è¿™ç§æ¢ç´¢ï¼Œæˆ‘ç›¸ä¿¡è¯¥æ¨¡å‹å¯ä»¥è¯†åˆ«ç»™å®šé£Ÿç‰©åç§°çš„æˆåˆ†ã€‚å‡ ä¸ªæˆåˆ†åç§°æ ‡è®°æˆä¸ºé£Ÿå“åç§°çš„ä¸€éƒ¨åˆ†ã€‚è®©æˆ‘ä»¬ç¨åæµ‹è¯•ã€‚æˆ‘ç›¸ä¿¡åƒâ€˜pedasâ€™(è¾£)è¿™æ ·çš„é£Ÿç‰©åç§°ä¸€å®šä¼šè¾“å‡ºâ€˜cabeâ€™(è¾£æ¤’)

> **æˆ‘çš„æ•…äº‹/è§‚ç‚¹**
> 
> æˆ‘å¸Œæœ›è¿™äº›æ•°æ®ä¸æ˜¯å¾ˆç³Ÿç³•ï¼Œä¾‹å¦‚ï¼ŒåŒ…å«â€œç‚¸é¸¡â€çš„é£Ÿå“åç§°ï¼Œä»¥åŠç”¨é±¼ä»£æ›¿é¸¡è‚‰ä½œä¸ºé…æ–™ğŸ˜…ã€‚

â€”

> **æˆ‘çš„æ•…äº‹/è§‚ç‚¹**
> 
> å‡ºç°é¢‘ç‡æœ€é«˜çš„ä¸¤ä¸ªé£Ÿç‰©åç§°æ˜¯â€œtahuâ€(è±†è…)å’Œâ€œtempeâ€(è°·æ­Œæœç´¢)ã€‚ä¾›ä½ å‚è€ƒ,â€˜tahuâ€™å’Œ tempe æ˜¯æˆ‘ä»¬åœ¨å°åº¦å°¼è¥¿äºšåƒçš„æœ€å¸¸è§çš„åŸºæœ¬é£Ÿç‰©ã€‚

## æ•°æ®é¢„å¤„ç†

ä»¥ä¸‹æ˜¯æˆ‘å¯¹æ•°æ®è¿›è¡Œçš„é¢„å¤„ç†:

1.  å°†â€œ/nâ€æ”¹ä¸ºâ€œ||â€ä½œä¸ºé…æ–™åˆ†éš”ç¬¦
2.  å°å†™å­—æ¯
3.  åˆ é™¤é‡å¤é¡¹
4.  åˆ é™¤éå­—æ¯æ•°å­—å­—ç¬¦
5.  åˆ†å¼€é…æ–™åŠå…¶å°ºå¯¸(â€œ15 å…‹â€->â€œ15 å…‹â€)
6.  åˆ é™¤ä¸€äº›è¶…è¿‡ 120 ä¸ªä»¤ç‰Œçš„å®ä¾‹ã€‚æˆ‘é€‰æ‹©è¿™ä¸ªè¶…å‚æ•°æ˜¯å› ä¸ºå®ƒå¯ä»¥è¢« 4 é™¤(å¯¹äºå˜å‹å™¨ä¸­çš„å¤šå¤´)å¹¶ä¸”å¤§äº Q3 (84) +æ ‡å‡†å·®(31)ã€‚

ä»¥ä¸‹æ˜¯åŸºäº**åŸºæœ¬æˆåˆ†**çš„æœ€ç»ˆç»Ÿè®¡æ•°æ®:

```
tempe      1958 
telur      1931  # egg
tahu       1931  # tofu
ikan       1858  # fish
ayam       1772  # chicken
sapi       1760  # beef
kambing    1590  # goat meat
Name: basic_ingredient, dtype: int64
```

ç„¶åï¼Œæˆ‘ä½¿ç”¨**sk learn . model _ selection . train _ test _ split åˆ°**ç¡®ä¿å¹³è¡¡åˆ†å‰²**å°†æ•°æ®é›†åˆ†å‰²æˆè®­ç»ƒé›†ã€å¼€å‘é›†å’Œæµ‹è¯•é›†ã€‚**æˆ‘æ ¹æ®â€˜åŸºæœ¬ _ é…æ–™â€™åˆ—è¿›è¡Œäº†æ‹†åˆ†ã€‚æ¯”ä¾‹æ˜¯ 80% 10% 10%ã€‚

```
train_df, remainder_df, _, _ = train_test_split(df, df['basic_ingredient'], test_size=0.2, random_state=234)
dev_df, test_df, _, _ = train_test_split(remainder_df, remainder_df['basic_ingredient'], test_size=0.5, random_state=345)
```

ç„¶åï¼Œæˆ‘å°†å®ƒä»¬è¾“å‡ºåˆ°â€œå·²å¤„ç†â€æ–‡ä»¶å¤¹ä¸­

```
train_df.to_csv('../data/processed/train.csv',index_label='no')
dev_df.to_csv('../data/processed/dev.csv', index_label='no')
test_df.to_csv('../data/processed/test.csv', index_label='no')
```

æ•°æ®æ“ä½œå’Œæ¢ç´¢å·²ç»å®Œæˆ:)

æœ‰å…³ EDA çš„å®æ–½ï¼Œè¯·å‚è§æœ¬ç¬”è®°:

[](https://github.com/haryoa/ingredbrew/blob/master/notebooks/00001-eda-data-and-split-train-dev-test.ipynb) [## haryoa/ingredbrew

### ç¬”è®°æœ¬

github.com](https://github.com/haryoa/ingredbrew/blob/master/notebooks/00001-eda-data-and-split-train-dev-test.ipynb) 

# è¯„ä¼°æŒ‡æ ‡

åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ **BLEU** ä½œä¸ºè¯„ä¼°æŒ‡æ ‡æ¥æ¯”è¾ƒ GRU å’Œ Transformer çš„æ€§èƒ½ã€‚

## è“è‰²

BLEU ( **åŒè¯­è¯„ä¼°æ›¿è¡¥**)æ˜¯ä¸€ä¸ªæµè¡Œçš„æŒ‡æ ‡ï¼Œå¹¿æ³›ç”¨äº seq2seq ä»»åŠ¡ï¼Œå¦‚æœºå™¨ç¿»è¯‘ã€‚BLEU çš„ä¸»è¦æ€æƒ³æ˜¯æ£€æŸ¥åœ¨é¢„æµ‹è¾“å‡ºå’Œåœ°é¢çœŸå®ä¸­æ˜¯å¦æœ‰è®¸å¤šè®°å·é‡å ã€‚ä½¿ç”¨çš„ n-å…‹æ˜¯ 1 å…‹ã€2 å…‹ã€3 å…‹å’Œ 4 å…‹ã€‚

è¦äº†è§£æ›´å¤šå…³äº BLEU åŠå…¶é—®é¢˜çš„ä¿¡æ¯ï¼Œæˆ‘æ¨èé˜…è¯»è¿™ç¯‡æ–‡ç« (è°¢è°¢ä½ ï¼Œ [Rachael Tatman](https://medium.com/u/703b09baff4e?source=post_page-----dbc2a4e37383--------------------------------) å…³äº BLEU çš„ç²¾å½©æ–‡ç« :)

[](https://towardsdatascience.com/evaluating-text-output-in-nlp-bleu-at-your-own-risk-e8609665a213) [## è¯„ä¼° NLP: BLEU ä¸­çš„æ–‡æœ¬è¾“å‡ºé£é™©è‡ªæ‹…

### åˆšè¿›å…¥ NLP çš„äººç»å¸¸é—®æˆ‘çš„ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œå½“ç³»ç»Ÿçš„è¾“å‡ºâ€¦

towardsdatascience.com](https://towardsdatascience.com/evaluating-text-output-in-nlp-bleu-at-your-own-risk-e8609665a213) 

> **æˆ‘çš„æ•…äº‹/çœ‹æ³•**
> 
> TIL(ä»Šå¤©æˆ‘æ‰çŸ¥é“)å…³äº BLEU çš„ç¼©å†™æ¥æºäº(**åŒè¯­è¯„ä¼°å€™è¡¥**)ã€‚åœ¨æˆ‘å†™è¿™ç¯‡æ–‡ç« ä¹‹å‰ï¼Œæˆ‘ä»¥ä¸º BLEU æ˜¯éšæœºå‘½åçš„ã€‚

# è§£ç ç­–ç•¥

![](img/876e078f8ca0ee19a46a95015bd0f42e.png)

å›¾ 4:è´ªå©ªè§£ç ç­–ç•¥

å½“æˆ‘ä»¬å®ç°ä¸€ä¸ªç”Ÿæˆæœºå™¨å­¦ä¹ ç³»ç»Ÿæ—¶ï¼Œæˆ‘ä»¬å¿…é¡»å†³å®šå¦‚ä½•ç”Ÿæˆè¾“å‡ºåºåˆ—ã€‚åœ¨æˆ‘ä»¬çš„ seq2seq ç³»ç»Ÿä¸­ï¼Œ**è§£ç å™¨**å°†ä¸ºæ¯ä¸€æ­¥è¾“å‡º**ç½®ä¿¡åº¦å¾—åˆ†** (softmax æ¦‚ç‡åˆ†å¸ƒ)ã€‚é—®é¢˜æ˜¯ï¼Œæˆ‘ä»¬å¦‚ä½•ä½¿ç”¨æ¯ä¸€æ­¥çš„ç½®ä¿¡åº¦ï¼Ÿ

ä¸€ç§é€šç”¨çš„æ–¹æ³•æ˜¯**è´ªå©ªæœç´¢è§£ç å™¨ã€‚**ç­–ç•¥è¶³å¤Ÿç®€å•ï¼›åªéœ€é€‰æ‹©æ¯ä¸€æ­¥çš„**æœ€é«˜**ç½®ä¿¡åº¦å¾—åˆ†ï¼Œç›´åˆ°æ‚¨æ‰¾åˆ°åœæ­¢æ ‡è®°(<EOS>â€™)ã€‚å°±æ˜¯è¿™æ ·ã€‚

> **æ³¨**
> 
> è®°ä½è§£ç ç­–ç•¥æ˜¯åšæ¨ç†çš„æ—¶å€™ç”¨çš„ï¼Œä¸æ˜¯è®­ç»ƒã€‚

æé†’ä¸€ä¸‹ï¼Œseq2seq ç”±è§£ç å™¨å’Œç¼–ç å™¨ç»„æˆã€‚è¾“å…¥å°†è¢«ç¼–ç æˆæŸç§ä¸œè¥¿(å®é™…ä¸Šæ˜¯ä¸€ä¸ªçŸ¢é‡)ï¼Œç”±è§£ç å™¨å¯¹æ¯ä¸€æ­¥è¿›è¡Œè§£ç ã€‚ç„¶åï¼Œå®ƒå°†ç”Ÿæˆè¯æ±‡è¡¨ä¸­æ¯ä¸ªå•è¯çš„ç½®ä¿¡åº¦å¾—åˆ†ã€‚ç„¶åï¼Œæˆ‘ä»¬é€‰æ‹©æœ€é«˜åˆ†ã€‚

è®©æˆ‘ä»¬æ¥çœ‹ä¸€äº›ä¾‹å­:

```
Encoder : Encoder of seq2seqDecoder : Decoder of seq2seq
<s> and </s> are start and end special token respectivelyinput = "<s> fried chicken </s>"
encoder_output, hidden_variable = Encoder(input)**STEP 1:**target_input = "<s>"
decoded, hidden_variable : Decoder(target_input, encoder_output, hidden_variable)Output decoded example:.
.
chili 0.01
**chicken 0.95 <- we choose the highest (greedy)**
fish 0.03
egg 0.01
.
.target_input = "<s> chicken"**STEP 2:
target_input = "<s> chicken"** decoded, hidden_variable : Decoder(target_input, encoder_output, hidden_variable)Output decoded example:.
.
|| 1.00 **<- we choose the highest (greedy)**
chicken 0.00
fish 0.00
egg 0.00
.
.target_input = "<s> chicken || "**STEP 3:
target_input = "<s> chicken ||"** decoded, hidden_variable : Decoder(target_input, encoder_output, hidden_variable)Output decoded example:.
.
|| 0.00 
chicken 0.00
fish 0.00
egg 0.00
**oil 1.00  <- we choose the highest (greedy)**
.
.target_input = "<s> chicken || oil "**STEP 4:
target_input = "<s> chicken || oil"** decoded, hidden_variable : Decoder(target_input, encoder_output, hidden_variable)Output decoded example:.
.
|| 0.00 
chicken 0.00
fish 0.05
egg 0.30
oil 0.20 **</s>**  **0.55 <- we choose the highest (greedy)**
.
.target_input = "<s> chicken || oil </s>"
**END**
```

ä¸Šé¢çš„ä¾‹å­åŸºæœ¬ä¸Šå°±æ˜¯ seq2seq è´ªå©ªè§£ç çš„å·¥ä½œåŸç†ã€‚

è¿˜æœ‰å…¶ä»–è§£ç ç­–ç•¥ï¼Œå¦‚**æ³¢æŸæœç´¢ã€Top-k é‡‡æ ·å’Œ top-p é‡‡æ ·ã€‚**é˜»æ­¢æˆ‘åˆ›ä½œ 60 åˆ†é’Ÿé˜…è¯»æ–‡ç« ğŸ˜œï¼Œæˆ‘å†³å®šåªç”¨è´ªå¿ƒæœç´¢è§£ç ã€‚

> **æˆ‘çš„æ•…äº‹/è§‚ç‚¹**
> 
> ä½œä¸ºä¸€ä¸ªå¼•å­ï¼Œæˆ‘è®¡åˆ’å°†æ¥å‘å¸ƒä¸€ç¯‡å…³äºé‡‡æ ·ç­–ç•¥çš„æ–°æ–‡ç« ï¼Œå¹¶å¯¹å®ƒä»¬è¿›è¡Œæ¯”è¾ƒ:)

# å±¥è¡Œ

## ä½¿ç”¨çš„åº“

1.  Pytorch 1.5.1 :ä¸€ä¸ªæµè¡Œçš„æ·±åº¦å­¦ä¹ æ¡†æ¶æ˜¯ç”¨ Python å†™çš„
2.  Torchtext 0.6.0 :ä¸€ä¸ªä¸“æ³¨äºåœ¨ Pytorch ä¸Šå¤„ç†æ–‡æœ¬çš„åº“
3.  Sacrebleu 1.4.10 :è®¡ç®— bleu çš„å·¥å…·åŒ…
4.  **py torch Lightning 0 . 8 . 1:**py torch æ–°çš„å¼ºå¤§æ‰©å±•ã€‚å¦‚æœä½ å‘ç° Pytorch ä¸­éœ€è¦ç±»ä¼¼ **Keras çš„**æ¡†æ¶(å›è°ƒï¼)å’Œä¸€ä¸ªä½¿ä½ çš„ä»£ç æ›´æ•´æ´å’Œæ›´é«˜çš„å¯é‡ç”¨æ€§çš„ä¼Ÿå¤§çš„èŠ‚çœè€…ï¼Œæˆ‘å¼ºçƒˆ**é¼“åŠ±**ä½ ä½¿ç”¨è¿™ä¸ªåŒ…ï¼è°¢è°¢ä½ ï¼Œå¨å»‰Â·æ³•å°”è‚¯å’Œä»–çš„å›¢é˜Ÿï¼Œæ„Ÿè°¢ä½ ä»¬ä»¤äººæ•¬ç•çš„åŒ…è£¹ğŸ˜„
5.  **Pandas 1.0.5: Python å¸¸ç”¨æ•°æ®è¡¨æ ¼æ“ä½œåŒ…. 3**

æ¥è‡ª`pytorch-lightning` GitHub åŒ…:

> **æ³¨**
> 
> Lightning æ˜¯ç»„ç»‡ PyTorch ä»£ç çš„ä¸€ç§æ–¹å¼ï¼Œå¯ä»¥å°†ç§‘å­¦ä»£ç ä»å·¥ç¨‹ä¸­åˆ†ç¦»å‡ºæ¥ã€‚å®ƒæ›´åƒæ˜¯ PyTorch é£æ ¼æŒ‡å—ï¼Œè€Œä¸æ˜¯æ¡†æ¶ã€‚
> 
> åœ¨ Lightning ä¸­ï¼Œæ‚¨å°†ä»£ç ç»„ç»‡æˆ 3 ä¸ªä¸åŒçš„ç±»åˆ«:
> 
> ç ”ç©¶ä»£ç (åœ¨ç…§æ˜æ¨¡å—ä¸­)ã€‚
> 
> å·¥ç¨‹ä»£ç (ä½ åˆ é™¤ï¼Œå¹¶ç”±åŸ¹è®­å¸ˆå¤„ç†)ã€‚
> 
> éå¿…è¦çš„ç ”ç©¶ä»£ç (æ—¥å¿—ç­‰â€¦è¿™åœ¨å›è°ƒä¸­)ã€‚

â€”

> **æˆ‘çš„æ•…äº‹/è§‚ç‚¹**
> 
> åªæœ‰æˆ‘åœ¨ç”¨çº¯ Pytorch ç¼–å†™ä»£ç æ—¶ï¼Œåœ¨è§£å†³ä»£ç å¯è¯»æ€§å’Œç»“æ„åŒ–æ–¹é¢æœ‰å›°éš¾å—ï¼Ÿè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¥å‰çš„æ–‡ç« éƒ½æ˜¯ç”¨ Keras å†™çš„ã€‚

## ä»¤ç‰Œè¡¨ç¤º

æˆ‘ç”¨çš„æ˜¯è¯ç´¢å¼•é¡ºåºè¡¨ç¤ºï¼Œä¼šè¢«æ¨¡å‹è½¬åŒ–ä¸ºè¯åµŒå…¥ã€‚ä½¿ç”¨`nltk.word_tokenizer`ä»å¥å­ä¸­å¯¹æ ‡è®°è¿›è¡Œæ ‡è®°åŒ–(æ‹†åˆ†)ã€‚æˆ‘ç”¨ torchtext åº“å¯¹å®ƒè¿›è¡Œäº†å¤„ç†ï¼Œå®ƒå°†æŠŠæ¯ä¸ªæ ‡è®°é¡ºåºç¼–ç æˆæ•°ç»„ä¸­çš„ç´¢å¼•è¡¨ç¤ºã€‚æˆ‘åŸºäºè®­ç»ƒé›†æ„å»ºäº†ä»¤ç‰Œè¯æ±‡è¡¨ã€‚æˆ‘å°† init å’Œ end token åˆ†åˆ«è®¾ç½®ä¸º< s >å’Œ< /s >ã€‚

åœ¨ç”Ÿæˆæ¨¡å‹ä½¿ç”¨çš„è¿­ä»£å™¨æ—¶ï¼Œæˆ‘ä½¿ç”¨äº† torchtext.data.BucketIteratorï¼Œå®ƒå°†æ ¹æ®é£Ÿå“åç§°æ ‡è®°çš„é•¿åº¦å¯¹æ‰¹æ¬¡è¿›è¡Œæ’åºã€‚ä¸‹é¢æ˜¯å…³äºå¦‚ä½•å¤„ç†å’Œæ„é€ è¿­ä»£å™¨çš„ä»£ç (æ‘˜è‡ªæˆ‘çš„æºä»£ç )ã€‚

```
Example:
'fried rice' -> '<s> fried rice </s>' -> [2, 4342, 42432, 3]
```

## å»ºæ¨¡

æˆ‘ç”¨ PyTorch lightning æ¥æ„å»º PyTorch ä»£ç ã€‚

## **GRU +å…³æ³¨**

æˆ‘ä½¿ç”¨äº†æ¥è‡ª [Tensorflow NMT æ³¨æ„åŠ›æ•™ç¨‹](https://www.tensorflow.org/tutorials/text/nmt_with_attention)çš„ä»£ç ï¼Œå¹¶å°†å®ƒä»¬æ”¹å†™æˆ Pytorchã€‚æˆ‘è¿˜æ·»åŠ äº†ä¸€äº›å°åŠŸèƒ½ï¼Œæ¯”å¦‚åœ¨è§£ç å™¨ç«¯å¯ç”¨åŒå‘å’Œå¤šå±‚ GRU(è™½ç„¶æˆ‘æ²¡æœ‰ä½¿ç”¨å®ƒğŸ˜›).ä½ å¯ä»¥åœ¨è¿™ä¸ªé“¾æ¥é‡Œçœ‹åˆ°ä»£ç (æˆ‘çš„å›è´­):

[](https://github.com/haryoa/ingredbrew/blob/master/recibrew/nn/gru_bahdanau.py) [## haryoa/ingredbrew

### åœ¨ GitHub ä¸Šåˆ›å»ºä¸€ä¸ªå¸æˆ·ï¼Œä¸º haryoa/ingredbrew å¼€å‘åšè´¡çŒ®ã€‚

github.com](https://github.com/haryoa/ingredbrew/blob/master/recibrew/nn/gru_bahdanau.py) 

æˆ‘å°†å®ƒä»¬ç»„åˆåœ¨ Pytorch Lightning æ¨¡å‹ç•Œé¢ä¸­ã€‚å‚è§ä¸Šé¢çš„ä»£ç ç‰‡æ®µã€‚

åœ¨ forward å‡½æ•°ä¸­ï¼Œæˆ‘æŠŠ forward åˆ†ä¸º`forward_encoder` å’Œ`forward_decoder_train` ã€‚`forward_encoder` å°†æ¥æ”¶ä¿¡å·æºè¾“å…¥ï¼Œå¹¶å°†å…¶ç¼–ç æˆ`enc_out` å’Œ`hidden`ã€‚å®ƒä»¬å°†ä½œä¸ºè§£ç å™¨çš„è¾“å…¥ï¼Œè§£ç å™¨å°†è¾“å‡ºæ¯ä¸€æ­¥çš„ç½®ä¿¡åº¦å¾—åˆ†ã€‚è§£ç å™¨å’Œç¼–ç å™¨ä½¿ç”¨å…±äº«åµŒå…¥(æ„å‘³ç€å…±äº«è¯æ±‡)ã€‚

åœ¨è®­ç»ƒä¸­ï¼Œæˆ‘ä½¿ç”¨äº†å…¨**è€å¸ˆå¼ºåˆ¶**(ä¸‹ä¸€æ­¥çš„è¾“å…¥æ˜¯åœ°é¢çœŸç›¸)ä½¿å…¶ç±»ä¼¼äº**å˜å‹å™¨è®¾ç½®**ã€‚ä½¿ç”¨ AdamW optimizer ä¼˜åŒ–åŸ¹è®­ã€‚

> **Noob å»ºè®®:**
> 
> è¯·ç¡®ä¿æ ¹æ®æ‚¨çš„æ ‡å‡†(äº¤å‰ç†µ)å’ŒåµŒå…¥æ¥è®¾ç½® padding_idxï¼Œä»¥ç¡®ä¿ä¸ä¼šå¯¹å¡«å……è¿›è¡Œä»»ä½•æ“ä½œã€‚åœ¨è¿‡å»ï¼Œå½“æˆ‘å¼€å‘ä¸€äº› NER ç³»ç»Ÿæ—¶ï¼Œæˆ‘å¿½ç•¥äº†è¿™ä¸€ç‚¹ï¼Œå¹¶å¾—åˆ°äº†ç³Ÿç³•çš„æ¨¡å‹ç»“æœã€‚

## å˜å‹å™¨

æˆ‘é€šè¿‡ä½¿ç”¨å†…ç½®çš„ Pytorch transformer åŒ…æ¥å®ç°è½¬æ¢å™¨ã€‚è¿™ä¸ªåŒ…ä¸åŒ…æ‹¬ä½ç½®åµŒå…¥å’Œå•è¯åµŒå…¥ã€‚æ‰€ä»¥æˆ‘ä» Pytorch æ•™ç¨‹(è§[https://py torch . org/tutorials/beginner/transformer _ tutorial . html](https://pytorch.org/tutorials/beginner/transformer_tutorial.html))ä¸­æ‹¿äº†ä½ç½®åµŒå…¥çš„å®ç°ã€‚

åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘å°†é‡ç‚¹æè¿° Transformer ä¸­ mask å®ç°çš„å®ç°ï¼Œå°¤å…¶æ˜¯å¦‚ä½•å®ç° maskã€‚æˆ‘ä»¬å¼€å§‹å§:

ç¼–ç å™¨å’Œè§£ç å™¨æ­£å‘ä¼ é€’å®ç°æ˜¯ç›´æ¥çš„ã€‚æˆ‘æƒ³å¼ºè°ƒçš„æ˜¯æ©ç å˜é‡ã€‚

```
out_trf = self.trfm(out_emb_enc, out_emb_dec, **src_mask**=None, **tgt_mask**=tgt_mask, **memory_mask**=None,                                                   **src_key_padding_mask**=src_pad_mask, **tgt_key_padding_mask**=tgt_pad_mask,                                                   **memory_key_padding_mask**=src_pad_mask
```

**src_mask:åœ¨æºè¾“å…¥(ç¼–ç å™¨çš„è¾“å…¥)**ä¸­ï¼Œä¸€ä¸ªä½ç½®ï¼Œå¦‚æœåœ¨**å¸ƒå°”å¼ é‡**ä¸­æä¾›äº†ä¸€ä¸ªâ€œ**çœŸ**æ ‡å¿—(æ„å‘³ç€è¢«å±è”½)ï¼Œå°†ä¸ä¼šå…³æ³¨ä»»ä½•å…¶ä»–åºåˆ—(è®°ä½å˜å‹å™¨æœ‰è‡ªæˆ‘å…³æ³¨)ã€‚è¯¥å˜é‡å°†ç”¨äºå˜å‹å™¨çš„ç¼–ç å™¨ã€‚è½¬æ¢å™¨çš„é»˜è®¤å®ç°ä¼šå°†æ­¤è®¾ç½®ä¸º**æ— **ã€‚

**tgt_mask:** ç±»ä¼¼äº src_maskï¼Œ**ä½†æ˜¯åœ¨ç›®æ ‡è¾“å…¥(è§£ç å™¨çš„è¾“å…¥)**ã€‚è¯¥å˜é‡å°†ç”¨äºå˜å‹å™¨çš„è§£ç å™¨ã€‚æ­£å¦‚æˆ‘ä¸Šé¢æ‰€è¯´ï¼Œè½¬æ¢å™¨å¯ä»¥åŒæ—¶å¤„ç†ï¼Œæ‰€ä»¥å®ƒéœ€è¦ä¸€ä¸ªæ©ç æ¥é˜²æ­¢åœ¨æ³¨æ„åŠ›è¿‡ç¨‹ä¸Šè¿›è¡Œè®¡ç®—ã€‚

```
Easy way to visualize tgt_mask
Remember: decoder output sequence of text in sequential order.
For example, If the model want to output 'Fried Rice is delicious'. In the first step (**Fried**), it will not attend 'Rice is delicious'
In the second step (**Rice), It will attend 'Fried' and will not attend 'is delicious'** In the third step (**is**), **It will attend 'Fried' and 'Rice and will not attend 'delicious'**
In the forth step (**delicious), It will attend 'Fried, Rice, and is'**
```

**memory_mask:åœ¨å†…å­˜(ç¼–ç å™¨å˜å‹å™¨çš„è¾“å‡º)ä¸­ï¼Œ**åœ¨ç¬¬äºŒæ¬¡æ³¨æ„ä¸Šä½¿ç”¨æ—¶(è®°ä½ï¼Œè§£ç å™¨å±‚çš„æ³¨æ„è¿‡ç¨‹åŒ…å«ä¸¤ä¸ªæ­¥éª¤ï¼Œè‡ªæˆ‘æ³¨æ„å’Œç¼–ç å™¨-è§£ç å™¨æ³¨æ„)ï¼Œä¸ä¼šå‚åŠ ä»»ä½•å…¶ä»–åºåˆ—ã€‚å˜å‹å™¨é»˜è®¤å®ç°å°†æ­¤è®¾ç½®ä¸º**æ— **ã€‚

**src_key_padding_mask** :åŸºæœ¬ä¸Šæ˜¯åœ¨ä¿¡æºä¸Šå¡«å……æ©ç ã€‚è¿™ä¸ªè¿‡ç¨‹å°†ä½œä¸ºæ©è”½æ³¨æ„è¿‡ç¨‹ä¸­çš„å…³é”®

**tgt_key_padding_mask** :åŸºæœ¬ä¸Šæ˜¯åœ¨ç›®æ ‡ä¸Šå¡«å……é®ç½©ã€‚è¿™ä¸ªè¿‡ç¨‹å°†ä½œä¸ºæ©è”½æ³¨æ„è¿‡ç¨‹ä¸­çš„å…³é”®

**memory_key_padding_mask** :åŸºæœ¬ä¸Šæ˜¯ç¼–ç å™¨è¾“å‡ºçš„å­˜å‚¨å™¨ä¸Šçš„å¡«å……æ©ç ã€‚è¿™ä¸ªè¿‡ç¨‹ä¼šåœ¨æ³¨æ„åŠ›è¿‡ç¨‹ä¸­èµ·åˆ°æ©è”½å…³é”®çš„ä½œç”¨ã€‚ç¼–ç çš„è®°å¿†æ˜¯ä¿¡æºçš„å¡«å……ã€‚

å®ç° padding_mask å¾ˆå®¹æ˜“(è§`mask_pad_mask`)ï¼Œå¯¹äº tgt_maskï¼Œå®ç°åº”è¯¥ä½¿ç”¨`pytorch.nn.Transformer`ä¸­çš„`transformer.generate_square_subsequent_mask`ã€‚

åœ¨ Pytorch Lightning å®ç°ä¸­ï¼Œåªéœ€åƒè¿™æ ·æ­£å¸¸æ“ä½œå³å¯:

ç®€å•æ˜äº†ï¼Œæ˜“äºè®¾ç½®ï¼è¯·è®°ä½ä¸‹é¢æˆ‘ç»™ä½ çš„å»ºè®®ã€‚ä¸€äº›å‚»å‚»çš„å°é—®é¢˜ç”±æ­¤è€Œæ¥ã€‚

> **Noob å»ºè®®:**
> 
> çœ‹åˆ°è¿™ä¸ªäº†å—ï¼Ÿ
> 
> **logits = self.forward(srcï¼ŒTGT[:-1])
> loss = loss _ criterion(logits . view(-1ï¼Œoutput_dim)ï¼Œtgt[1:]ã€‚è§†å›¾(-1))**
> 
> ä¸è¦å¿˜è®°å°†**æ¥åœ°**çœŸå€¼è®¾ç½®ä¸º tgt[1:]å¹¶å°†**ç¼–ç å™¨è¾“å…¥**è®¾ç½®ä¸º tgt[:-1]
> 
> æˆ‘ä»¬å¸Œæœ›æ¨¡å‹å­¦ä¼šé¢„æµ‹è§£ç å™¨ä¸­çš„ä¸‹ä¸€ä¸ªå•è¯ï¼Œä¸æ˜¯å—ï¼Ÿ
> 
> ä¾‹å¦‚:å½“å‰ä»¤ç‰Œæ˜¯â€œâ€æˆ‘ä»¬è¦ç¡®ä¿æ¨¡å‹å­¦ä¹ ä¸‹ä¸€ä¸ªå•è¯â€œé¸¡â€

â€”

> **æˆ‘çš„æ•…äº‹:**
> 
> è®©æˆ‘æ¥è®²è¿°ä¸€ä¸‹æˆ‘å®ç°è½¬æ¢å™¨çš„æ•…äº‹ã€‚æˆ‘æœç´¢äº†ä¸€ä¸ªå†…ç½®çš„ easy copy pasta ä»£ç (æ‡’å¾—è°ƒè¯•ï¼Œä»å¤´å®ç°)ã€‚æˆ‘å¶ç„¶å‘ç° Pytorch å†…ç½®äº† transformer åŒ…ï¼Œå¹¶æœ‰ç›¸å…³æ•™ç¨‹ã€‚æˆ‘çœ‹åˆ°äº†æ•™ç¨‹ï¼Œå¹¶å¾—å‡ºç»“è®ºï¼Œè¯¥æ•™ç¨‹ä¸èƒ½é€‚ç”¨äºæˆ‘çš„æƒ…å†µã€‚å®ƒä¸å¤„ç†**å¡«å……é®ç½©ã€‚æˆ‘åˆ°åº•è¯¥æ€ä¹ˆåšï¼Ÿ**æˆ‘çœ‹äº†æ–‡æ¡£ï¼Œæ‰¾åˆ°ä¸€ä¸ªå˜é‡å«åš[src/tgt/memory]_mask å’Œ[src/tgt/memory]_padded _maskã€‚æ˜¯..ä»ç„¶å›°æƒ‘ï¼Œå› ä¸ºæè¿°å¤ªçŸ­ã€‚æˆ‘æœç´¢æ‰€æœ‰çš„å †æ ˆæº¢å‡ºå’Œ Github é—®é¢˜ã€‚æœ€åï¼Œæˆ‘å‘ç°äº†ä¸€äº›å¯ç¤ºï¼Œæœ‰äººç”¨ Colab ç¼–å†™äº†ä¸€ä¸ªå®ç°ã€‚æ­¤å¤–ï¼Œæˆ‘ä¸çŸ¥é“è¿˜æœ‰å…³äºè¿™äº›æ©ç å˜é‡é™„åŠ æ–‡æ¡£(æˆ‘åº”è¯¥åœ¨æ–‡æ¡£ä¸­å‘ä¸‹æ»šåŠ¨ä¸€ç‚¹)ã€‚
> 
> å—¯â€¦â€¦é—®é¢˜è¿˜æ˜¯è§£å†³äº†ã€‚å¦‚æœæœ‰äººæœ‰è¿™æ ·çš„å›°æ‰°ï¼Œå°±çœ‹çœ‹æˆ‘å®ç° Pytorch è½¬æ¢å™¨çš„å®ç°å§ã€‚

## è´ªå©ªè§£ç å™¨

è´ªå©ªæœç´¢è§£ç å®ç°å¾ˆç®€å•ã€‚è§ä¸‹æ–‡:

ä»¥ä¸Šæ˜¯ GRU çš„æ¨ç†æºä»£ç ã€‚åœ¨æ¨ç†æ­¥éª¤ï¼Œæ¨¡å‹é€ä¸ªå¾ªç¯æ¯ä¸ªå®ä¾‹ã€‚å¯¹äºè§£ç å™¨ä¸­çš„æ¯ä¸€æ­¥ï¼Œå®ƒéƒ½ä¼šè¿›è¡Œè´ªå©ªæœç´¢ï¼Œç›´åˆ°æ‰¾åˆ°å¥å°¾ä»¤ç‰Œ`â€˜</s>â€™`ã€‚

å¯¹å˜å‹å™¨çš„æ¨è®ºä¹Ÿä¸ GRU çš„ç›¸ä¼¼ã€‚æ‚¨å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°æˆ‘çš„å®ç°:

[](https://github.com/haryoa/ingredbrew/blob/master/recibrew/core_nn.py) [## haryoa/ingredbrew

### æ­¤æ—¶æ‚¨ä¸èƒ½æ‰§è¡Œè¯¥æ“ä½œã€‚æ‚¨å·²ä½¿ç”¨å¦ä¸€ä¸ªæ ‡ç­¾é¡µæˆ–çª—å£ç™»å½•ã€‚æ‚¨å·²åœ¨å¦ä¸€ä¸ªé€‰é¡¹å¡ä¸­æ³¨é”€ï¼Œæˆ–è€…â€¦

github.com](https://github.com/haryoa/ingredbrew/blob/master/recibrew/core_nn.py) 

# å®éªŒ

æˆ‘ä¸åšè¶…å‚æ•°è°ƒæ•´ï¼Œä»¥é¿å…åœ¨è®­ç»ƒæ¨¡å‹ä¸ŠèŠ±è´¹å¤§é‡æ—¶é—´ã€‚

## å˜å‹å™¨

è¿™æ˜¯æˆ‘ä¸ºå˜å‹å™¨æ¨¡å‹é€‰æ‹©çš„è¶…å‚æ•°:

```
"dim_feedforward":   100
"dropout":           0.1
"lr":                0.001
"nhead":             2
"num_decoder_layer": 4"num_embedding":     100  # Also act as hidden unit in decoder and encoder layer"num_encoder_layer": 4
"padding_idx":       1
```

æ€»å‚æ•°:

```
| Name             | Type            | Params
-----------------------------------------------------
0 | full_transformer | FullTransformer | 1 M
```

## è‹å†›æ€»å‚è°‹éƒ¨æƒ…æŠ¥æ€»å±€

ä»¥ä¸‹æ˜¯ GRU seq2seq æ¨¡å‹çš„è¶…å‚æ•°:

```
embedding_dim=100hidden_dim=100enc_bidirectional=Trueenc_gru_layers=1dropout=0.1
```

æ€»å‚æ•°:

```
| Name             | Type             | Params
------------------------------------------------------
0 | encoder          | Encoder          | 121 K 
1 | decoder          | Decoder          | 945 K 
2 | shared_embedding | Embedding        | 300 K 
3 | criterion        | CrossEntropyLoss | 0
```

ä»–ä»¬ä½¿ç”¨ Colab GPU è¿›è¡Œè®­ç»ƒï¼Œå¹¶ä½¿ç”¨**è´ªå©ªæœç´¢è§£ç å™¨è¿›è¡Œæ¨ç†ã€‚**

> **æ³¨**
> 
> Colab ç¬”è®°æœ¬å°†ä½œä¸ºè°ƒç”¨ Pytorch Lightning å®ç°çš„ä¸»ç¨‹åºã€‚

åœ¨åšå®éªŒä¹‹å‰ï¼Œæˆ‘å°†ç§å­è®¾ç½®ä¸º 888ï¼Œä»¥ç¡®ä¿é‡ç°æ€§

```
from pytorch_lightning import Trainer, seed_everythingseed_everything(888)
```

æˆ‘ç”¨æ‰¹é‡ 64 å’Œ`accumulated_grad_batches=2`ã€‚è¿™æ„å‘³ç€ç”¨äºè®¡ç®—æŸå¤±çš„æ‰¹é‡å°†æ˜¯ 128ã€‚

# ç»“æœ

å…³é”®æ—¶åˆ»åˆ°äº†ã€‚ğŸƒ

![](img/5c4765c378effb0112e3ba517c771307.png)

ç…§ç‰‡ç”± [Arseny Togulev](https://unsplash.com/@tetrakiss?utm_source=medium&utm_medium=referral) åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„

è®­ç»ƒä¹‹åï¼Œæˆ‘åŠ è½½ç”¨`pytorch_lightning` ModelCheckpoint äº§ç”Ÿçš„æœ€ä½³æ¨¡å‹ã€‚æˆ‘é¢„æµ‹æµ‹è¯•æ•°æ®é›†ï¼Œå¹¶ä½¿ç”¨`sacrebleu`è®¡ç®—å®ƒçš„ BLEUã€‚è¡¨ 0 æ˜¾ç¤ºäº† GRU å’Œå˜å‹å™¨çš„ç»“æœã€‚ä»è¡¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºç»“è®ºï¼Œå˜å‹å™¨çœŸæ­£ä¸»å¯¼ GRU +æ³¨æ„ Seq2Seqã€‚ç”±äºä¸¤è€…å…·æœ‰å‡ ä¹ç›¸ä¼¼çš„ä½å‚æ•°ï¼ŒTransformer å‡»è´¥äº† gruã€‚BLEU å·®å¼‚å¹…åº¦çº¦ä¸º 13ã€‚

> **æˆ‘çš„æ•…äº‹/è§‚ç‚¹**
> 
> æˆ‘è®¤ä¸º Transformer è¾“ç»™äº† GRUï¼Œå› ä¸ºæ ¹æ®æˆ‘çš„ç»éªŒï¼ŒTransformer å€¾å‘äºè¿‡åº¦é€‚åº”æ•°æ®ï¼Œå¹¶ä¸”ç»å¸¸äº§ç”Ÿé”™è¯¯çš„è¾“å‡ºã€‚

è¡¨ 0:ç»“æœ

è®©æˆ‘ä»¬é‡‡é›†ä¸€äº›æ•°æ®æ ·æœ¬ï¼Œäº†è§£æ›´å¤šä¿¡æ¯ï¼

> **æ³¨**
> 
> æˆ‘è¿è¡Œå­˜å‚¨åº“ä¸­ç¬”è®°æœ¬å†…`00007_eda_result.ipynb`ä¸­çš„ä»£ç ã€‚

![](img/5b5c45bce6192c11cf1a46eee7eca859.png)

å›¾ 5

å›¾ 5 æ˜¾ç¤ºäº† 3 ä¸ªæ ·æœ¬ä½œä¸ºæˆ‘ä»¬è®­ç»ƒæ¨¡å‹çš„è¾“å‡ºã€‚ä»ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡º GRU ç»å¸¸é‡å¤æˆåˆ†è€Œä¸åœé¡¿ã€‚è¿™å¯èƒ½æ˜¯ç”± GRU å¼•èµ·çš„ï¼Œå®ƒå¯¹æŸäº›æˆåˆ†æ‘„å…¥è¿‡å¤šã€‚å½“ä½¿ç”¨è´ªå©ªè§£ç å™¨æ—¶ï¼Œæ¯ä¸ªæ­¥éª¤çš„æœ€é«˜ç½®ä¿¡æ°´å¹³æ€»æ˜¯äº§ç”Ÿç›¸åŒçš„æˆåˆ†ã€‚

å˜å½¢é‡‘åˆšå’Œ GRU å€¾å‘äºç”Ÿäº§â€œ1/2â€ä»¤ç‰Œã€‚ä»æˆ‘ä»¬åœ¨ EDA ä¸­çœ‹åˆ°çš„æƒ…å†µæ¥çœ‹ï¼Œâ€œ1â€å’Œâ€œ2â€å‡ºç°çš„é¢‘ç‡æœ€é«˜ï¼Œæˆ‘è®¤ä¸ºæˆ‘ä»¬å¯ä»¥æ¨æ–­å‡ºæ¨¡å‹å¯èƒ½ä¼šè¿‡åº¦æ‹Ÿåˆè¿™äº›æ•°å­—ã€‚

è™½ç„¶ã€Šå˜å½¢é‡‘åˆšã€‹æ¯”ã€ŠGRUã€‹æœ‰æ›´å¥½çš„å“ç§è¾“å‡ºï¼Œä½†è¿˜æ˜¯é‡å¤äº†ä¸€äº›æˆåˆ†ã€‚ä»å›¾ 5 ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨æ€»ç»“ä¸­ï¼Œå®ƒé‡å¤äº†ç¬¬ 4 æ¬¡â€œkikil sapiâ€(ç‰›è‚‰)ã€‚åœ¨é‚£ä¹‹åï¼Œå®ƒæœ€ç»ˆæŠŠè¾“å‡ºå˜æˆåˆ«çš„ä¸œè¥¿ã€‚æ€»è€Œè¨€ä¹‹ï¼Œè¿™ä¸ªå˜å½¢é‡‘åˆšå’Œ GRU æ¨¡å‹ä¸çŸ¥é“ä¸€ä¸ªæˆåˆ†ä¸èƒ½å‡ºç°ä¸¤æ¬¡æˆ–æ›´å¤šæ¬¡ã€‚

æ— è®ºå¦‚ä½•ï¼ŒTransformer çš„è¾“å‡ºå¯èƒ½ä»£è¡¨åŸå§‹é…æ–¹ã€‚æˆ‘ä»¬çŸ¥é“çƒ¹é¥ªé£Ÿç‰©æœ‰å¾ˆå¤šç§æ–¹æ³•ã€‚å› æ­¤ï¼Œå³ä½¿å®ƒæœ‰ä¸åŒäºåœ°é¢çœŸç›¸çš„è¾“å‡ºï¼Œæˆ‘ä»¬ä¹Ÿä¸èƒ½åˆ¤å®šå®ƒæ˜¯é”™è¯¯çš„ã€‚

# å»ºè®®

1.  æˆ‘åº”è¯¥åšè¿‡è¶…å‚æ•°è°ƒä¼˜(ä¸­å°å‹å·)ã€‚æœ‰äº†å®ƒï¼Œä¹Ÿè®¸å®ƒèƒ½ç”Ÿäº§å¾—æ›´å¥½ã€‚è¿™ä¹Ÿæ˜¯æˆ‘è¦å†™çš„å¾…åŠäº‹é¡¹æ–‡ç« ã€‚
2.  ä½¿ç”¨å…¶ä»–è§£ç ç­–ç•¥ã€‚æ­£å¦‚æˆ‘å‰é¢æ‰€è¯´ï¼Œæˆ‘å°†å¾ˆå¿«å°±æ­¤å†™ä¸€ç¯‡æ–°æ–‡ç« ã€‚è®©æˆ‘ä»¬çœ‹åˆ°è´ªå©ªä¸ä»–äººçš„åŒºåˆ«ã€‚
3.  é¿å…é‡å¤ã€‚ä¸ºäº†é¿å…é‡å¤ï¼Œä¹Ÿè®¸æˆ‘å¯ä»¥åŠ ä¸€ä¸ªè§£ç çš„é™åˆ¶ï¼Ÿ
4.  ç”¨å…¶ä»–(å¤§)æ•°æ®å¯¹æ¨¡å‹è¿›è¡Œé¢„è®­ç»ƒã€‚æˆ‘è®¤ä¸ºæœ‰äº†ä¸€ä¸ªé¢„å…ˆè®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œå¯ä»¥è¿›ä¸€æ­¥æé«˜ç»“æœã€‚
5.  ç”¨åŠç›‘ç£å­¦ä¹ å¦‚**åå‘ç¿»è¯‘**æ·»åŠ æ•°æ®ã€‚è¿™æ˜¯ç›®å‰çš„çƒ­ç‚¹ï¼Œä¹Ÿå¯èƒ½æé«˜æ¨¡å‹çš„è´¨é‡

# æœ‰è¶£çš„é…æ–¹å•¤é…’ç”Ÿæˆå™¨

ğŸ˜†è®©æˆ‘ä»¬ä¸€èµ·äº«å—æ¨¡å‹çš„ä¹è¶£å§ï¼ğŸ˜†ã€‚

ä½ ä¹Ÿå¯ä»¥è¯•è¯•ä¸‹é¢çš„ Colab é“¾æ¥ã€‚æ³¨æ„ï¼Œé…æ–™æ˜¯ç”Ÿæˆçš„ï¼

## **éšæœºè¾“å…¥ 1:**

![](img/a40fbb9152b988223168f5d0521f00fd.png)

ç…§ç‰‡ç”±[è«å“ˆæœ«Â·é˜¿æ‹‰å§†](https://unsplash.com/@ambientpictures?utm_source=medium&utm_medium=referral)åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„

```
Food : nasi goreng pedas (spicy fried rice)
Ingredients:
 1 piring nasi putih (rice)
 1 butir telur (egg)
 1 buah wortel (carrot)
 1 buah timun  (cucumber)
 1 buah bawang putih  (garlic)
 1 buah bawang merah  (onion)
 1 buah cabe merah  (red chili)
 1 buah cabe rawit  (cayenne pepper)
 1 buah tomat  (tomato)
 1 / 2 sdt terasi  (shrimp paste)
 1 / 2 sdt garam  (salt)
 1 / 2 sdt merica (pepper)
```

æˆ‘ä»¬è¯•è¯•ä¸€èˆ¬çš„å§ï¼Œâ€˜é¦™è¾£ç‚’é¥­â€™ã€‚å¦‚æ‚¨æ‰€è§ï¼Œå³ä½¿é£Ÿå“åç§°ä¸­æ²¡æœ‰è¾£æ¤’ï¼Œå®ƒä¹Ÿä¼šè¾“å‡ºè¾£æ¤’ã€‚

## éšæœºè¾“å…¥ 2:

![](img/13f43e821fea6bd12c325c16f4f0938c.png)

Indom [ie æº](https://commons.wikimedia.org/wiki/File:2016_Indomie_Mi_Goreng_Rendang_NL_02.jpg) ( CC BY-SA 2.0)

```
Food : indomie lodeh 
Ingredients :
 1 bungkus indomie goreng 
 1 / 2 kg toge (sprouts)
 1 / 2 kg kacang tanah  (peanuts)
 1 / 2 kg bawang bombay  (onion)
 1 / 2 kg cabe merah   (red chili)
 1 / 2 ons cabe rawit  (cayenne pepper)
 1 / 2 ons cabe merah  (red chili)
 1 / 2 sdt garam  (salt)
 1 / 2 sdt gula   (sugar)
 1 / 2 sdt merica bubuk  (pepper powder)
 1 / 2 sdt penyedap rasa  (flavoring)
 1 / 2 sdt gula pasir   (granulated sugar)
```

å¯¹äºä»»ä½•æƒ³çŸ¥é“ lodeh æ˜¯ä»€ä¹ˆçš„äººæ¥è¯´:

[](https://en.wikipedia.org/wiki/Sayur_lodeh) [## è¨å°¤å°”Â·æ´›å¾·

### Sayur lodeh æ˜¯ä¸€ç§å°åº¦å°¼è¥¿äºšè”¬èœæ±¤ï¼Œç”±æ¤°å¥¶ä¸­çš„è”¬èœåˆ¶æˆï¼Œåœ¨å°åº¦å°¼è¥¿äºšå¾ˆå—æ¬¢è¿ï¼Œä½†å¤§å¤šæ•°â€¦

en.wikipedia.org](https://en.wikipedia.org/wiki/Sayur_lodeh) 

è¥å¤šé¢æ˜¯ä¸€ç§åœ¨å°å°¼å¾ˆå—æ¬¢è¿çš„æ–¹ä¾¿é¢ã€‚ä½ åº”è¯¥å·²ç»çŸ¥é“äº†ã€‚

ä»…ä¾›å‚è€ƒï¼Œæˆ‘è®¤ä¸ºæ²¡æœ‰äººç»“åˆæ´›å¾·ä¸è¥å¤šé¢ï¼Œä¹Ÿè®¸æœ‰äººæƒ³å°è¯•è¿™äº›æˆåˆ†ï¼ŸğŸ˜œ

**éšæœºè¾“å…¥ 3**

![](img/f9ca7d9669377e66a835d27397c2701d.png)

ç…§ç‰‡ç”± [Masaaki Komori](https://unsplash.com/@gaspanik?utm_source=medium&utm_medium=referral) åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„

```
Food : sop nasi goreng  (FRIED RICE SOUP)
Ingredients:
 1 piring nasi putih  (rice)
 1 buah wortel    (carrot)
 1 buah kentang   (potato)
 1 buah tomat    (tomato)
 1 buah bawang bombay   (onion)
 2 siung bawang putih   (garlic)
 1 / 2 sdt lada bubuk   (ground pepper)
 1 / 2 sdt garam     (salt)
 1 / 2 sdt kaldu bubuk  (broth powder)
 1 / 2 sdt bubuk   (any powder? LOL)
 1 / 2 sdt minyak goreng    (cooking oil)
```

**æ±¤ç‚’é¥­ï¼ğŸ˜°**

åœ¨å°å°¼ï¼Œå®ƒæ˜¯ä¸€ç§åä¸»æµçš„é£Ÿç‰©(è¿˜æ˜¯åªæœ‰æˆ‘ï¼Ÿ).æœ‰äººæƒ³è¯•è¯•å—ï¼Ÿ

## Colab é“¾æ¥:

è¿™é‡Œæ˜¯ä»»ä½•æƒ³å°è¯•ç”Ÿäº§åŸæ–™çš„äººçš„åˆä½œé“¾æ¥ã€‚å®ƒå°†ä½¿ç”¨æˆ‘è‡ªå·±è®­ç»ƒè¿‡çš„æœ€å¥½çš„å˜å½¢é‡‘åˆšæ¨¡å‹ã€‚å¦‚æœä½ æ„¿æ„ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œè¯„è®ºä½ ç”Ÿäº§çš„é£Ÿç‰©æˆåˆ†ğŸ˜ƒã€‚

[](https://colab.research.google.com/drive/1yBHIbBLd2Um6CWpxZfEXvNkNHGDNuH_1?usp=sharing) [## è°·æ­Œè”åˆå®éªŒå®¤

### ç¼–è¾‘æè¿°

colab.research.google.com](https://colab.research.google.com/drive/1yBHIbBLd2Um6CWpxZfEXvNkNHGDNuH_1?usp=sharing) 

# ç»“è®º

è¿™ç¯‡æ–‡ç« åˆ†äº«äº†å¦‚ä½•åˆ¶ä½œé…æ–¹(æˆåˆ†)å•¤é…’ï¼Œè¿™æ˜¯æˆ‘åœ¨ä¸šä½™æ—¶é—´åšçš„ä¸€ä¸ªé¡¹ç›®ã€‚å®ƒè¿˜å‘Šè¯‰æ‚¨å®ƒèƒŒåçš„æŠ€æœ¯ä»¥åŠå¦‚ä½•å®ç°å®ƒã€‚æ–‡ç« è¿˜å‘Šè¯‰ä½ ï¼Œåœ¨å‡ ä¹ç›¸åŒçš„å‚æ•°ä¸‹ï¼ŒGRU å’Œ Transformer ä¹‹é—´æœ€å¥½çš„æ·±åº¦å­¦ä¹ æ¶æ„æ˜¯ä»€ä¹ˆã€‚å®éªŒè¡¨æ˜ï¼Œå˜å½¢é‡‘åˆšæˆ˜èƒœäº†æ ¼é²ã€‚ä¹‹åï¼Œæœ¬æ–‡è¿˜å°è¯•ç”Ÿæˆä¸€äº›æ— æ„ä¹‰çš„é£Ÿç‰©æˆåˆ†ã€‚

æˆ‘å¸Œæœ›å®ƒå¯ä»¥è®©ä½ æ›´å¥½åœ°ç†è§£å¦‚ä½•å®ç° seq2seq æ·±åº¦å­¦ä¹ ç³»ç»Ÿï¼Œå¹¶æ¿€åŠ±ä½ åšä¸€äº›æœ‰è¶£çš„é¡¹ç›®å¹¶ä¸å¤§å®¶åˆ†äº«ã€‚:)

# ç¼–åè®°

![](img/03fd6f78fb9485f619dc0f8d822f811c.png)

Zhdana Iyuleva åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„çš„ç…§ç‰‡

ç»ˆäºï¼æˆ‘åˆèƒ½å†™æ–‡ç« äº†ã€‚å·²ç»è¿‡äº†å¾ˆé•¿æ—¶é—´äº†ã€‚ä»…ä¾›å‚è€ƒï¼Œæˆ‘å‡ å¹´å‰å°±æƒ³å†™è¿™ç¯‡æ–‡ç« äº†ã€‚ä½†éšç€æˆ‘çš„ç”Ÿæ´»ç»§ç»­ï¼Œå®ƒè¢«è½¬ç§»äº†ï¼Œæˆ‘å¿˜è®°äº†å®ƒã€‚ä¸ä¹…å‰ï¼Œæˆ‘åšè‡ªæˆ‘è¯„ä»·ã€‚æˆ‘è¯„ä»·æˆ‘æœ€è¿‘æ²¡æœ‰å†™ä»»ä½•æ–‡ç« ï¼Œè¿™æ˜¯æˆ‘åˆ†äº«ä¸€äº›ä¸œè¥¿çš„â€˜åª’ä»‹â€™ä¹‹ä¸€ã€‚çˆ±æ˜¯å…³å¿ƒï¼Œä½ çŸ¥é“ã€‚ç§ï¼Œè¿™å°±æ˜¯æ–‡ç« ï¼

æ‰€ä»¥ï¼Œæˆ‘å¸Œæœ›æˆ‘èƒ½ç»§ç»­å†™æ›´å¤šçš„æ–‡ç« ã€‚æˆ‘å¸Œæœ›åˆ†äº«æˆ‘çš„çŸ¥è¯†å†æ¬¡æˆä¸ºæˆ‘çš„ä¹ æƒ¯ã€‚æˆ‘å¸Œæœ›æˆ‘çš„çŸ¥è¯†ä¸ä»…ç•™åœ¨æˆ‘çš„å¤§è„‘é‡Œï¼Œè¿˜èƒ½å’Œå…¶ä»–äººä¸€èµ·äº¤æµï¼Œå¸®åŠ©ä»–ä»¬å–å¾—æˆå°±ã€‚

å¦‚æœä½ æƒ³çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘çš„æ–‡ç« è¿™ä¹ˆé•¿ã€‚å—¯â€¦æˆ‘æ²¡æƒ³åˆ°æˆ‘çš„æ–‡ç« ä¼šè¿™ä¹ˆé•¿ï¼Œå½“æˆ‘æ„è¯†åˆ°è¿™ä¸€ç‚¹æ—¶ï¼Œæ²¡å…³ç³»â€¦æˆ‘å†™çš„ä¿¡æ¯è¶Šå¤šï¼Œå°±è¶Šå¥½ã€‚äº‹å®ä¸Šï¼Œæˆ‘å¯ä»¥æŠŠæˆ‘çš„æ–‡ç« ç¼©çŸ­åˆ° 5-10 åˆ†é’Ÿã€‚æˆ‘æƒ³ç»™ä½ å…³äºæˆ‘çš„æœ‰è¶£é¡¹ç›®çš„æœ€è¯¦ç»†çš„ä¿¡æ¯ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£å®ƒã€‚

æ— è®ºå¦‚ä½•ï¼Œå¦‚æœä½ å‘ç°æˆ‘çš„æ–‡ç« éœ€è¦æ”¹è¿›ï¼Œä½ å¯ä»¥é€šè¿‡è¯„è®ºæˆ–è€…å‘é‚®ä»¶ç»™æˆ‘æ¥åé¦ˆã€‚æˆ‘å·²ç»åœ¨æˆ‘çš„å­˜å‚¨åº“ä¸­å…±äº«äº†æˆ‘çš„ç”µå­é‚®ä»¶ã€‚æˆ‘å–œæ¬¢è¿™äº›åé¦ˆï¼

å¦‚æœä½ å¯¹æˆ‘çš„æ–‡ç« æ„Ÿå…´è¶£å¹¶æƒ³å…³æ³¨ï¼Œä»…ä¾›å‚è€ƒæˆ‘çš„æ–‡ç« å°†ä¸»è¦æ˜¯å…³äºè‡ªæˆ‘å‘å±•å’Œäººå·¥æ™ºèƒ½(ç‰¹åˆ«æ˜¯æ·±åº¦å­¦ä¹ )ã€‚å¯¹è¿™äº›é¢†åŸŸæ„Ÿå…´è¶£çš„å¯ä»¥å…³æ³¨æˆ‘:)ã€‚

å› æ­¤ï¼Œ

> æˆ‘æ¬¢è¿ä»»ä½•å¯ä»¥æé«˜æˆ‘è‡ªå·±å’Œè¿™ç¯‡æ–‡ç« çš„åé¦ˆã€‚æˆ‘æ­£åœ¨å­¦ä¹ å†™ä½œï¼Œå­¦ä¹ å˜å¾—æ›´å¥½ã€‚æˆ‘æ„Ÿæ¿€èƒ½è®©æˆ‘å˜å¾—æ›´å¥½çš„åé¦ˆã€‚

![](img/07cbac6d32f913b49f2b2f4b8dd63f94.png)

æ¥æº: [Pixabay](https://pixabay.com/illustrations/thank-you-polaroid-letters-2490552/) ä½œè€…:[æ°æ´›ç‰¹](https://pixabay.com/illustrations/thank-you-polaroid-letters-2490552/)

# æ¥æº

 [## è“è‰²

### BLEU(åŒè¯­è¯„ä¼°æ›¿è¡¥)æ˜¯ä¸€ç§ç®—æ³•ï¼Œç”¨äºè¯„ä¼°æ–‡æœ¬çš„è´¨é‡å·²ç»â€¦

en.wikipedia.org](https://en.wikipedia.org/wiki/BLEU) [](https://github.com/PyTorchLightning/pytorch-lightning) [## ç«ç‚¬ä¹‹å…‰/ç«ç‚¬ä¹‹å…‰

### é˜…è¯»æ­¤å¿«é€Ÿå¯åŠ¨é¡µé¢ç³»ç»Ÿ/ PyTorch ç‰ˆæœ¬ã€‚1.3(æœ€å°ã€‚è¯·æ±‚ã€‚)1.4 1.5(æœ€æ–°)Linux py 3.6[CPU]Linux py 3.7[GPU]â€¦

github.com](https://github.com/PyTorchLightning/pytorch-lightning)