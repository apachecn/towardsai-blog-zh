# æ¨æ–‡ä¸»é¢˜å»ºæ¨¡:ä½¿ç”¨ Twint æŠ“å–æ¨æ–‡

> åŸæ–‡ï¼š<https://pub.towardsai.net/tweet-topic-modeling-using-twint-to-scrape-tweets-part-1-a9274e5199d2?source=collection_archive---------3----------------------->

## [ç½‘é¡µæŠ“å–](https://towardsai.net/p/category/web-scraping)ï¼Œ[ç¼–ç¨‹](https://towardsai.net/p/category/programming)

## è¿™æ˜¯ä¸€ä¸ªå¤šéƒ¨åˆ†çš„ç³»åˆ—ï¼Œå±•ç¤ºäº†å¦‚ä½•ä¸ºä»»ä½• tweets é›†åˆæ”¶é›†ã€é¢„å¤„ç†ã€åº”ç”¨å’Œå¯è§†åŒ–çŸ­æ–‡æœ¬ä¸»é¢˜å»ºæ¨¡

![](img/8dffe7a9481d6311a622427075d1202f.png)

æ‹¥æœ‰å¥åº·ä¸“ç”¨ Twitter è´¦æˆ·çš„ä¸»è¦æ–°é—»æ¥æº(*ä½œè€…å›¾ç‰‡*)

***å…è´£å£°æ˜:*** *æœ¬æ–‡ä»…å‡ºäºæ•™è‚²ç›®çš„ã€‚æˆ‘ä»¬ä¸é¼“åŠ±ä»»ä½•äººæŠ“å–ç½‘ç«™ï¼Œå°¤å…¶æ˜¯é‚£äº›å¯èƒ½æœ‰æ¡æ¬¾å’Œæ¡ä»¶åå¯¹æ­¤ç±»è¡Œä¸ºçš„ç½‘ç«™ã€‚*

# ä»‹ç»

ä¸»é¢˜å»ºæ¨¡æ˜¯ä¸€ç§æ— ç›‘ç£çš„æœºå™¨å­¦ä¹ æ–¹æ³•ï¼Œç›®æ ‡æ˜¯æ‰¾åˆ°æ–‡æœ¬æ–‡æ¡£é›†åˆ(è¯­æ–™åº“)ä¸­çš„â€œéšè—â€ä¸»é¢˜(æˆ–èšç±»)ã€‚å®ƒçœŸæ­£çš„ä¼˜åŠ¿åœ¨äºï¼Œä½ ä¸éœ€è¦å¸¦æ ‡ç­¾æˆ–å¸¦æ³¨é‡Šçš„æ•°æ®ï¼Œè€Œæ˜¯åªæ¥å—åŸå§‹æ–‡æœ¬æ•°æ®ä½œä¸ºè¾“å…¥ï¼Œè¿™ä¹Ÿæ˜¯å®ƒä¸å—ç›‘ç£çš„åŸå› ã€‚æ¢å¥è¯è¯´ï¼Œæ¨¡å‹åœ¨çœ‹åˆ°æ•°æ®æ—¶å¹¶ä¸çŸ¥é“ä¸»é¢˜æ˜¯ä»€ä¹ˆï¼Œè€Œæ˜¯ä½¿ç”¨æ‰€æœ‰æ–‡æ¡£ä¸­å•è¯ä¹‹é—´çš„ç»Ÿè®¡å…³ç³»æ¥ç”Ÿæˆå®ƒä»¬ã€‚

æœ€æµè¡Œçš„ä¸»é¢˜å»ºæ¨¡æ–¹æ³•ä¹‹ä¸€æ˜¯**æ½œåœ¨ç‹„åˆ©å…‹é›·åˆ†é…(LDA)** ï¼Œè¿™æ˜¯ä¸€ç§ç”Ÿæˆæ¦‚ç‡æ¨¡å‹ç®—æ³•ï¼Œæ­ç¤ºäº†ç®¡ç†æ–‡æ¡£è¯­ä¹‰çš„æ½œåœ¨å˜é‡ï¼Œè¿™äº›å˜é‡ä»£è¡¨æŠ½è±¡ä¸»é¢˜ã€‚LDA(ä»¥åŠä¸€èˆ¬çš„ä¸»é¢˜å»ºæ¨¡)çš„å…¸å‹åº”ç”¨æ˜¯å°†å…¶åº”ç”¨äºä¸€ç»„æ–°é—»æ–‡ç« ï¼Œä»¥è¯†åˆ«å…±åŒçš„ä¸»é¢˜æˆ–è¯é¢˜ï¼Œå¦‚ç§‘å­¦ã€æ”¿æ²»ã€é‡‘èç­‰ã€‚ç„¶è€Œï¼ŒLDA çš„ä¸€ä¸ªç¼ºç‚¹æ˜¯å®ƒä¸èƒ½å¾ˆå¥½åœ°å¤„ç†è¾ƒçŸ­çš„æ–‡æœ¬ï¼Œå¦‚ **tweetsã€‚**è¿™æ˜¯æœ€è¿‘çš„**çŸ­æ–‡æœ¬ä¸»é¢˜å»ºæ¨¡(STTM)** çš„æ–¹æ³•ï¼Œå…¶ä¸­ä¸€äº›å»ºç«‹åœ¨ LDA ä¹‹ä¸Šï¼Œæ´¾ä¸Šç”¨åœºå¹¶ä¸”è¡¨ç°æ›´å¥½ï¼

è¿™ä¸€ç³»åˆ—å¸–å­æ—¨åœ¨å±•ç¤ºå’Œè§£é‡Šå¦‚ä½•ä½¿ç”¨ Python æ¥æ‰§è¡Œå’Œåº”ç”¨ç‰¹å®šçš„ STTM æ–¹æ³•(**Gibbs Sampling Dirichlet Mixture Model**æˆ– **GSDMM** )æ¥å¤„ç† Twitter ä¸Šçš„å¥åº·æ¨æ–‡ã€‚å®ƒå°†æ˜¯æ•°æ®æœé›†/æ¸…ç†ã€ç¼–ç¨‹ã€æ•°æ®å¯è§†åŒ–å’Œæœºå™¨å­¦ä¹ çš„ç»“åˆã€‚æˆ‘å°†åœ¨æ¥ä¸‹æ¥çš„ 4 ç¯‡æ–‡ç« ä¸­ä¾æ¬¡è®¨è®ºæ‰€æœ‰ä¸»é¢˜:

> ***ç¬¬ä¸€éƒ¨åˆ†:ä» Twitter ä¸­æŠ“å–æ¨æ–‡***

[*ç¬¬äºŒéƒ¨åˆ†:æ¸…ç†å’Œé¢„å¤„ç†æ¨æ–‡*](https://medium.com/towards-artificial-intelligence/tweet-topic-modeling-part-2-cleaning-and-preprocessing-tweets-e3a08a8b1770)

[*ç¬¬ä¸‰éƒ¨åˆ†:åº”ç”¨çŸ­æ–‡æœ¬ä¸»é¢˜å»ºæ¨¡*](https://medium.com/towards-artificial-intelligence/tweet-topic-modeling-part-3-using-short-text-topic-modeling-on-tweets-bc969a827fef)

[*ç¬¬å››éƒ¨åˆ†:å¯è§†åŒ–ä¸»é¢˜å»ºæ¨¡ç»“æœ*](https://medium.com/towards-artificial-intelligence/tweet-topic-modeling-part-4-visualizing-topic-modeling-results-with-plotly-66d5dbaaf7fb)

è¿™äº›æ–‡ç« ä¸ä¼šæ·±å…¥åˆ° LDA æˆ– STTM çš„ç»†èŠ‚ï¼Œè€Œæ˜¯è§£é‡Šä»–ä»¬çš„ç›´è§‰å’Œéœ€è¦çŸ¥é“çš„å…³é”®æ¦‚å¿µã€‚é¼“åŠ±æœ‰å…´è¶£å¯¹ LDA æœ‰æ›´é€å½»çš„ç»Ÿè®¡ç†è§£çš„è¯»è€…æŸ¥çœ‹è¿™äº›ä¼Ÿå¤§çš„èµ„æº [**è¿™é‡Œ**](http://www.cs.columbia.edu/~blei/papers/Blei2012.pdf) å’Œ [**è¿™é‡Œ**](https://ldabook.com/index.html) ã€‚

ä½œä¸ºå…ˆå†³æ¡ä»¶ï¼Œç¡®ä¿ä½ çš„ç”µè„‘ä¸Šå®‰è£…äº† [Jupyter Notebook](https://jupyter.readthedocs.io/en/latest/install.html) ã€ [Python](https://www.python.org/downloads/) ã€&ã€ [Git](https://git-scm.com/downloads) ã€‚

å¥½äº†ï¼Œæˆ‘ä»¬å¼€å§‹å§ï¼

# **ç¬¬ 1 éƒ¨åˆ†:**ä½¿ç”¨ Twint ä» Twitter ä¸­æŠ“å–æ¨æ–‡

ä»»ä½•æœºå™¨å­¦ä¹ æˆ–æ•°æ®åˆ†æä»»åŠ¡æœ€é‡è¦çš„ç¬¬ä¸€æ­¥æ˜¯è·å¾—æ‰€éœ€çš„æ•°æ®ã€‚

åœ¨æœ¬æ¬¡æ¼”ç¤º(ä»¥åŠåç»­æ–‡ç« )ä¸­ï¼Œæˆ‘ä»¬å°†æµè§ˆä¸€ä¸ªä¾‹å­ï¼Œè¯¥ä¾‹å­ä½¿ç”¨äº† 2014 å¹´ 1 æœˆè‡³ 2020 å¹´ 3 æœˆä¹‹é—´çš„æ¨æ–‡ï¼Œè¿™äº›æ¨æ–‡æ˜¯ä»å„ç§ç‰¹å®šäºå¥åº·çš„æ–°é—» Twitter å¸æˆ·(å¦‚ CNNã€ç¦å…‹æ–¯æ–°é—»é¢‘é“ã€BBCã€å“ˆä½›ç­‰)ä¸­æ”¶é›†çš„ã€‚*è¯¥æ•°æ®é›†çš„çµæ„Ÿæ¥è‡ª 2020 å¹´å† çŠ¶ç—…æ¯’å¥åº·ç–«æƒ…ï¼›å…¶åŠ¨æœºæ˜¯æ¢ç´¢å’Œç†è§£å„ç§æ–°é—»æ¥æºå’Œæ—¶é—´çš„ä»»ä½•è¶‹åŠ¿å’Œ/æˆ–å·®å¼‚ã€‚å¦å¤–ï¼Œä½ å¯ä»¥é€‰æ‹©æŠ“å–ä»»ä½•ä½ å–œæ¬¢çš„ tweet åŸŸåï¼Œå› ä¸ºè¿™ä¸ªæŒ‡å—æ˜¯ä¸ºä»»ä½•åœºæ™¯è®¾è®¡çš„ï¼Œè¿™å°±æ˜¯æ•´ä¸ªè¿‡ç¨‹çš„ç¾å¦™ä¹‹å¤„ï¼*

![](img/8dffe7a9481d6311a622427075d1202f.png)

æ‹¥æœ‰ç‰¹å®šå¥åº·æ¨ç‰¹è´¦æˆ·çš„ä¸»è¦æ–°é—»æ¥æº(å›¾ç‰‡ç”±ä½œè€…æä¾›)

*æ›´è¿›ä¸€æ­¥â€”â€”å¦‚æœä½ å·²ç»æœ‰äº†è‡ªå·±çš„ tweet æ•°æ®é›†(æˆ–è€…å¦ç‡åœ°è¯´ä»»ä½•æ–‡æœ¬æ•°æ®é›†)ï¼Œä½ å¯èƒ½æƒ³è·³è¿‡è¿™ä¸ªç³»åˆ—çš„è¿™ä¸€éƒ¨åˆ†ï¼Œç›´æ¥è¿›å…¥* [*ç¬¬äºŒéƒ¨åˆ†*](https://medium.com/towards-artificial-intelligence/tweet-topic-modeling-part-2-cleaning-and-preprocessing-tweets-e3a08a8b1770) *å¼€å§‹å»ºæ¨¡çš„æ•°æ®å¤„ç†ã€‚*

## **å®‰è£…å’Œä½¿ç”¨ Twint**

Twint æ˜¯ä¸€ä¸ªç”¨ Python ç¼–å†™çš„é«˜çº§ Twitter æŠ“å–å·¥å…·ï¼Œå…è®¸åœ¨ä¸ä½¿ç”¨ Twitter API çš„æƒ…å†µä¸‹ä» Twitter å¸æˆ·ä¸­æŠ“å– tweetsã€‚è¦äº†è§£ä½¿ç”¨ Twint çš„æ›´å¤šå¥½å¤„ï¼Œè¯·æŸ¥çœ‹ä¸‹é¢æœ‰ç”¨çš„ Githubã€‚

[](https://github.com/twintproject/twint) [## twintproject/twint

### æ²¡æœ‰è®¤è¯ã€‚æ²¡æœ‰ APIã€‚æ²¡æœ‰é™åˆ¶ã€‚Twint æ˜¯ä¸€ä¸ªç”¨ Python ç¼–å†™çš„é«˜çº§ Twitter æŠ“å–å·¥å…·ï¼Œå®ƒå…è®¸â€¦

github.com](https://github.com/twintproject/twint) 

é¦–å…ˆï¼Œæˆ‘ä»¬å¿…é¡»ç¡®ä¿å®‰è£…äº† Twintã€‚æ‚¨å¯ä»¥é€šè¿‡åœ¨ç»ˆç«¯ä¸­è¿è¡Œä»¥ä¸‹ä»»ä¸€å‘½ä»¤æ¥å®ç°è¿™ä¸€ç‚¹ã€‚

```
pip3 install twint
```

å¦‚æœä½¿ç”¨ PIPï¼Œè¯·ç¡®ä¿æ‚¨æ‹¥æœ‰æœ€æ–°ç‰ˆæœ¬çš„ Twint(è‡ª 2020 å¹´ 12 æœˆèµ·ä¸º 2.1.21 ),å› ä¸ºå®ƒå¯èƒ½ä¸ä¼šæ€»æ˜¯è·å–æœ€æ–°ç‰ˆæœ¬ã€‚å¦‚æœä¸ºäº†è§£å†³ä»¥å‰çš„é”™è¯¯è€Œè¿›è¡Œäº†æ›´æ–°ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´æŠ“å–å·¥å…·å‡ºç°é—®é¢˜ã€‚å¦‚æœæ˜¯è¿™ç§æƒ…å†µï¼Œæœ€å¥½ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤å…‹éš†å¹¶å®‰è£…å­˜å‚¨åº“ã€‚

```
git clone --depth=1 [https://github.com/twintproject/twint.git](https://github.com/twintproject/twint.git)
cd twint
pip3 install . -r requirements.txt
```

## **åˆ›å»ºåˆ®åˆ€ç¨‹åº**

é¦–å…ˆï¼Œè®©æˆ‘ä»¬å¯¼å…¥æˆ‘ä»¬éœ€è¦çš„å†…å®¹ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªæˆ‘ä»¬æƒ³ä» Twitter ä¸Šæ”¶é›†çš„æ´»è·ƒç”¨æˆ·å¸æˆ·åˆ—è¡¨ã€‚

```
import twint
import time
import pandas as pdtwitter_user_handles = 
['bbchealth', 'foxnewshealth','GdnHealthcare',  'KHNews', 'latimeshealth', 'NBCNewshealth', 'NPRHealth', 'NYTHealth', 'Reuters_Health', 'USNewsHealth', 'WSJHealth', 'TIMEHealth', 'HarvardHealth']
```

ä¸ºäº†åˆ›å»ºè´Ÿè´£æŠ“å–çš„ç¨‹åºï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨`twint.Config()`åˆå§‹åŒ– Twint é…ç½®ï¼Œå¹¶å®šä¹‰æˆ‘ä»¬æƒ³è¦æŠ“å–çš„ä»»ä½•é…ç½®å‚æ•°ã€‚è¿™åŒ…æ‹¬é…ç½®æœç´¢çš„ç”¨æˆ·å¥æŸ„ã€æ—¥æœŸèŒƒå›´ã€æ•°æ®è¾“å‡ºã€è¯­è¨€ã€æœ€å¤§è®°å½•ç­‰ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬å°†éå†æ‰€æœ‰ç”¨æˆ·ï¼Œå¹¶å°†ç»“æœè®°å½•å­˜å‚¨åˆ°ä¸€ä¸ªæ•°æ®æ¡†ä¸­ã€‚*æ³¨æ„:æ ¹æ®ä½ å°†è¦æŠ“å–çš„æ½œåœ¨æ¨æ–‡æ•°é‡ï¼Œä½ å¯èƒ½å¶å°”ä¼šæ”¶åˆ°ä¸€ä¸ªé”™è¯¯æˆ–è€…æ— æ³•ä¸€æ¬¡æŠ“å–æ‰€æœ‰å†…å®¹ï¼Œå› ä¸º Twitter æœ‰æ—¶ä¼šé™åˆ¶å¤§é‡çš„æ•°æ®è¯·æ±‚ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯èƒ½éœ€è¦åœ¨æ—¥æœŸèŒƒå›´å†…è¿›è¡Œå°æ‰¹é‡å¤„ç†ï¼Œç„¶åå†å°†å®ƒä»¬åˆå¹¶ã€‚*

```
# loop through each account using same configuration 
for username in twitter_user_handles:
 c = twint.Config()
 c.Lang = "en"
 c.Username = username
 c.Since = '2014-01-01'
 c.Until = '2020-03-28'
 c.Pandas = True
 c.Store_pandas = True
 c.Pandas_au = True
 c.Pandas_clean = False
 twint.run.Search(c)# store in data frame
tweets_df= twint.storage.panda.Tweets_df
```

`c.Store_pandas`å…è®¸æˆ‘ä»¬å°†æ¨æ–‡ä¿å­˜åˆ°ç†ŠçŒ«æ•°æ®æ¡†ä¸­ã€‚å°†`c.Pandas_au` è®¾ç½®ä¸º`True`å…è®¸æˆ‘ä»¬åœ¨æ¯æ¬¡è¿­ä»£æ—¶è‡ªåŠ¨æ›´æ–°æ•°æ®å¸§ï¼Œè€Œå°†`c.Pandas_clean`è®¾ç½®ä¸º False å¯ç¡®ä¿æ¯æ¬¡åˆ®æ“¦æ—¶æ•°æ®å¸§ä¸ä¼šè¢«æ¸…é™¤å¹²å‡€ã€‚

![](img/6c1e518dc0eec97f0b0aaa3aa804e487.png)

Twint åˆ›å»ºçš„åŸå§‹æ•°æ®æ¡†

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥å°†æˆ‘ä»¬çš„æ¨æ–‡ä¿å­˜åˆ° csv æ–‡ä»¶ä¸­ã€‚

```
tweets_df.to_csv(râ€™data/health_tweets.csvâ€™, index = False,    
                 header=True)
```

å¦‚å‰æ‰€è¿°ï¼Œå¯¹äºè¾ƒå¤§çš„æ•°æ®æå–ï¼Œæˆ‘ä»¬å¾ˆå¯èƒ½ä¸å¾—ä¸æˆæ‰¹æŠ“å–ã€‚æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°å°†æ•°æ®åˆå¹¶æˆä¸€ä¸ªæœ€ç»ˆçš„æ•°æ®å¸§å’Œ csv æ ¼å¼ã€‚

```
import glob
import pandas as pd

data_dir = 'data/'           

tweets_df = pd.concat([pd.read_csv(file) for file in  
                      glob.glob(data_dir+'*.csv')],  
                      ignore_index=True)tweets_df.to_csv(râ€™data/health_tweets.csvâ€™, index = False,   
                 header=True)
```

ç§ğŸ‘Œâ€”æˆ‘ä»¬æˆåŠŸåœ°æ”¶é›†äº†æ¨æ–‡æ•°æ®ï¼Œå¹¶å°†å…¶å…¨éƒ¨ä¿å­˜åœ¨ä¸€ä¸ª csv [æ–‡ä»¶](https://github.com/bicachu/short-text-topic-modeling-tutorial/blob/main/data/health_tweets.csv)ä¸­ï¼åœ¨æˆ‘ä»¬çš„[ä¸‹ä¸€éƒ¨åˆ†](https://medium.com/towards-artificial-intelligence/tweet-topic-modeling-part-2-cleaning-and-preprocessing-tweets-e3a08a8b1770)ä¸­ï¼Œæˆ‘ä»¬å°†å¯¹æ¨æ–‡è¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬åº”ç”¨è¯æ±‡åŒ–ï¼Œè®©å®ƒä»¬ä¸ºä¸»é¢˜å»ºæ¨¡å’Œè¿›ä¸€æ­¥çš„æ¢ç´¢æ€§åˆ†æåšå¥½å‡†å¤‡ã€‚

*æ³¨æ„:åœ¨ä»¥ä¸‹ç³»åˆ—ä¸­æä¾›å’Œä½¿ç”¨çš„ CSV æ–‡ä»¶è¿˜å°†åŒ…æ‹¬ç”¨æˆ·å¥æŸ„* `*cnnhealth*` *çš„ tweetsï¼Œå› ä¸ºè¯¥å¸æˆ·åœ¨æŠ“å–æ—¶æ˜¯æ´»åŠ¨çš„ï¼Œä½†ç°åœ¨ä¸å†æ˜¯äº†ã€‚*

## å®Œæ•´çš„åˆ®åˆ€ç¨‹åºä»£ç 

[](/tweet-topic-modeling-part-2-cleaning-and-preprocessing-tweets-e3a08a8b1770) [## Tweet ä¸»é¢˜å»ºæ¨¡ç¬¬ 2 éƒ¨åˆ†:æ¸…ç†å’Œé¢„å¤„ç† tweet

### è¿™æ˜¯ä¸€ä¸ªå¤šéƒ¨åˆ†çš„ç³»åˆ—ï¼Œå±•ç¤ºäº†å¦‚ä½•ä¸ºä»»ä½•é›†åˆæŠ“å–ã€é¢„å¤„ç†ã€åº”ç”¨å’Œå¯è§†åŒ–çŸ­æ–‡æœ¬ä¸»é¢˜å»ºæ¨¡â€¦

pub.towardsai.net](/tweet-topic-modeling-part-2-cleaning-and-preprocessing-tweets-e3a08a8b1770) 

**å‚è€ƒèµ„æ–™å’Œå…¶ä»–æœ‰ç”¨èµ„æº**

*   LDA ä¸Šçš„[åŸæ–‡](https://ai.stanford.edu/~ang/papers/nips01-lda.pdf)
*   [LDA å°å†Œå­](https://ldabook.com/)æŒ‡å—
*   å…³äº STTM çš„[åŸæ–‡](https://dl.acm.org/doi/10.1145/2623330.2623715)GSD mm
*   Twint [GitHub](https://github.com/twintproject/twint)
*   [å¯åœ¨ Twint ä¸­ä½¿ç”¨çš„é…ç½®åˆ—è¡¨](https://github.com/twintproject/twint/wiki/Configuration)
*   UCI æœºå™¨å­¦ä¹ çŸ¥è¯†åº“â€” [å¥åº·æ–°é—»æ¨æ–‡æ•°æ®é›†](https://archive.ics.uci.edu/ml/datasets/Health+News+in+Twitter)